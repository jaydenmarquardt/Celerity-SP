define("0773bd53-a69e-4293-87e6-ba80ea4d614b_1.19.0",["tslib","@ms/sp-telemetry","@microsoft/sp-diagnostics","@microsoft/sp-component-base","@microsoft/sp-core-library","@microsoft/sp-loader"],(e,t,n,a,i,r)=>(()=>{"use strict";var o={866:e=>{e.exports=a},65:e=>{e.exports=i},377:e=>{e.exports=n},37:e=>{e.exports=r},878:e=>{e.exports=t},553:t=>{t.exports=e}},s={};function c(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={exports:{}};return o[e](n,n.exports,c),n.exports}c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var d={};return(()=>{c.r(d),c.d(d,{BaseExtension:()=>r,ExtensionContext:()=>o,_ExtensionManager:()=>u});var e=c(553),t=c(878),n=c(377),a=c(866),i=c(65);const r=function(a){function r(){var e=a.call(this)||this;return e._properties={},e}return(0,e.__extends)(r,a),r.prototype._init=function(e,a,r){var o=this;this._initializeContext(e),this._deserializeProperties(a);var s=this.context.serviceScope.consume(n._logSourceServiceKey)+".Extension.Init";t._PerformanceLogger.startMarkForComponent(s);var c=performance.now();return this._initializeExtensionType(),this._initPromise=this.onInit().then(function(){t._PerformanceLogger.endMarkForComponent(s),t._PerformanceLogger.logPerformanceMetricToConsole(s,"Extension.Init",o.context.manifest.id,o.context.manifest.alias)}),i._SPKillSwitch.isActivated("b90e1867-5423-4e90-ae5b-c38e9faf3e89")||t._PerformanceLogger.addExtensionInitTime({alias:this.context.manifest.alias,isInternal:!0===this.context.manifest.isInternal,duration:performance.now()-c}),this._initPromise},r.prototype._initializeExtensionType=function(){},Object.defineProperty(r.prototype,"properties",{get:function(){return this._properties},enumerable:!1,configurable:!0}),r.prototype.onInit=function(){return Promise.resolve()},r.prototype._deserializeProperties=function(e){this._properties={};try{e&&""!==e.trim()&&(this._properties=JSON.parse(e))}catch(e){var t=this.context.serviceScope.consume(n._logSourceServiceKey);n._TraceLogger.logError(t,new Error('Failed to deserialize properties for extension "'.concat(this.context.manifest.alias,'"\n          + " with id=').concat(this.context.manifest.id,": ")+e.message))}},r}(a.BaseComponent),o=function(t){function n(e){return t.call(this,e)||this}return(0,e.__extends)(n,t),n}(a.BaseComponentContext);var s=c(37);const l=JSON.parse('{"SG":"manifestNotFound","ho":"extensionInitFailure","Yl":"extensionLoadFailure"}'),u=function(){function e(e,t){this._isDisposed=!1,this._serviceScope=e,this._extensions=[]}return e.prototype.createExtension=function(r,o,c,d){var u=this,f=new n._QosMonitor("Extension.Create",!0),p=s.SPComponentLoader.tryGetManifestById(r);if(!p){var m=new Error(i.Text.format(l.SG,r));return f.writeUnexpectedFailure("ManifestNotFound",m,{componentId:r}),Promise.reject(m)}var _=this._createQosExtraData(p);try{var h=i.Guid.newGuid().toString(),b="Extension.".concat(p.id,".").concat(h),g=c({manifest:p,parentServiceScope:this._serviceScope,instanceId:h,loggingTag:b}),v=b+".Extension.Create",y=b+".Extension.ScriptLoad";t._PerformanceLogger.startMarkForComponent(v);var S=void 0;t._PerformanceLogger.startMarkForComponent(y);var D=s.SPComponentLoader.loadComponent(p).then(function(e){t._PerformanceLogger.endMarkForComponent(y),t._PerformanceLogger.logPerformanceMetricToConsole(y,"Extension.ScriptLoad",p.id,p.alias);var n=new(0,e.default);return n._init(g,o,d).then(function(){return n}).catch(function(e){throw S=new Error(i.Text.format(l.ho,r)),f.writeExpectedFailure("ExtensionInitFailure",S,_),S})},function(e){throw S||(S=new Error(i.Text.format(l.Yl,r)),f.writeExpectedFailure("ExtensionLoadFailure",S,_)),S}).then(function(e){return f.writeSuccess(_),t._PerformanceLogger.endMarkForComponent(v),t._PerformanceLogger.logPerformanceMetricToConsole(y,"Extension.Create",p.id,p.alias),u._extensions.push(e),e});return a._LegacyThirdPartyFabricCoreLoader.forceLoad(p).catch(function(t){return n._TraceLogger.logError(e._logSource,new Error("Failed to load legacy fabric core styles: ".concat(t)))}),D}catch(e){return f.writeUnexpectedFailure("UnhandledCreateError",e,_),Promise.reject(e)}},e.prototype.dispose=function(){this._isDisposed||(this.disposeExtensions(),this._serviceScope=void 0,this._extensions=void 0),this._isDisposed=!0},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e.prototype.disposeExtensions=function(){for(var t=0,a=this._extensions;t<a.length;t++){var i=a[t];try{i.dispose()}catch(t){var r=i.manifest;n._TraceLogger.logError(e._logSource,new Error('Failed to dispose extension "'.concat(r.alias,'"\n            + " with id=').concat(r.id,": ")+t.message))}}this._extensions=[]},e.prototype._createQosExtraData=function(e){var t={alias:e.alias,isInternal:e.isInternal,manifestId:e.id,extensionType:e.extensionType};return t.teamsHosted=i._BrowserUtilities.isTeamsHosted(),t},e._logSource=n._LogSource.create("ExtensionManager"),e}()})(),d})());