"use strict";(self["webpackJsonp_aec2bbfd-a968-4d5b-a279-12e570f378e6_1.19.0"]=self["webpackJsonp_aec2bbfd-a968-4d5b-a279-12e570f378e6_1.19.0"]||[]).push([[224],{963:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var a=n(553),i=n(878),r=n(377),o=n(17),s=n(61);function c(){return i._SPKillSwitch.isActivated("df724ea6-3681-4d8b-989f-85bede997509")}function d(){return i._SPKillSwitch.isActivated("c4f7a9ac-2822-43fd-ba58-b01454ba8bed")}var l=function(){function e(e,t,n){this._tokenProvider=e,this._graphBaseUrl=t,this._isInternal=n}return e.prototype.getAccessToken=function(){return this._isInternal?this._getInternalToken(this._tokenProvider):this._getOAuthToken(this._tokenProvider)},e.prototype._getOAuthToken=function(e){var t=new r._QosMonitor("MSGraphClient.FetchGraphToken");return e.getToken(this._graphBaseUrl).then(function(e){return t.writeSuccess(),e}).catch(function(e){throw t.writeUnexpectedFailure(e.message,e),e})},e.prototype._getInternalToken=function(e){var t=new r._QosMonitor("MSGraphClient.FetchInternalGraphToken");return e._getTokenInternal(this._graphBaseUrl,s._AadTokenProviders.preAuthorizedConfiguration).then(function(e){return t.writeSuccess(),e}).catch(function(e){throw t.writeUnexpectedFailure(e.message,e),e})},e}();const u=function(){function e(t,n,a,i){var r=this;this._isInternal=!1,t.whenFinished(function(){e._graphBaseUrl||(e._graphBaseUrl=t.consume(s._GraphHttpClientContext.serviceKey).getGraphEndpointUrl()),i?(r._isInternal=!0,d()||e._internalInstance?d()&&!e._instance&&(e._instance=r._createInternalGraphClientInstance(s._AadTokenProviders.configurable,n)):e._internalInstance=r._createInternalGraphClientInstance(s._AadTokenProviders.configurable,n)):e._instance||(e._instance=void 0!==a?r._createGraphClientInstanceWithMiddleware(s._AadTokenProviders.configurable,a):r._createGraphClientInstance(s._AadTokenProviders.configurable,n))})}return e.prototype.api=function(t){return i.Validate.isNonemptyString(t,"path"),!d()&&this._isInternal?e._internalInstance.api(t):e._instance.api(t)},Object.defineProperty(e.prototype,"client",{get:function(){return!d()&&this._isInternal?e._internalInstance:e._instance},enumerable:!1,configurable:!0}),e.prototype._createGraphClientInstance=function(t,n){var i,s=this,d=new r._QosMonitor("MSGraphClientV3.CreateGraphClientInstance");if(c())i=o.Client.init((0,a.__assign)({authProvider:function(e){s._getOAuthToken(t).then(function(t){e(void 0,t),d.writeSuccess()}).catch(function(t){e(t,""),d.writeExpectedFailure(t.message)})},baseUrl:e._graphBaseUrl},n));else try{i=this._createClientInstance((0,a.__assign)((0,a.__assign)({},n),{authProvider:void 0}),t,!1)}catch(e){throw d.writeUnexpectedFailure(e.message,e),e}return i},e.prototype._createGraphClientInstanceWithMiddleware=function(t,n){var s,c=this,d=new r._QosMonitor("MSGraphClientV3.CreateGraphClientInstanceWithMiddleware");try{return s=i._SPKillSwitch.isActivated("fc060cb5-65ce-406c-88e4-c05007eb611f")?o.Client.initWithMiddleware((0,a.__assign)({authProvider:{getAccessToken:function(e){return c._getOAuthToken(t)}},baseUrl:e._graphBaseUrl},n)):this._createClientInstance(n,t,!1),d.writeSuccess(),s}catch(e){throw d.writeUnexpectedFailure(e.message,e),e}},e.prototype._createInternalGraphClientInstance=function(t,n){var i,s=this,d=new r._QosMonitor("MSGraphClientV3.CreateInternalGraphClientInstance");if(c())i=o.Client.init((0,a.__assign)({authProvider:function(e){s._getInternalToken(t).then(function(t){e(void 0,t),d.writeSuccess()}).catch(function(t){e(t,""),d.writeExpectedFailure(t.message)})},baseUrl:e._graphBaseUrl},n));else try{i=this._createClientInstance((0,a.__assign)((0,a.__assign)({},n),{authProvider:void 0}),t,!0)}catch(e){throw d.writeUnexpectedFailure(e.message,e),e}return i},e.prototype._createClientInstance=function(t,n,a){var i,r=t||{};return r.baseUrl=e._graphBaseUrl,r.middleware?(i=[new o.AuthenticationHandler(new l(n,e._graphBaseUrl,a))],Array.isArray(r.middleware)?i.push.apply(i,r.middleware):i.push(r.middleware)):i=o.MiddlewareFactory.getDefaultMiddlewareChain(new l(n,e._graphBaseUrl,a)),r.middleware=i,o.Client.initWithMiddleware(r)},e.prototype._getOAuthToken=function(t){var n=new r._QosMonitor("MSGraphClient.FetchGraphToken");return t.getToken(e._graphBaseUrl).then(function(e){return n.writeSuccess(),e}).catch(function(e){throw n.writeUnexpectedFailure(e.message,e),e})},e.prototype._getInternalToken=function(t){var n=new r._QosMonitor("MSGraphClient.FetchInternalGraphToken");return t._getTokenInternal(e._graphBaseUrl,s._AadTokenProviders.preAuthorizedConfiguration).then(function(e){return n.writeSuccess(),e}).catch(function(e){throw n.writeUnexpectedFailure(e.message,e),e})},e}()}
}]);