(self["webpackJsonp_f9e737b7-f0df-4597-ba8c-3060f82380db_1.19.0"]=self["webpackJsonp_f9e737b7-f0df-4597-ba8c-3060f82380db_1.19.0"]||[]).push([[432],{2613:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ThumbnailPickerPreview:()=>v});var a=n(2553),i=n(2650),r=n(5079),o=n(269),s=n(9377),c=n(9137),d=n(348),l=n(8171),u=n(4037);const f=function(){function e(){}return e.load=function(e,t){return u.SPComponentLoader.loadComponentById("a81a5cf6-c9ad-4a0a-85aa-68c03d2d22a2").then(function(n){var a=new n.FilePicker(e);return a.initialize(t),a.fetchData().catch(function(e){return s._TraceLogger.logError(s._LogSource.create("FilePickerLoader"),e,"fetchData")}),a})},e}();var p=n(3875);const m=JSON.parse('{"F":"UploadWarningMessage"}');var _=function(){function e(e){var t=this;this._options=e,this._spFileHandlerPromise=Promise.resolve().then(n.t.bind(n,3875,23)).then(function(e){return void 0===t._spFileHandler&&(t._spFileHandler=new e.SPFileHandler({serviceScope:t._options.serviceScope,qosPrefix:t._options.callerName})),t._spFileHandler}),this._options.serviceScope.whenFinished(function(){var e=t._options.serviceScope.consume(l.PageContext.serviceKey);t._webId=e.web.id.toString(),t._siteId=e.site.id.toString()})}return e.prototype.openFilePicker=function(e,t){d.merge(this._options,e),this._sourceItemUrl=t,this._ensureFilePickerAsync().then(function(e){e.open()}).catch(function(){})},e.prototype._ensureFilePickerAsync=function(){if(!this._filePicker){var e={selectableType:3,onSelect:this._handleSelectFile,onCancel:this._options.onClose,selectionMode:this._options.isMultiSelectMode?o.SelectionMode.multiple:o.SelectionMode.single,itemTypes:this._options.itemTypes,allowExternalTenantLinks:this._options.allowExternalTenantLinks,disableWebSearch:this._options.disableWebSearch,callerName:this._options.callerName,enableMailtoSchema:!0};this._filePicker=f.load(this._options.serviceScope,e)}return this._filePicker},e.prototype._handleSelectFile=function(e){var t=this;e&&e.selectedItems&&e.selectedItems.length>0?e.selectedItems.forEach(function(n){if(t._options.onSelectFile){var a=Boolean(n.ListId||n.UniqueId||n.WebId||n.SiteId)?{listId:n.ListId,uniqueId:n.UniqueId,webId:n.WebId,siteId:n.SiteId}:void 0;t._options.onSelectFile(n.Link,a,e.selectedItems.length)}}):e&&e.localFilesPickedToUpload?(this._itemsCount=e.localFilesPickedToUpload.length,e.localFilesPickedToUpload.forEach(function(e){var n=e.file;t._startUpload(n)})):e&&e.externalImagesPickedToUpload?(this._itemsCount=e.externalImagesPickedToUpload.length,e.externalImagesPickedToUpload.forEach(function(e){t._startUpload(e)})):s._TraceLogger.logErrorWithLogEntry(s._LogSource.create(this._options.callerName),new s._LogEntry(this._options.callerName,"HandleSelectFileFromFilePicker",s._LogType.Error,{response:JSON.stringify(e)}))},e.prototype._startUpload=function(e){var t,n,a,i,r=this;if(e instanceof File){var o=!1;this._sourceItemUrl&&(o=this._sourceItemUrl.split("/").pop()===e.name);var d=Math.floor(4294967296*Math.random()).toString(),l=o?d+p.SPFileHandler.replaceSpecialCharacters(e.name):p.SPFileHandler.replaceSpecialCharacters(e.name);a=new s._QosMonitor("".concat(this._options.callerName,".UploadItem")),i=this._spFileHandlerPromise.then(function(t){return t.uploadLocalFile(e,l)})}else{if(c._ThumbnailUrlGenerator.getThumbnailProvider(e.src)===c._ThumbnailProviderType.HubbleStock)return void(null===(n=(t=this._options).onSelectFile)||void 0===n||n.call(t,e.src,void 0,this._itemsCount));a=new s._QosMonitor("".concat(this._options.callerName,".UploadExternalItem")),i=this._spFileHandlerPromise.then(function(t){return t.uploadExternalFile(e.src,e.name)})}window.addEventListener("beforeunload",this._promptUploadingWarning),this._options.onUploadFileStart&&this._options.onUploadFileStart(),i.then(function(e){r._onUploadComplete(e),a.writeSuccess()},function(e){e instanceof p.SPFileHandlerError?-2147024891===e.errorCode?a.writeExpectedFailure("PermissionAccessDenied",e):-2130575257===e.errorCode?a.writeExpectedFailure("FileNameExisted",e):a.writeUnexpectedFailure("FailedToUpload",e,{errorCode:e.errorCode}):a.writeUnexpectedFailure("FailedToUploadNoSPFileHandlerError",e),r._onUploadError(e)})},e.prototype._promptUploadingWarning=function(e){var t=m.F;return e.returnValue=t,t},e.prototype._onUploadComplete=function(e){if(window.removeEventListener("beforeunload",this._promptUploadingWarning),this._options.onSelectFile){var t=e.uniqueId?{listId:e.listId,uniqueId:e.uniqueId,webId:this._webId,siteId:this._siteId}:void 0;this._options.onSelectFile(e.serverRelativeUrl,t,this._itemsCount)}},e.prototype._onUploadError=function(e){window.removeEventListener("beforeunload",this._promptUploadingWarning)},(0,a.__decorate)([r.autobind],e.prototype,"openFilePicker",null),(0,a.__decorate)([r.autobind],e.prototype,"_handleSelectFile",null),e}(),h=n(391),b=n(5586),g=n(2672);n(6230).loadStyles(".aq_g_d8e860b4{align-items:stretch;display:flex;flex-direction:column;width:100%}.aq_g_d8e860b4 .ar_g_d8e860b4{align-self:flex-start;margin-bottom:10px;margin-top:10px}",!0);var v=function(e){function t(t){var n=e.call(this,t)||this;return n._handleChangeImageClick=function(){n._filePicker.openFilePicker()},n._filePicker=new _({serviceScope:n.props.serviceScope,itemTypes:new Set([2]),onSelectFile:n._handleSelectFile,onUploadFileError:n._handleUploadError,onUploadFileStart:n._handleUploadFileStart,allowExternalTenantLinks:!1,disableWebSearch:!1,isMultiSelectMode:!1,callerName:n.props.callerName}),n._thumbnailWrapperRef=i.createRef(),n.state={isUploadInProgress:!1},n}return(0,a.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isUploadInProgress:!1})},t.prototype.render=function(){return i.createElement("div",{className:"aq_g_d8e860b4",ref:this._thumbnailWrapperRef},i.createElement(h.c,{key:this.props.thumbnail.imageUrl,thumbnail:this.props.thumbnail,showLoading:this.state.isUploadInProgress,previewFullWidth:this.props.previewFullWidth,previewGrayBackground:this.props.previewGrayBackground,wrapperClassName:this.props.thumbnailRendererWrapperClassName,iconClassName:this.props.thumbnailRendererIconClassName,qosPrefix:this.props.callerName}),(0,b.K)(this._handleChangeImageClick,this.props.onItemDeleted,"ar_g_d8e860b4",this.props.disabled,"thumbnailImagePicker"))},t.prototype._handleUploadFileStart=function(){this.setState({isUploadInProgress:!0})},t.prototype._handleUploadError=function(e){this.setState({isUploadInProgress:!1})},t.prototype._handleSelectFile=function(e,t){this.setState(function(e){return{isUploadInProgress:!1}}),this.props.onItemChanged(e,t),this._handleImageChangeFocus()},t.prototype._handleImageChangeFocus=function(){var e=this;(0,g.xO)()||setTimeout(function(){var t,n=null===(t=e._thumbnailWrapperRef.current)||void 0===t?void 0:t.querySelector('[data-automation-id="thumbnailImagePickerChangeButton"]');n&&n.focus()},0)},(0,a.__decorate)([r.autobind],t.prototype,"_handleUploadFileStart",null),(0,a.__decorate)([r.autobind],t.prototype,"_handleUploadError",null),(0,a.__decorate)([r.autobind],t.prototype,"_handleSelectFile",null),t}(i.PureComponent)}
,5586:(e,t,n)=>{"use strict";n.d(t,{K:()=>l,w:()=>d});var a=n(2553),i=n(2650),r=(n(5079),n(7008)),o=n(2441),s=n(7161),c=n(2672);function d(e,t,n,a,i){return u(e,{change:{description:s.Hh,label:s.gb},delete:{description:s.mj,label:s.zv}},t,i,n,a)}function l(e,t,n,a,i){return u(e,{change:{description:s.bY,label:s.vW},delete:{description:s.Jv,label:s.vf}},t,a,n,i)}function u(e,t,n,d,l,u){var f=t.change,p=f.description,m=f.label,_=t.delete,h=_.description,b=_.label,g={className:l,onClick:e,disabled:d&&!(0,c.LX)(),ariaLabel:m,ariaDescription:p,"data-automation-id":u?"".concat(u,"ChangeButton"):"thumbnailImagePickerChangeButton"},v=(0,c.Wy)()?i.createElement(r.PrimaryButton,(0,a.__assign)({},g),s.A0):i.createElement(r.ActionButton,(0,a.__assign)({},(0,a.__assign)((0,a.__assign)({},g),{iconProps:{iconName:"Edit"}})),s.A0),y=!(0,c.Wy)()&&n?i.createElement(r.ActionButton,{iconProps:{iconName:"Delete"},className:l,onClick:n,disabled:d&&!(0,c.LX)(),ariaLabel:b,ariaDescription:h,"data-automation-id":u?"".concat(u,"DeleteButton"):"thumbnailImagePickerDeleteButton"},s.hi):void 0;return y?i.createElement(o.Stack,{tokens:{childrenGap:40},horizontal:!0},v," ",y):v}}
,391:(e,t,n)=>{"use strict";n.d(t,{c:()=>u});var a=n(2553),i=n(2650),r=n(5079),o=n(6785),s=n(9377),c=n(2863),d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isRenderBackup:!1},n}return(0,a.__extends)(t,e),t.prototype.render=function(){var e,t=this._content;return!!t&&i.createElement("div",{role:"img",className:this.props.className,"aria-label":null===(e=this.props.thumbnail)||void 0===e?void 0:e.altText},t)},Object.defineProperty(t.prototype,"_content",{get:function(){if(this.props.onRenderThumbnail)return this.props.onRenderThumbnail();var e=this.props.thumbnail;if(e)switch(e.type){case c.Z.FabricReactIcon:return i.createElement(r.Icon,{iconName:e.iconName,style:e.iconColor?{color:e.iconColor}:void 0,role:"presentation",className:this.props.iconClassName});case c.Z.IconSizeImage:var t={className:this.props.iconClassName,imageFit:r.ImageFit.cover,src:e.iconUrl,role:"presentation",alt:e.altText};return i.createElement(r.Icon,{iconType:r.IconType.image,style:e.iconColor?{color:e.iconColor}:void 0,imageProps:t,className:this.props.iconClassName});case c.Z.Image:var n={imageFit:void 0!==e.imageFit?e.imageFit:r.ImageFit.cover,src:this.state.isRenderBackup&&e.backupImageUrl?e.backupImageUrl:e.imageUrl,alt:e.altText,title:e.altText?e.altText:void 0,role:e.altText?void 0:"presentation",className:this.props.iconClassName,onLoadingStateChange:this._handleImageLoadingStateChange,styles:{image:{width:"100%",height:"100%"}}};return this._imageMonitor=new s._QosMonitor("".concat(this.props.qosPrefix,".ImageLoad")),i.createElement(r.Icon,{iconType:r.IconType.image,imageProps:n,className:this.props.iconClassName});default:return}},enumerable:!1,configurable:!0}),t.prototype._handleImageLoadingStateChange=function(e){this._imageMonitor&&(e===r.ImageLoadState.loaded?this._imageMonitor.writeSuccess():e===r.ImageLoadState.error&&this._imageMonitor.writeUnexpectedFailure("ImageLoadError",void 0,{isRenderBackup:this.state.isRenderBackup})),this.setState(function(t){if(e===r.ImageLoadState.error&&!t.isRenderBackup)return{isRenderBackup:!0}})},(0,a.__decorate)([r.autobind],t.prototype,"_handleImageLoadingStateChange",null),t}(i.PureComponent),l=n(7161);n(6230).loadStyles('.cj_l_d8e860b4{position:relative}.cj_l_d8e860b4.ck_l_d8e860b4{background-color:"[theme:neutralLight, default: #edebe9]"}.cl_l_d8e860b4{padding-bottom:56.25%;width:100%}.cm_l_d8e860b4{height:100px;width:100px}.cn_l_d8e860b4{align-items:center;bottom:0;display:flex;justify-content:center;left:0;overflow:hidden;position:absolute;right:0;top:0}.cn_l_d8e860b4.co_l_d8e860b4{font-size:64px;line-height:100%;text-align:center}.cn_l_d8e860b4.cp_l_d8e860b4 .cq_l_d8e860b4{height:100%;width:100%}.cn_l_d8e860b4.cr_l_d8e860b4 .cq_l_d8e860b4,.cs_l_d8e860b4{height:64px;width:64px}.cs_l_d8e860b4{display:inline-flex;margin:auto;overflow:visible}.k_l_d8e860b4{left:50%;margin:0;position:absolute;top:50%;transform:translate(-50%,-50%)}',!0);var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.render=function(){var e,t,n,a,s,u=(0,r.css)("cj_l_d8e860b4",this.props.previewFullWidth?"cl_l_d8e860b4":"cm_l_d8e860b4",this.props.previewGrayBackground?"ck_l_d8e860b4":"",this.props.wrapperClassName),f=(0,r.css)("cn_l_d8e860b4",((e={}).cs_l_d8e860b4=(null===(t=this.props.thumbnail)||void 0===t?void 0:t.type)===c.Z.FabricReactIcon&&"vivaengagelogo"===this.props.thumbnail.iconName,e.co_l_d8e860b4=(null===(n=this.props.thumbnail)||void 0===n?void 0:n.type)===c.Z.FabricReactIcon,e.cr_l_d8e860b4=(null===(a=this.props.thumbnail)||void 0===a?void 0:a.type)===c.Z.IconSizeImage,e.cp_l_d8e860b4=(null===(s=this.props.thumbnail)||void 0===s?void 0:s.type)===c.Z.Image,e));return this.props.showLoading?i.createElement("div",{className:u},i.createElement(o.Spinner,{className:"k_l_d8e860b4",type:r.SpinnerType.large,label:l.U4})):i.createElement("div",{className:u},i.createElement(d,{thumbnail:this.props.thumbnail,className:f,iconClassName:(0,r.css)(this.props.iconClassName,"cq_l_d8e860b4"),qosPrefix:this.props.qosPrefix,onRenderThumbnail:this.props.onRenderThumbnail}))},t}(i.PureComponent)}
,269:(e,t,n)=>{var a=n(5853);e.exports=a._Utilities}
,7161:e=>{"use strict";e.exports=JSON.parse('{"U4":"PropertyPaneUploadingImageText","A0":"PropertyPaneChangeButtonLabel","bY":"PropertyPaneChangeImageButtonDescription","vW":"PropertyPaneChangeImageButtonAriaLabel","hi":"PropertyPaneDeleteButtonLabel","Jv":"PropertyPaneDeleteImageButtonDescription","vf":"PropertyPaneDeleteImageButtonAriaLabel","Hh":"PropertyPaneChangeIconButtonDescription","gb":"PropertyPaneChangeIconButtonAriaLabel","mj":"PropertyPaneDeleteIconButtonDescription","zv":"PropertyPaneDeleteIconButtonAriaLabel"}')}
}]);