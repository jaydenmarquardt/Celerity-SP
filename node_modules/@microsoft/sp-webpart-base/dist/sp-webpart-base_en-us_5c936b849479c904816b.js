(()=>{var e=document.currentScript;define("974a7777-0990-4136-8fa6-95d80114c2e0_1.19.0",["tslib","@microsoft/sp-component-base","@microsoft/sp-core-library","@ms/sp-edit-customer-promise","@ms/sp-telemetry","@microsoft/sp-diagnostics","@microsoft/sp-lodash-subset","@microsoft/load-themed-styles","@microsoft/sp-http","@microsoft/sp-loader","@microsoft/sp-page-context"],(t,n,a,i,r,o,s,c,d,l,u)=>(()=>{"use strict";var f,p,m,_,h,b={481:(e,t,n)=>{n.d(t,{H:()=>o,K4:()=>l,Mn:()=>d,Od:()=>s,Ro:()=>b,Xf:()=>m,a1:()=>h,f4:()=>u,lB:()=>g,qj:()=>_,rT:()=>c,vq:()=>f,vz:()=>p});var a=n(878),i=n(186),r=n(672);function o(){var e=-1===navigator.userAgent.indexOf("Chrome")&&navigator.userAgent.indexOf("Safari")>-1;return a._SPFlight.isEnabled(60290)&&(!e||a._SPFlight.isEnabled(60524))}function s(){return a._SPFlight.isEnabled(60400)}function c(){return a._SPFlight.isEnabled(60079)}function d(){return a._SPFlight.isEnabled(60668)}function l(){return a._SPFlight.isEnabled(60759)}function u(){return(!a._BrowserUtilities.isSafari()||(0,r.hJ)())&&(!(0,r.cy)()&&a._SPFlight.isEnabled(60622)||a._SPFlight.isEnabled(60821)||a._SPFlight.isEnabled(60822)||a._SPFlight.isEnabled(60823)||a._SPFlight.isEnabled(60824)||((0,r.h0)()?!(0,r.uR)()&&a._SPFlight.isEnabled(1252)&&a._BrowserUtilities.isFromVivaHome():a._SPFlight.isEnabled(1252)&&a._BrowserUtilities.isTeamsHosted()))}function f(){return!(0,r._i)()&&(a._SPFlight.isEnabled(1967)||1===i._SPPerfExperiment.getVariantAndTrackExperiment(i._PerformanceExperiment.WEXImageWebPartRefactorExp))}function p(){return a._SPFlight.isEnabled(61149)}function m(){return a._SPFlight.isEnabled(22854)}function _(){return a._SPFlight.isEnabled(61319)}function h(){return a._SPFlight.isEnabled(60808)&&a._SPFlight.isEnabled(1599)}function b(){return a._SPFlight.isEnabled(60693)}function g(){return a._SPFlight.isEnabled(61389)}}
,672:(e,t,n)=>{n.d(t,{$e:()=>o,GV:()=>y,IO:()=>d,JE:()=>E,Lt:()=>w,PF:()=>T,SM:()=>D,UK:()=>c,WP:()=>S,XP:()=>i,Y$:()=>_,Ye:()=>h,ZP:()=>u,_i:()=>A,cb:()=>U,cy:()=>p,dT:()=>r,dm:()=>l,h0:()=>v,hJ:()=>f,jM:()=>P,qd:()=>I,rc:()=>s,re:()=>L,rf:()=>k,t_:()=>F,u7:()=>O,uR:()=>g,vW:()=>M,wA:()=>C,xJ:()=>x,xR:()=>b,zx:()=>m});var a=n(878);const i=function(){function e(){}return e.isTeamsContextKSActivated=function(){return a._SPKillSwitch.isActivated(a.Guid.parse("a5daffb0-652e-4ee1-a638-e290089e1de7"),"09/11/2020","Refactor a method of IWebPartHost as async, as part of PR to enable teams context.")},e}();function r(){return a._SPKillSwitch.isActivated("d8618918-ac55-4979-b9d4-be944a4feb95")}function o(){return a._SPKillSwitch.isActivated("b8c50ded-d048-4eb9-bc41-21190d9d3bbb")}function s(){return a._SPKillSwitch.isActivated("ca984138-b518-4cf1-b201-2efe9322bb5e")}function c(){return a._SPKillSwitch.isActivated("ab6a720f-9915-4635-9b30-71b5d83e0647")}function d(){return a._SPKillSwitch.isActivated("1a2da4d0-9678-4a79-95a4-f0b9a7732dc2")}function l(){return a._SPKillSwitch.isActivated("e1e44790-a263-4f43-8b40-5b5e9b170300")}function u(){return a._SPKillSwitch.isActivated("c041bc0e-fcb5-4a3e-a4bc-d65a00a39a86")}function f(){return a._SPKillSwitch.isActivated("61a9578e-c6d2-4605-970f-222a8b29196c")}function p(){return a._SPKillSwitch.isActivated("07684c68-2e8e-4a25-b7e0-330781a92661")}function m(){return a._SPKillSwitch.isActivated("8a6c4749-5c36-4214-aa06-1ea308d679e2")}function _(){return a._SPKillSwitch.isActivated("56151a3e-a100-403c-9e91-cb5d1677ed66")}function h(){return a._SPKillSwitch.isActivated("e8edc935-7cd4-463b-81f5-aa1cce74d7d0")}function b(){return a._SPKillSwitch.isActivated("21f00b7b-3ed6-4c3a-bd49-8639460de07e")}function g(){return a._SPKillSwitch.isActivated("f993c5d6-5637-47bc-802d-6da6dda11a27")}function v(){return a._SPKillSwitch.isActivated("6c457592-8c32-472e-b340-349c014d6bc2")}function y(){return a._SPKillSwitch.isActivated("34173619-d841-476a-98c3-af5a79007103")}function S(){return a._SPKillSwitch.isActivated("bbd78e03-ff18-40ed-9a94-973fc659366c")}function D(){return a._SPKillSwitch.isActivated("43ce53d4-53da-48c4-acbd-20ff31eff5ee")}function I(){return a._SPKillSwitch.isActivated("290c0d46-6ee0-4d0b-aee5-ef3f01e4020e")}function x(){return a._SPKillSwitch.isActivated("8b372850-6897-4ef2-aecd-cd615019e544")}function C(){return a._SPKillSwitch.isActivated("33558902-7587-4229-a570-633976fa332b")}function O(){return a._SPKillSwitch.isActivated("98bb76c9-49c4-4736-80b9-88ff41d65cac")}function w(){return a._SPKillSwitch.isActivated("abb86541-760a-44b4-88f4-57a01af6e8c2")}function E(){return a._SPKillSwitch.isActivated("6e0a6d0e-ec0c-4667-85ce-198b4bbe78af")}function A(){return a._SPKillSwitch.isActivated("138ce21a-eef4-4e30-b350-4225400c72ac")}function L(){return a._SPKillSwitch.isActivated("7b14ee6c-0ab8-44b2-89a7-597a504254e0")}function k(){return a._SPKillSwitch.isActivated("bcd05704-f61a-473d-ba66-39f0bfa0891d")}function M(){return a._SPKillSwitch.isActivated("d5f5e371-14ac-45c1-96ca-439b650504e8")}function P(){return a._SPKillSwitch.isActivated("d4f103ea-7a8c-4d51-9a09-29369d2d9fa9")}function T(){return a._SPKillSwitch.isActivated("69933c68-aef0-4f8f-8016-a5974d22b2c6")}function U(){return a._SPKillSwitch.isActivated("bf6ec07d-4440-4ee6-83c6-17b560599c30")}function F(){return a._SPKillSwitch.isActivated("2087be6f-d433-41f5-b91a-5416f455d74d")}}
,258:(e,t,n)=>{n.d(t,{D:()=>a});var a={DeleteWebPart:"iframeDeleteWebPart",RequestDisplayMode:"iframeRequestDisplayMode",RequestPropertyPaneAction:"iframeRequestPropertyPaneAction",SetDisplayMode:"iframeSetDisplayMode",SetDimensions:"iframeSetDimensions",SetWebPartData:"iframeSetWebPartData",UpdateWebPartData:"iframeUpdateWebPartData",UpdatePropertyPaneData:"iframeUpdatePropertyPaneData",UpdatePropertyPaneLifeCycle:"iframePropertyPaneLifeCycle",WebPartRenderedInPropertyPaneIframe:"webPartRenderedInPropertyPaneIframe",DynamicDataMessage:"isolatedDynamicDataMessage",UpdateWebpartLifeCycle:"iframeUpdateWebpartLifeCycle",GetOboToken:"iframeGetOboToken",SetOboToken:"iframeSetOboToken",RequestTheme:"iframeRequestTheme",SetTheme:"iframeSetTheme",UpdateAudiences:"iframeUpdateAudiences"}}
,230:e=>{e.exports=c},866:e=>{e.exports=n},878:e=>{e.exports=a},377:e=>{e.exports=o},272:e=>{e.exports=d},37:e=>{e.exports=l},348:e=>{e.exports=s},171:e=>{e.exports=u},948:e=>{e.exports=i},186:e=>{e.exports=r},553:e=>{e.exports=t},612:e=>{e.exports=JSON.parse('{"Wd":"Manifests fail to download.","zZ":"Manifest for the web part {0} is null.","zI":"Manifest for the web part {0} is invalid.","GU":"This is a read-only property.","iT":"BaseClientSideWebPart is an abstract class and must be extended before use.","RR":"Render method needs to be overriden in the derived class of web part {0}.","K8":"Web part {0} must inherit from the BaseClientSideWebPart class.","OC":"Web part {0} was not initialized properly. Web parts must be instantiated using the ClientSideWebPartManager. Many web part features cannot be used till the initialization is complete.","nc":"Null property bag is not allowed for web part {0}. Empty property bag is supported.","_7":"Module is not loaded or not defined in the manifest for web part {0}.","Y1":"Bootstrap module for web part {0} is not loaded. Module names exported by the bundle are \\u0027{1}\\u0027.","Rg":"Bootstrap module for web part {0} not of the correct type. Make sure to export your web part as \\u0027export default WebPartName\\u0027.","V6":"The class for web part {0} is missing an expected member \\u0027{1}\\u0027.","RY":"Unable to load web part {0} script resources due to: {1}.","mv":"Serialization failed for web part {0}.","AS":"renderCompleted is not called for an asynchronously rendered web part {0}.","vF":"Attempted to call first time render more than once for the web part {0}. Please contact Microsoft developer support to resolve this.","Cb":"Invalid SPLINK attribute value {0}","AN":"Invalid SPLINK index value {0}","Q":"Loading {0}...","K4":"onAfterDeserialize for web part {0} returned null or undefined.","N$":"onInit method for web part {0} returned null or undefined Promise.","OQ":"{0} web part","Um":"Something went wrong","Oi":"If the problem persists, contact the site administrator and give them the information in Technical Details.","ge":"Technical Details","KO":"CALL STACK:{0}{1}","Ec":"ERROR:{0}{1}{0}{0}{2}{3}","_U":"The web part was modified by the Pages API ({0}) on {1} at {2}.","qz":"Webpart {0} is requested to delete.","sr":"Webpart {0} render callback promise for resolve or reject is undefined.","Dv":"Webpart {0} render timeout.","rx":"Audience targeting","pc":"Select audiences to target this card to.","l1":"Target this entire web part to specific audiences.","_w":"{0} Properties","i9":"Card is not available: {0}. It might have been removed or blocked by the Teams administrator."}')}
},g={};function v(e){var t=g[e];if(void 0!==t)return t.exports;var n=g[e]={exports:{}};return b[e].call(n.exports,n,n.exports,v),n.exports}v.m=b,v.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return v.d(t,{a:t}),t},p=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,v.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=Object.create(null);v.r(n);var a={};f=f||[null,p({}),p([]),p(p)];for(var i=2&t&&e;"object"==typeof i&&!~f.indexOf(i);i=p(i))Object.getOwnPropertyNames(i).forEach(t=>a[t]=()=>e[t]);return a.default=()=>e,v.d(n,a),n},v.d=(e,t)=>{for(var n in t)v.o(t,n)&&!v.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},v.f={},v.e=e=>Promise.all(Object.keys(v.f).reduce((t,n)=>(v.f[n](e,t),t),[])),v.u=e=>"chunk."+{725:"sp-webpart-base-iframedwebpartcontroller",971:"spfx-core-teamsenv-teamsJs-v2"}[e]+"_none_"+{725:"fc0d590955c8ccc53118",971:"dc4bd044287528c44a81"}[e]+".js",v.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),m={},_="974a7777-0990-4136-8fa6-95d80114c2e0_1.19.0:",v.l=(e,t,n,a)=>{if(m[e])m[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==_+n){i=c;break}}i||(r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,v.nc&&i.setAttribute("nonce",v.nc),i.setAttribute("data-webpack",_+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous")),m[e]=[t];var d=(t,n)=>{i.onerror=i.onload=null,clearTimeout(l);var a=m[e];if(delete m[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},l=setTimeout(d.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=d.bind(null,i.onerror),i.onload=d.bind(null,i.onload),r&&document.head.appendChild(i)}},v.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},h=e?e.src:"",v.p=h.slice(0,h.lastIndexOf("/")+1),v.f.compat=(e,t)=>{for(var n=function(e){return{725:[{i:"8496636c-2300-4915-abef-20de64c98d8b",v:"1.19.0",m:61}]}[e]||[]}(e),a=0;a<n.length;a++)v.m[n[a].m]||(e=>{t.push(y.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{v.m[e.m]=e=>e.exports=t}))})(n[a])};var y=v(37);(()=>{var e={505:0};v.f.j=(t,n)=>{var a=v.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=v.p+v.u(t),o=new Error;v.l(r,n=>{if(v.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)v.o(o,a)&&(v.m[a]=o[a]);s&&s(v)}for(t&&t(n);c<r.length;c++)i=r[c],v.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_974a7777-0990-4136-8fa6-95d80114c2e0_1.19.0"]=self["webpackJsonp_974a7777-0990-4136-8fa6-95d80114c2e0_1.19.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var S={};return(()=>{v.r(S),v.d(S,{BaseClientSideWebPart:()=>Y,BaseWebPart:()=>G,BaseWebPartContext:()=>i,CONTENT_PANEL_TOGGLED:()=>le,ClientSideWebPartManager:()=>ve,ClientSideWebPartManagerFactory:()=>Se,DynamicDataSharedDepth:()=>u,PROPERTY_PANE_TOGGLED:()=>ue,PROPERTY_PANE_WILL_OPEN:()=>de,PropertyPaneButton:()=>x,PropertyPaneButtonType:()=>d,PropertyPaneCheckbox:()=>C,PropertyPaneChoiceGroup:()=>O,PropertyPaneCustomField:()=>I,PropertyPaneDropdown:()=>w,PropertyPaneDropdownOptionType:()=>l,PropertyPaneDynamicField:()=>E,PropertyPaneDynamicFieldSet:()=>A,PropertyPaneDynamicTextField:()=>F,PropertyPaneFieldType:()=>c,PropertyPaneHorizontalRule:()=>L,PropertyPaneLabel:()=>k,PropertyPaneLink:()=>M,PropertyPaneSlider:()=>P,PropertyPaneTextField:()=>T,PropertyPaneToggle:()=>U,WebPartContext:()=>r,WebPartDataConverter:()=>De,WebPartFormFactor:()=>re,WebPartIsolationLevel:()=>o,_AdaptiveCardExtensionWidthCalculator:()=>Ie,_BaseWebPartHost:()=>_,_ClientSideWebPartStatusRenderer:()=>ie,_IframedWebPartAction:()=>xe.D,_MinimalWebPartContainer:()=>Ce,_MinimalWebPartHost:()=>h,_PropertyPaneLoader:()=>$,_TeamsAwareWebPartHost:()=>g,_TeamsEnvironmentManager:()=>b,_WebPartWidthCacheManager:()=>W,_audienceFormServiceKey:()=>B,_getErrorAceLoadConfiguration:()=>me});var e=v(553),t=v(866),n=v(878);const a=function(){function e(e,t,n,a,i,r,o){this._open=e,this._close=t,this._refresh=n,this._openDetails=a,this._isRenderedByWebPart=i,this._isPropertyPaneOpen=r,this._isContentPanelOpen=o,this.open=this.open.bind(this),this.close=this.close.bind(this),this.refresh=this.refresh.bind(this),this.openDetails=this.openDetails.bind(this),this.isRenderedByWebPart=this.isRenderedByWebPart.bind(this)}return e.prototype.open=function(){this._open()},e.prototype.close=function(){this._close()},e.prototype.refresh=function(){this._refresh()},e.prototype.openDetails=function(e){this._openDetails(e)},e.prototype.isRenderedByWebPart=function(){return this._isRenderedByWebPart()},e.prototype.isPropertyPaneOpen=function(e){return this._isPropertyPaneOpen(e)},e.prototype.isContentPanelOpen=function(){var e;return!!(null===(e=this._isContentPanelOpen)||void 0===e?void 0:e.call(this))},e}(),i=function(t){function i(e){var i=t.call(this,e)||this;return n.Validate.isNotNullOrUndefined(e,"webpart context"),n.Validate.isNotNullOrUndefined(e.instanceId,"webpart context instanceId"),n.Validate.isNotNullOrUndefined(e.webPartTag,"webpart context webPartTag"),n.Validate.isNotNullOrUndefined(e.host,"webpart context host"),n.Validate.isNotNullOrUndefined(e.isPropertyPaneRenderedByWebPart,"webpart context isPropertyPaneRenderedByWebPart"),n.Validate.isNotNullOrUndefined(e.isPropertyPaneOpen,"webpart context isPropertyPaneOpen"),n.Validate.isNotNullOrUndefined(e.requestPropertyPaneAction,"webpart context requestPropertyPaneAction"),n.Validate.isNotNullOrUndefined(e.formFactor,"webpart context form factor"),i._webPartTag=e.webPartTag,i._host=e.host,i._requestPropertyPaneAction=e.requestPropertyPaneAction,i._isPropertyPaneRenderedByWebPart=e.isPropertyPaneRenderedByWebPart,i._isPropertyPaneOpen=e.isPropertyPaneOpen,i._isContentPanelOpen=e.isContentPanelOpen,i._privateDataUpdatedEvent=e._dataUpdatedEvent,i._formFactor=e.formFactor,i._propertyPaneAccessor=new a(function(){i._requestPropertyPaneAction(i.instanceId,"Open",!0)},function(){i._requestPropertyPaneAction(i.instanceId,"Close",!0)},function(){i._requestPropertyPaneAction(i.instanceId,"Refresh",!0)},function(e){i._requestPropertyPaneAction(i.instanceId,"OpenDetails",!0,e)},function(){return i._isPropertyPaneRenderedByWebPart()},function(e){return i._isPropertyPaneOpen(e)},function(){return i._isContentPanelOpen()}),i}return(0,e.__extends)(i,t),Object.defineProperty(i.prototype,"webPartTag",{get:function(){return this._webPartTag},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"propertyPane",{get:function(){return this._propertyPaneAccessor},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"formFactor",{get:function(){return this._formFactor},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"host",{get:function(){return this._host},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"_dataUpdatedEvent",{get:function(){return this._privateDataUpdatedEvent},enumerable:!1,configurable:!0}),i}(t.BaseComponentContext),r=function(t){function a(e){var a=t.call(this,e)||this;return n.Validate.isNotNullOrUndefined(e.domElement,"webpart context domElement"),n.Validate.isNotNullOrUndefined(e.statusRenderer,"webpart context statusRenderer"),a._domElement=e.domElement,a._statusRenderer=e.statusRenderer,a._pageLayoutType=e.pageLayoutType,a._teams=e.microsoftTeams,a._sdks=e.sdks,a._widthCacheKey=e.widthCacheKey,a._sdksAsync=e.sdksAsync,a._getPositionOnPage=e.getPositionOnPage,a}return(0,e.__extends)(a,t),Object.defineProperty(a.prototype,"domElement",{get:function(){return this._domElement},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"sdks",{get:function(){return this._sdks},enumerable:!1,configurable:!0}),a.prototype._getSdksAsync=function(){return this._sdksAsync},Object.defineProperty(a.prototype,"statusRenderer",{get:function(){return this._statusRenderer},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"microsoftTeams",{get:function(){return this._teams},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"widthCacheKey",{get:function(){return this._widthCacheKey},enumerable:!1,configurable:!0}),a.prototype._getPageLayoutType=function(){return this._pageLayoutType},a.prototype._setTeams=function(e){this._teams=e},a}(i);var o;!function(e){e.None="None",e.DomIsolation="DOMIsolation"}(o||(o={}));var s,c,d,l,u,f=v(948),p=v(186),m=v(672),_=function(){function e(e){this.serviceScope=e}return e.prototype.onBeforeWebPartLoad=function(e){p._PerformanceLogger.devMark("ClientSideWebPartManager.load(".concat(e.webPartTag,").start")),p._PerformanceLogger.startMarkForComponent(e.webPartTag)},e.prototype.onAfterWebPartLoad=function(e){p._PerformanceLogger.devMark("ClientSideWebPartManager.load(".concat(e.webPartTag,").end")),p._PerformanceLogger.markComponentModuleLoaded(e.webPartTag)},e.prototype.onAfterWebPartLoadFailed=function(e,t){p._PerformanceLogger.endFailureForComponent(e.webPartTag,"Load",t,void 0,"ViewMode WebPart Failure"),e.displayMode===n.DisplayMode.Edit&&e.manifest.isInternal&&e.serviceScope&&this._logFailuresForEditCustomerPromise(e.manifest.alias,t,"Load",e.serviceScope,"WebPart Load Failure")},e.prototype.onBeforeWebPartInitializeOld=function(e){p._PerformanceLogger.devMark("ClientSideWebPartManager.initialize(".concat(e.webPartTag,").start"))},e.prototype.onBeforeWebPartInitialize=function(e){return p._PerformanceLogger.devMark("ClientSideWebPartManager.initialize(".concat(e.webPartTag,").start")),Promise.resolve()},e.prototype.onAfterWebPartInitialize=function(e){p._PerformanceLogger.devMark("ClientSideWebPartManager.initialize(".concat(e.webPartTag,").end"))},e.prototype.onAfterWebPartInitializeFailed=function(e,t){p._PerformanceLogger.endFailureForComponent(e.webPartTag,"Initialize",t),e.displayMode===n.DisplayMode.Edit&&e.manifest.isInternal&&e.serviceScope&&this._logFailuresForEditCustomerPromise(e.manifest.alias,t,"Initialize",e.serviceScope,"WebPart Init Failure")},e.prototype.onBeforeWebPartRender=function(e){p._PerformanceLogger.devMark("ClientSideWebPartManager.render(".concat(e.webPartTag,").start"))},e.prototype.onAfterWebPartRender=function(e){"number"==typeof e.renderCompleteTime?p._PerformanceLogger.endMarkForComponentWithTimestamp(e.webPartTag,e.renderCompleteTime):p._PerformanceLogger.endMarkForComponent(e.webPartTag)},e.prototype.onAfterWebPartRenderFailed=function(e,t){if(p._PerformanceLogger.endFailureForComponent(e.webPartTag,"Render",t),e.displayMode===n.DisplayMode.Edit&&e.manifest.isInternal&&e.serviceScope)if((0,m.qd)())this._logFailuresForEditCustomerPromise(e.manifest.alias,t,"Render",e.serviceScope);else{var a="";t.name&&(a+="name:"+t.name+";"),t.message&&(a+="msg:"+t.message+";"),e.webPartTag&&(a+="webPT:"+e.webPartTag+";"),e.domElement&&e.domElement.title&&(a+="domTitle:"+e.domElement.title+";"),e.manifest&&e.manifest.imagePreviewUrl&&(a+="previewImageUrl:"+e.manifest.imagePreviewUrl+";"),this._logFailuresForEditCustomerPromise(e.manifest.alias,t,"Render",e.serviceScope,a,"WebPart Render Failure")}},e.prototype.onAudiencesChanged=function(e,t){},e.prototype._logFailuresForEditCustomerPromise=function(e,t,n,a,i,r){if(!(0,m.qd)()&&i){var o={errorCode:"WebPartBase ".concat(e," Failure"),errorMessage:i,errorScenario:n,errorStack:null==t?void 0:t.stack,veto:r};(0,f._logFailuresForEditCustomerPromise)(o,a)}else o={errorCode:"WebPartBase ".concat(e," Failure"),errorMessage:t.message,errorScenario:n,errorStack:null==t?void 0:t.stack},(0,f._logFailuresForEditCustomerPromise)(o,a)},e}(),h=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n}(_),b=function(){function e(){}return e.initialize=function(){return!n._BrowserUtilities.isTeamsHosted()||e._teamsContext||e.sdkProvider?Promise.resolve():v.e(971).then(v.t.bind(v,423,23)).then(function(t){return t.initialize(),(n=t.getContext,new Promise(function(e,t){try{n(function(t){return e(t)})}catch(e){t(e)}})).then(function(n){e._teamsContext=n,e._teamsJs=t});var n})},e.getTeamsSDK=function(){return e.sdkProvider?e.sdkProvider:Promise.resolve({})},e.getTeamsContext=function(){return e._teamsContext},e.getTeamsJs=function(){return e._teamsJs},e}(),g=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.prototype.getAdditionalContextProperties=function(){var e=b.getTeamsJs();return e?{microsoftTeams:{teamsJs:e,context:b.getTeamsContext()}}:{}},n.prototype.getAdditionalContextPropertiesAsync=function(){return b.getTeamsSDK()},n.prototype.onBeforeWebPartInitialize=function(e){return t.prototype.onBeforeWebPartInitialize.call(this,e).then(function(){return b.initialize()})},n}(h),y=v(377),D=v(348);function I(e){return function(e){return{type:s.Custom,targetProperty:void 0,properties:e}}(e)}function x(e,t){return function(e,t){return{type:s.Button,targetProperty:e,properties:t}}(e,t)}function C(e,t){return function(e,t){return{type:s.CheckBox,targetProperty:e,properties:t}}(e,t)}function O(e,t){return function(e,t){return{type:s.ChoiceGroup,targetProperty:e,properties:t}}(e,t)}function w(e,t){return function(e,t){return{type:s.Dropdown,targetProperty:e,properties:t}}(e,t)}function E(e,t){return function(e,t){return{type:s.DynamicField,targetProperty:e,properties:t}}(e,t)}function A(e){return function(e){return{type:s.DynamicFieldSet,targetProperty:"",properties:e}}(e)}function L(){return{type:s.HorizontalRule,targetProperty:void 0,properties:void 0}}function k(e,t){return function(e,t){return{type:s.Label,targetProperty:e,properties:t}}(e,t)}function M(e,t){return function(e,t){return{properties:t,type:s.Link,targetProperty:void 0}}(0,t)}function P(e,t){return function(e,t){return{type:s.Slider,targetProperty:e,properties:t}}(e,t)}function T(e,t){return function(e,t){return{type:s.TextField,targetProperty:e,properties:t}}(e,t)}function U(e,t){return function(e,t){return{type:s.Toggle,targetProperty:e,properties:t}}(e,t)}function F(e,t){return function(e,t){return{type:s.DynamicTextField,targetProperty:e,properties:t}}(e,t)}!function(e){e[e.Custom=1]="Custom",e[e.CheckBox=2]="CheckBox",e[e.TextField=3]="TextField",e[e.Toggle=5]="Toggle",e[e.Dropdown=6]="Dropdown",e[e.Label=7]="Label",e[e.Slider=8]="Slider",e[e.Heading=9]="Heading",e[e.ChoiceGroup=10]="ChoiceGroup",e[e.Button=11]="Button",e[e.HorizontalRule=12]="HorizontalRule",e[e.Link=13]="Link",e[e.DynamicField=14]="DynamicField",e[e.DynamicTextField=15]="DynamicTextField",e[e.DynamicFieldSet=16]="DynamicFieldSet",e[e.SpinButton=17]="SpinButton",e[e.ThumbnailPicker=18]="ThumbnailPicker",e[e.IconPicker=19]="IconPicker",e[e.AlternativeText=20]="AlternativeText",e[e.WebPartTitleHeading=21]="WebPartTitleHeading"}(s||(s={})),function(e){e[e.Custom=1]="Custom",e[e.CheckBox=2]="CheckBox",e[e.TextField=3]="TextField",e[e.Toggle=5]="Toggle",e[e.Dropdown=6]="Dropdown",e[e.Label=7]="Label",e[e.Slider=8]="Slider",e[e.Heading=9]="Heading",e[e.ChoiceGroup=10]="ChoiceGroup",e[e.Button=11]="Button",e[e.HorizontalRule=12]="HorizontalRule",e[e.Link=13]="Link",e[e.DynamicField=14]="DynamicField",e[e.DynamicTextField=15]="DynamicTextField",e[e.DynamicFieldSet=16]="DynamicFieldSet",e[e.SpinButton=17]="SpinButton",e[e.ThumbnailPicker=18]="ThumbnailPicker",e[e.IconPicker=19]="IconPicker",e[e.AlternativeText=20]="AlternativeText",e[e.WebPartTitleHeading=21]="WebPartTitleHeading"}(c||(c={})),function(e){e[e.Normal=0]="Normal",e[e.Primary=1]="Primary",e[e.Hero=2]="Hero",e[e.Compound=3]="Compound",e[e.Command=4]="Command",e[e.Icon=5]="Icon"}(d||(d={})),function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header"}(l||(l={})),function(e){e[e.None=0]="None",e[e.Source=1]="Source",e[e.Property=2]="Property"}(u||(u={}));var H,R=v(612);!function(e){e[e.ModuleUndefined=0]="ModuleUndefined",e[e.ModuleNotLoaded=1]="ModuleNotLoaded",e[e.IncorrectBoostrapModule=2]="IncorrectBoostrapModule",e[e.MissingExpectedWebPartMemberError=3]="MissingExpectedWebPartMemberError",e[e.NonBaseWebPart=4]="NonBaseWebPart",e[e.ScriptLoadError=5]="ScriptLoadError",e[e.ManifestDownloadFailed=6]="ManifestDownloadFailed",e[e.ManifestNull=7]="ManifestNull",e[e.ManifestInvalid=8]="ManifestInvalid",e[e.BaseConstructError=9]="BaseConstructError",e[e.MustOverrideRender=10]="MustOverrideRender",e[e.NotInitializedError=11]="NotInitializedError",e[e.PropertyBagNull=12]="PropertyBagNull",e[e.OnAfterDeserializeReturnedNull=13]="OnAfterDeserializeReturnedNull",e[e.OnInitReturnedNullPromise=14]="OnInitReturnedNullPromise",e[e.ReadOnlyProperty=15]="ReadOnlyProperty",e[e.SerializationFailed=16]="SerializationFailed",e[e.FirstTimeRenderCalledMoreThanOnce=17]="FirstTimeRenderCalledMoreThanOnce",e[e.RenderCompletedCallNotCalled=18]="RenderCompletedCallNotCalled",e[e.InvalidSPLinkAttributeFormat=19]="InvalidSPLinkAttributeFormat",e[e.InvalidSPLinkIndex=20]="InvalidSPLinkIndex",e[e.GetDataReturnedNullPromise=21]="GetDataReturnedNullPromise",e[e.RenderPromiseUndefined=22]="RenderPromiseUndefined",e[e.RenderTimeout=23]="RenderTimeout"}(H||(H={}));var N=function(t){function a(e,i){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var s=this,c=e;return c&&((s=t.call(this,H[c],n.Text.format(a._errorCodeToMessageMap.get(c),r),i)||this).__proto__=a.prototype,s._id=c),s}return(0,e.__extends)(a,t),Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"category",{get:function(){return"SPWebPartErrorCode"},enumerable:!1,configurable:!0}),a.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new a(e,void 0,t)},a.createWithLogProperties=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return new a(e,t,n)},a._errorCodeToMessageMap=new Map([[H.ModuleUndefined,R._7],[H.ModuleNotLoaded,R.Y1],[H.IncorrectBoostrapModule,R.Rg],[H.MissingExpectedWebPartMemberError,R.V6],[H.NonBaseWebPart,R.K8],[H.ScriptLoadError,R.RY],[H.ManifestDownloadFailed,R.Wd],[H.ManifestNull,R.zZ],[H.ManifestInvalid,R.zI],[H.BaseConstructError,R.iT],[H.MustOverrideRender,R.RR],[H.NotInitializedError,R.OC],[H.PropertyBagNull,R.nc],[H.OnAfterDeserializeReturnedNull,R.K4],[H.OnInitReturnedNullPromise,R.N$],[H.ReadOnlyProperty,R.GU],[H.SerializationFailed,R.mv],[H.FirstTimeRenderCalledMoreThanOnce,R.vF],[H.RenderCompletedCallNotCalled,R.AS],[H.InvalidSPLinkAttributeFormat,R.Cb],[H.InvalidSPLinkIndex,R.AN],[H.RenderPromiseUndefined,R.sr],[H.RenderTimeout,R.Dv]]),a}(n.SPError),B=n.ServiceKey.createCustom("sp-property-pane.AudienceForm",function(e){return{}}),j=v(481),V="4eae8b0b-40f6-4ea9-aabb-b6834ae24532",z="f3bc67ee-015d-4678-a95f-c7e90ea62c1e";const G=function(a){function i(){var e=a.call(this)||this;if(e._initialized=!1,e._baseLogSource=y._LogSource.create("BaseWebPart"),e._hasEditLogged=!1,e._emptyResolvedPromise=Promise.resolve(),e._disposeDynamicPropertiesIfRequired=e._disposeDynamicPropertiesIfRequired.bind(e),e._onPropertyPaneFieldChanged=e._onPropertyPaneFieldChanged.bind(e),"BaseWebPart"===e.constructor.name)throw N.create(H.BaseConstructError);return e}return(0,e.__extends)(i,a),Object.defineProperty(i.prototype,"previewImageUrl",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"displayMode",{get:function(){return this._displayMode},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"modifiedByGraph",{get:function(){return this._modifiedByGraph},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dataVersion",{get:function(){return n.Version.parse("1.0")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"properties",{get:function(){if(this._initialized)return this._properties;throw N.create(H.NotInitializedError)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"propertiesMetadata",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"disableReactivePropertyChanges",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"accessibleTitle",{get:function(){return this._getDefaultAccessibleTitle()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"title",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"iconImageUrl",{get:function(){return this._iconImageUrl},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"description",{get:function(){return this._description},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"audiences",{get:function(){return this._audiences},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"_persistedProperties",{get:function(){return this.disableReactivePropertyChanges&&this._backupProperties?this._backupProperties:this.properties},enumerable:!1,configurable:!0}),i.prototype._getPropertyPaneData=function(e,t){var n=this;return this._loadPropertyPaneResources().then(function(){var a=e?n.getDetailsPaneConfiguration(t):n.getPropertyPaneConfiguration();return(n.context.manifest.id===z||(0,j.Mn)()&&!a.disableAudiencePicker)&&n._addAudienceTargetingConfiguration(a),n._fixUpDynamicDataConfiguration(a),{webPartId:n.context.instanceId,title:n.title,isReactive:!n.disableReactivePropertyChanges,configuration:a,properties:n._cloneProperties(n.properties),onPropertyPaneFieldChanged:void 0,onConfigurationEvent:void 0,onRendered:n.onPropertyPaneRendered,dynamicConfiguration:{defaultCallback:function(){n._dynamicPropertyRefresh()}.bind(n),dynamicDataProvider:n.context.dynamicDataProvider}}})},i.prototype._loadPropertyPaneResources=function(){return this._loadPropertyPaneResourcesPromise||(this._loadPropertyPaneResourcesPromise=this.loadPropertyPaneResources()),this._loadPropertyPaneResourcesPromise},i.prototype._onPropertyPaneFieldChanged=function(e,n,a){var i,r,o,s=this,d=this.context.manifest.id===z?"ACE":"WebPart";try{var l=D.get(this._properties,e);if(!D.isEqual(l,n)||a===c.Button||a===c.Custom){if(!(0,m.xR)()&&this.manifest.isInternal&&(o=new y._QosMonitorShareFailureWithCP("PropertyPane.".concat(d,".").concat(this.manifest.alias,".Update"),!1,[{errorModuleName:"".concat(d," PropertyPaneUpdate Failure"),veto:"WebPart Property Pane Failure",logFailure:this.context.serviceScope.consume(f._EditModeCustomerPromiseHandler.serviceKey).logFailure}])),this.disableReactivePropertyChanges&&!this._backupProperties&&(this._backupProperties=this._cloneProperties(this.properties)),l instanceof t.DynamicProperty&&!(n instanceof t.DynamicProperty)){var u=new t.DynamicProperty(this.context.dynamicDataProvider,function(){s._dynamicPropertyRefresh()}.bind(this));u.setValue(n),n=u}return e===V?(this._audiences=n,(0,j.Mn)()&&(y._EngagementLogger.logEvent("".concat(d,".PropertyPane"),"AudienceUpdated"),null===(r=(i=this.context.host).onAudiencesChanged)||void 0===r||r.call(i,this.instanceId,n))):this._updateProperty(e,n),this.onPropertyPaneFieldChanged(e,l,n),this._afterPropertyUpdated(!this.disableReactivePropertyChanges),!(0,m.xR)()&&o&&o.writeSuccess(),!0}}catch(e){throw!(0,m.xR)()&&o&&o.writeUnexpectedFailure(e.message),e}return!1},i.prototype._onPropertyPaneLifeCycleEvent=function(e){var t=this;switch(this.context.host.propertyPaneLifeCycleEventCallback&&this.context.host.propertyPaneLifeCycleEventCallback(e,{webPartData:this._internalSerialize(),isPropertyPaneReactive:this._isPropertyPaneReactive()}),e){case"ConfigurationStart":this._loadPropertyPaneResources().then(function(){return t.onPropertyPaneConfigurationStart()}).catch(function(e){return y._TraceLogger.logVerboseData({source:t._baseLogSource,message:e.message})});break;case"ConfigurationComplete":this.disableReactivePropertyChanges&&this._backupProperties&&(this._properties=this._backupProperties,this._backupProperties=void 0),this.onPropertyPaneConfigurationComplete();break;case"ApplyClicked":this._backupProperties=this.properties,(0,m.rf)()?(this.onAfterPropertyPaneChangesApplied(),this._afterPropertyUpdated(!0)):this._onPropertyPaneChangesApplied().then(function(){t.onAfterPropertyPaneChangesApplied(),t._afterPropertyUpdated(!0)}).catch(function(e){throw y._TraceLogger.logVerboseData({source:t._baseLogSource,message:e.message}),e})}},i.prototype._isPropertyPaneReactive=function(){return!this.disableReactivePropertyChanges},i.prototype._internalSerialize=function(){var e,a=this;return function(e,t,a){n.Validate.isNotNullOrUndefined(e,"method");try{e()}catch(e){throw a&&y._TraceLogger.logError(a,new Error("Error: "+e)),t.innerError=e,t}}(function(){a.onBeforeSerialize();var i=JSON.stringify(a.properties);if(!a._hasEditLogged&&a._initPropertiesSnapshot!==i){var r=!!a.context.manifest.isInternal,o=new y._LogEntry(a._baseLogSource.id,"WebPartEdited",y._LogType.Event,{alias:a.context.manifest.alias,isInternal:r.toString()});y._EngagementLogger.logEventWithLogEntry(o),a._hasEditLogged=!0}var s=a._serialize();n.Validate.isNotNullOrUndefined(s.dataVersion,"serialized data version"),i&&-1!==i.indexOf(t.DynamicProperty._TYPE_NAME)&&a._serializeDynamicData(s),e={id:a.context.manifest.id,instanceId:a.context.instanceId,title:a.title,description:a.description,audiences:a.audiences,serverProcessedContent:s.serverProcessedContent,dynamicDataPaths:s.dynamicDataPaths,dynamicDataValues:s.dynamicDataValues,dataVersion:s.dataVersion.toString(),properties:s.properties},(0,m.WP)()||(e.containsDynamicDataSource=a._containsDynamicDataSource)},N.create(H.SerializationFailed,this.context.webPartTag),this._baseLogSource),e},i.prototype._internalDispose=function(){this._disposeDynamicPropertiesIfRequired(),a.prototype.dispose.call(this)},i.prototype._internalOnAfterResize=function(){},i.prototype._internalSetWebPartData=function(e){var t=this.properties;(0,m.re)()||(this._previousState=void 0),this._internalDeserialize(e),this.onAfterPropertiesUpdatedExternally(t)},i.prototype._internalSetDisplayMode=function(e){if(this._displayMode!==e){var t=this._displayMode;this._displayMode=e,this.onDisplayModeChanged(t)}},i.prototype._internalSetDirtyBit=function(){if(this.displayMode!==n.DisplayMode.Read){var e=this._internalSerialize(),t=JSON.stringify(e);this._previousState?this._previousState!==t&&this.context.host.setDirty&&(this.context.host.setDirty(this.context.instanceId,e),this._previousState=t):this._previousState=t}},i.prototype._internalInitialize=function(e,t,i){if(n.Validate.isNotNullOrUndefined(e,"webPartContext"),function(e){if(e){Object.isFrozen(e)||Object.freeze(e);var t=0,n=function(e){++t>5||Object.getOwnPropertyNames(e).forEach(function(t){var a=e[t];"object"!=typeof a||!a||D.isElement(a)||Object.isFrozen(a)||n(a)})};n(e)}}(e.manifest),a.prototype._initializeContext.call(this,e),this.onDispose=this.onDispose.bind(this),this.onPropertyPaneRendered=this.onPropertyPaneRendered.bind(this),this._initialized=!0,this._displayMode=i,this._renderedFromPersistedData=t,!this._renderedFromPersistedData){var r=this.context.manifest.isInternal||!1,o=new y._LogEntry(this._baseLogSource.id,"WebPartAdded",y._LogType.Event,{alias:this.context.manifest.alias,isInternal:r.toString()});y._EngagementLogger.logEventWithLogEntry(o)}},i.prototype._internalDeserialize=function(e){if((0,m.GV)()||(e=D.cloneDeep(e)),e){this._previousState||(this._previousState=JSON.stringify(e)),e.title&&(this._title=e.title),e.modifiedByGraph&&(this._modifiedByGraph=e.modifiedByGraph),e.description&&(this._description=e.description),e.iconImageUrl&&(this._iconImageUrl=e.iconImageUrl),this._audiences=e.audiences||[],"string"!=typeof e.dataVersion&&(e.dataVersion=this.dataVersion.toString());var t={properties:e.properties,serverProcessedContent:e.serverProcessedContent,dynamicDataPaths:e.dynamicDataPaths,dynamicDataValues:e.dynamicDataValues,dataVersion:n.Version.tryParse(e.dataVersion)},a=(0,j.lB)(),i=void 0;a&&(i=this._reInstateServerProcessedData(t.properties,t.serverProcessedContent)),(0,m.WP)()||(t.containsDynamicDataSource=e.containsDynamicDataSource,this._containsDynamicDataSource=!!t.containsDynamicDataSource),this._deserializeDynamicData(t),this._initializeDynamicPropertiesIfRequired(t.properties),a||(i=this._reInstateServerProcessedData(t.properties,t.serverProcessedContent));var r=this.onAfterDeserialize(i,t.dataVersion);if(this._initPropertiesSnapshot=JSON.stringify(i),!r)throw N.create(H.OnAfterDeserializeReturnedNull,this.context.webPartTag);this._properties=r}},i.prototype.getTopActionsConfiguration=function(){},i.prototype.onInit=function(){return Promise.resolve(void 0)},i.prototype.onDisplayModeChanged=function(e){},i.prototype.onBeforeSerialize=function(){},i.prototype.onAfterDeserialize=function(e,t){return e},i.prototype.loadPropertyPaneResources=function(){return this._emptyResolvedPromise},i.prototype.getPropertyPaneConfiguration=function(){return{pages:[]}},i.prototype.getDetailsPaneConfiguration=function(e){return{pages:[]}},i.prototype.onDispose=function(){},i.prototype.onPropertyPaneFieldChanged=function(e,t,n){},i.prototype.onPropertyPaneConfigurationStart=function(){},i.prototype.onPropertyPaneConfigurationComplete=function(){},i.prototype.onAfterPropertyPaneChangesApplied=function(){},i.prototype.onPropertyPaneRendered=function(){},i.prototype.onAfterPropertiesUpdatedExternally=function(e){return this._refresh()},i.prototype._internalGetData=function(){return this._emptyResolvedPromise},i.prototype._getDefaultAccessibleTitle=function(){return n.Text.format(R.OQ,this.title)},i.prototype._onPropertyPaneChangesApplied=function(){return Promise.resolve(this._properties)},i.prototype._reInstateServerProcessedData=function(e,a){var i=this.propertiesMetadata;if(!e)return{};var r=e;return((0,j.lB)()?this._renderedFromPersistedData:n._SPFlight.isEnabled(60834)&&a||this._renderedFromPersistedData)?(t._PropertyMetadataProcessor.reInstateServerProcessedData(i,r,a,this.context.manifest),r):r},i.prototype._forEachPropertyWithMetaData=function(e,t){if(this.propertiesMetadata)for(var n=function(n,i){a._validateAndIteratePath(n,t||a.properties,function(t,n){e(t,i,n)})},a=this,i=0,r=Object.entries(this.propertiesMetadata);i<r.length;i++){var o=r[i];n(o[0],o[1])}},i.prototype._validateAndIteratePath=function(e,t,n){var a=(e.match(/\*/g)||[]).length;if(a>1)console.warn("Invalid property path: Multiple wildcards are not supported in property paths.\nEntry with path '".concat(e,"' got ignored in the properties metadata."));else if(1===a){var i=e.indexOf("[*]");if(i<-1)return void console.warn("Invalid property path: Wildcards are only supported inside brackets to select array\nindices as in 'foo[*].bar'. Entry with path '".concat(e,"' got ignored in the properties metadata."));var r=e.substr(0,i),o=D.get(t,r);if(!o)return void console.warn("Invalid property path: Could not find an array named '".concat(r,"' in the properties.\nEntry with path '").concat(e,"' got ignored in the properties metadata."));for(var s=0;s<o.length;s++)n(e.replace("*","".concat(s)),s)}else n(e)},i.prototype._afterPropertyUpdated=function(e){this._internalSetDirtyBit(),e&&this._refresh()},i.prototype._fixUpDynamicDataConfiguration=function(e){var t=this;e.pages.forEach(function(e){e.groups.forEach(function(e){if("primaryGroup"in e){var n=e,a=n.primaryGroup,i=n.secondaryGroup;e=n.showSecondaryGroup?i:a}(e=e).groupFields.forEach(function(e){if(e.type===c.DynamicTextField){var n=e.properties;n.dynamicDataProvider=t.context.dynamicDataProvider,n.changeCallback=function(){t._dynamicPropertyRefresh()}.bind(t)}})})})},i.prototype._addAudienceTargetingConfiguration=function(e){e.pages&&0!==e.pages.length||(e.pages=[{groups:[]}]);var t=this.context.serviceScope.consume(B);if(t&&t.renderAudienceFormPropertyPaneField){var n=this.context.manifest.id===z;e.pages[0].groups.push({groupName:R.rx,groupFields:[t.renderAudienceFormPropertyPaneField({pageContext:this.context.pageContext.legacyPageContext,audiences:this.audiences,limit:50,propertyName:V,helpLink:n?"https://go.microsoft.com/fwlink/?linkid=2155166":"https://go.microsoft.com/fwlink/?linkid=2134207",tooltipText:n?R.pc:R.l1})]})}},i.prototype._serialize=function(){var e={htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},n=this._cloneProperties(this._persistedProperties);return D.set(n,"",void 0),t._PropertyMetadataProcessor.serializeServerProcessedData(this.propertiesMetadata,n,e),{dataVersion:this.dataVersion,properties:n,serverProcessedContent:e}},i.prototype._serializeDynamicData=function(e){for(var n=e.properties,a={},i={},r=D.findKey(n,{__type:t.DynamicProperty._TYPE_NAME});r;){var o=D.get(n,r+".reference"),s=D.get(n,r+".value");if(o)a[r]=o,D.unset(n,r);else{if(void 0===s)throw new Error("Dynamic Data is misconfigured");i[r]=s,D.unset(n,r)}r=D.findKey(n,{__type:t.DynamicProperty._TYPE_NAME})}e.dynamicDataPaths=a,e.dynamicDataValues=i},i.prototype._deserializeDynamicData=function(e){var n=this;if(e.dynamicDataPaths)for(var a in e.dynamicDataPaths)e.dynamicDataPaths.hasOwnProperty(a)&&((i=new t.DynamicProperty(this.context.dynamicDataProvider,function(){n._dynamicPropertyRefresh()}.bind(this))).setReference(e.dynamicDataPaths[a]),D.set(e.properties,a,i));if(e.dynamicDataValues)for(var a in e.dynamicDataValues){var i;e.dynamicDataValues.hasOwnProperty(a)&&((i=new t.DynamicProperty(this.context.dynamicDataProvider,function(){n._dynamicPropertyRefresh()}.bind(this))).setValue(e.dynamicDataValues[a]),D.set(e.properties,a,i))}},i.prototype._initializeDynamicPropertiesIfRequired=function(e){var n=this,a=new Map([["boolean",!1],["number",0],["string",""],["array",[]],["object",{}]]);this._forEachPropertyWithMetaData(function(i,r){if(r.dynamicPropertyType){var o=D.get(e,i);if(!(o instanceof t.DynamicProperty)){var s=void 0;r.dynamicPropertyType,s=new t.DynamicProperty(n.context.dynamicDataProvider,function(){n._dynamicPropertyRefresh()}.bind(n)),o=o||a.get(r.dynamicPropertyType),s.setValue(o),D.set(e,i,s)}}},e)},i.prototype._disposeDynamicPropertiesIfRequired=function(){var e=this;this._forEachPropertyWithMetaData(function(n,a){if(a.dynamicPropertyType){var i=D.get(e._persistedProperties,n);i instanceof t.DynamicProperty&&i.dispose()}},this._persistedProperties)},i.prototype._updateProperty=function(e,t){D.update(this.properties,e,function(){return t})},i.prototype._cloneProperties=function(e){return D.cloneDeepWith(e,function(e){if(e instanceof t.DynamicProperty)return e._cloneDeep(e)})},i}(t.BaseComponent),K=function(){function e(){}return e.disableAutomaticPostbacks=function(e,t){n.Validate.isNotNullOrUndefined(e,"domElement"),t===n.EnvironmentType.ClassicSharePoint&&(e.addEventListener("click",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},!0),e.addEventListener("keydown",function(e){13===e.keyCode&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},!0))},e.removeFabricLinks=function(){var e=document.getElementsByTagName("link");if(e&&e.length)for(var t=0;t<e.length;t++)if(e[t]&&-1!==e[t].href.indexOf("fabric.min.css")){var n=e[t].parentNode;n&&n.removeChild(e[t])}},e}(),W=function(){function e(){}return e.get=function(t){return e._sectionWidthCache.get(t)},e.getOrCalculateWidth=function(t,n){if(void 0===n)return e.calculateWebPartWidth(t);var a=e.get(n);return void 0===a&&(a=e.calculateWebPartWidth(t))>0&&e._put(n,a),a},e.clear=function(){e._sectionWidthCache.clear()},e.calculateWebPartWidth=function(e){var t=n._BrowserDetection.getBrowserInformation().browser;return t===n._Browser.Edge||t===n._Browser.IE?e.getBoundingClientRect().width:parseFloat(window.getComputedStyle(e).width)||0},e._put=function(t,n){e._sectionWidthCache.set(t,n)},e._sectionWidthCache=new Map,e}();var q=v(230);q.loadStyles(".a_a_7caff1a1{display:inline-block;left:0;overflow:hidden;padding:12px 0;position:relative;right:0;top:0;z-index:1}[dir=ltr] .a_a_7caff1a1{text-align:left}[dir=rtl] .a_a_7caff1a1{text-align:right}.b_a_7caff1a1{color:#605e5c;display:inline-block;font-weight:700;position:relative;white-space:pre-wrap}.c_a_7caff1a1{background:none;border:none;color:#0078d4;margin-top:20px;text-transform:uppercase}[dir=ltr] .c_a_7caff1a1{padding-left:0}[dir=rtl] .c_a_7caff1a1{padding-right:0}.e_a_7caff1a1{color:#0078d4;font-weight:400}.f_a_7caff1a1{color:#0078d4;font-weight:700}.g_a_7caff1a1{border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;text-indent:-9999px;width:1px}",!0);const Q="a_a_7caff1a1",Y=function(a){function i(){var e=a.call(this)||this;if(e._logSource=y._LogSource.create("BaseClientSideWebPart"),e._asyncRenderQosMonitor=new y._QosMonitor("WebPartAsyncRender"),e._asyncRenderCompleteCalled=!1,e._isVisible=!0,e._internalIsDisposing=!1,"BaseClientSideWebPart"===e.constructor.name)throw N.create(H.BaseConstructError);return e._firstTimeRenderPromises=[],e}return(0,e.__extends)(i,a),Object.defineProperty(i.prototype,"domElement",{get:function(){return this.context.domElement},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this.displayMode===n.DisplayMode.Read?this._width=W.getOrCalculateWidth(this.domElement,this._getExtendedWidthCacheKey()):void 0===this._width&&(this._width=W.calculateWebPartWidth(this.domElement)),this._width},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"renderedOnce",{get:function(){return!!this._renderedOnce},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"renderedFromPersistedData",{get:function(){return!!this._renderedFromPersistedData},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"canOpenPopupOnRender",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isRenderAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isVisible",{get:function(){return this.displayMode===n.DisplayMode.Edit||this._isVisible},set:function(e){var t,a;this.displayMode!==n.DisplayMode.Edit&&e!==this._isVisible&&(this._isVisible=e,null===(a=(t=this.context.host).onAfterWebPartVisibilityChanged)||void 0===a||a.call(t,this.context.instanceId,e))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"_isDisposing",{get:function(){return this._internalIsDisposing},enumerable:!1,configurable:!0}),i.prototype._internalOnAfterResize=function(){this._width=void 0,this.onAfterResize(this.width)},i.prototype._internalFirstTimeRender=function(){var e=this;if(this._renderPromiseResolver)throw N.create(H.FirstTimeRenderCalledMoreThanOnce,this.context.webPartTag);return new Promise(function(t,n){e._renderPromiseResolver=t,e._renderPromiseRejecter=n,e._onInViewport()})},i.prototype._internalSetDisplayMode=function(e){this.displayMode!==e&&(this._width=void 0,this._renderedFromPersistedData=!0),a.prototype._internalSetDisplayMode.call(this,e)},i.prototype._internalInitialize=function(e,n,i){a.prototype._internalInitialize.call(this,e,n,i),this._renderedOnce=!1,this.__type="BaseClientSideWebPart",this.render=this.render.bind(this),this.onDispose=this.onDispose.bind(this),this.renderError=this.renderError.bind(this),this.clearError=this.clearError.bind(this),this.renderCompleted=this.renderCompleted.bind(this),this._asyncRenderTimeout=this._asyncRenderTimeout.bind(this),this._internalHandleThemeChangedEvent=this._internalHandleThemeChangedEvent.bind(this),this._internalThemeProvider=this.context.serviceScope.consume(t.ThemeProvider.serviceKey),this._internalThemeVariant=this._internalThemeProvider.tryGetTheme(),this.onThemeChanged(this._internalThemeVariant),this._internalThemeProvider.themeChangedEvent.add(this,this._internalHandleThemeChangedEvent)},i.prototype._internalDispose=function(){var e;this._disposeAfterRenderPromises(),null===(e=this._internalThemeProvider)||void 0===e||e.themeChangedEvent.remove(this,this._internalHandleThemeChangedEvent)},i.prototype.renderCompleted=function(e,t){e?this._handleAsyncRenderFailed(e):this._renderCompleted(t)},i.prototype.onDisplayModeChanged=function(e){var t=this;a.prototype.onDisplayModeChanged.call(this,e),e!==this.displayMode&&Promise.all(this._firstTimeRenderPromises).then(function(){return t._renderWithAccessibleTitle()}).catch(function(e){return y._TraceLogger.logVerboseData({source:t._logSource,message:e.message})})},i.prototype.onDispose=function(){},i.prototype.onAfterResize=function(e){},i.prototype.onThemeChanged=function(e){},i.prototype.renderError=function(e){if(this.context.statusRenderer.clearLoadingIndicator(this.domElement),this.context.statusRenderer.renderError(this.domElement,e),this.displayMode===n.DisplayMode.Edit&&this.context.manifest.isInternal&&this.context.serviceScope){var t="";(0,m.qd)()?t=e.message:(e.name&&(t+="name:"+e.name+";"),e.message&&(t+="msg:"+e.message+";"),this.context&&this.context.webPartTag&&(t+="webPT:"+this.context.webPartTag+";"),this.iconImageUrl&&(t+="iconImageUrl:"+this.iconImageUrl+";"),this.title&&(t+="title:"+this.title+";"),this.previewImageUrl&&(t+="previewImageUrl:"+this.previewImageUrl+";"),this.context&&this.context.pageContext&&this.context.pageContext.web&&this.context.pageContext.web.absoluteUrl&&(t+="absUrl:"+this.context.pageContext.web.absoluteUrl+";"));var a={errorCode:"WebPartBase ".concat(this.context.manifest.alias," Failure"),errorMessage:t,errorScenario:"Render",errorStack:null==e?void 0:e.stack,veto:"WebPart Render Failure"};(0,f._logFailuresForEditCustomerPromise)(a,this.context.serviceScope)}y._TraceLogger.logError(this._logSource,e)},i.prototype.clearError=function(){this.context.statusRenderer.clearError(this.domElement)},i.prototype._refresh=function(){this._renderWithAccessibleTitle()},i.prototype._dynamicPropertyRefresh=function(){this.renderedOnce&&this.render()},i.prototype._disposeAfterRenderPromises=function(){var e=this;this.isDisposed||(0,m.rc)()||!(0,j.K4)()?a.prototype._internalDispose.call(this):(this._internalIsDisposing=!0,Promise.all(this._firstTimeRenderPromises).then(function(){e._internalIsDisposing=!1,a.prototype._internalDispose.call(e)},function(t){var n=t.message;y._TraceLogger.logVerboseData({source:e._logSource,message:n}),e._internalIsDisposing=!1,a.prototype._internalDispose.call(e)}))},i.prototype._getExtendedWidthCacheKey=function(){var e=this.context.widthCacheKey;return e?"".concat(this.displayMode,"-").concat(e):void 0},i.prototype._onInViewport=function(){var e=this;if(!this._renderPromiseResolver||!this._renderPromiseRejecter)throw N.create(H.RenderPromiseUndefined,this.context.webPartTag);var t=this.onInit();if(!t){var n=N.create(H.OnInitReturnedNullPromise,this.context.webPartTag);return this._renderPromiseRejecter(n),void this._clearRenderPromises()}this._firstTimeRenderPromises.push(t),t.then(function(){p._PerformanceLogger.markComponent(e.context.webPartTag,"init");var t=Promise.resolve();if(!(t=e._internalGetData()))throw N.create(H.GetDataReturnedNullPromise,e.context.webPartTag);return e._firstTimeRenderPromises.push(t),t.then(function(){p._PerformanceLogger.markComponent(e.context.webPartTag,"getDataComplete"),e.context.statusRenderer.clearLoadingIndicator(e.domElement),e.isRenderAsync&&e._startAsyncRenderGuardTimer(),e._renderWithAccessibleTitle(),p._PerformanceLogger.markComponent(e.context.webPartTag,"syncRender"),!(0,m.Ye)()&&e.isRenderAsync?e._syncRenderTime=p._PerformanceLogger.now():e._resolveOrRejectOnRenderPromise()})}).catch(function(t){e._renderPromiseRejecter&&(e._renderPromiseRejecter(t),e._clearRenderPromises())})},i.prototype._renderWithAccessibleTitle=function(){p._PerformanceLogger.devMark("webpart(".concat(this.context.webPartTag,")._renderWithAccessibleTitle"));var e=(0,m.wA)()?this.domElement:this.domElement.parentElement;if(this.render(),this.displayMode===n.DisplayMode.Edit){var t=this.accessibleTitle||this._getDefaultAccessibleTitle();if(t){var a="cswpAccessibleLabelContextual_".concat(this.context.instanceId),i=e.querySelector("#".concat(a)),r=!i;r&&((i=document.createElement("div")).id=a,i.className="g_a_7caff1a1",i.setAttribute("aria-hidden","true")),i.textContent=t,r&&e.appendChild(i)}K.disableAutomaticPostbacks(this.domElement,n.Environment.type)}},i.prototype._startAsyncRenderGuardTimer=function(){var e=this;this._clearAsyncRenderGuardTimer(),this._asyncRenderGuardTimer=window.setTimeout(function(){e._asyncRenderTimeout()},25e3),(0,m.JE)()||!0!==this._asyncRenderCompleteCalled||(this._renderCompleted(this._asyncRenderCompleteDidUpdate),this._asyncRenderCompleteCalled=!1,this._asyncRenderCompleteDidUpdate=void 0)},i.prototype._renderCompleted=function(e){this._asyncRenderGuardTimer?(this._clearAsyncRenderGuardTimer(),this._asyncRenderQosMonitor.writeSuccess({alias:this.context.manifest.alias,isInternal:this.context.manifest.isInternal,webPartId:this.context.manifest.id}),(0,m.Ye)()?this._resolveOrRejectOnRenderPromise():this._resolveOrRejectOnRenderPromise(void 0,e)):(0,m.JE)()||(this._asyncRenderCompleteCalled=!0,this._asyncRenderCompleteDidUpdate=e)},i.prototype._handleAsyncRenderFailed=function(e){this._asyncRenderGuardTimer&&(this._clearAsyncRenderGuardTimer(),this._logAsyncRenderError(e,"Failed"),this._resolveOrRejectOnRenderPromise(e))},i.prototype._asyncRenderTimeout=function(){if(this._asyncRenderGuardTimer){this._clearAsyncRenderGuardTimer();var e=N.create(H.RenderCompletedCallNotCalled,this.context.webPartTag);this._logAsyncRenderError(e,"Timeout"),this._resolveOrRejectOnRenderPromise()}},i.prototype._logAsyncRenderError=function(e,t){y._TraceLogger.logErrorData({source:this._logSource,error:e,serviceScope:this.context.serviceScope}),this._asyncRenderQosMonitor.writeUnexpectedFailure(t,e,{alias:this.context.manifest.alias,isInternal:this.context.manifest.isInternal,webPartId:this.context.manifest.id,instanceId:this.instanceId})},i.prototype._clearAsyncRenderGuardTimer=function(){this._asyncRenderGuardTimer&&(window.clearTimeout(this._asyncRenderGuardTimer),this._asyncRenderGuardTimer=void 0)},i.prototype._resolveOrRejectOnRenderPromise=function(e,t){this._renderedOnce=!0,p._PerformanceLogger.devMark("webpart(".concat(this.context.webPartTag,").complete")),e?this._renderPromiseRejecter&&this._renderPromiseRejecter(e):this._renderPromiseResolver&&this._renderPromiseResolver((0,m.Ye)()||t?p._PerformanceLogger.now():this._syncRenderTime),this._clearRenderPromises()},i.prototype._clearRenderPromises=function(){this._renderPromiseResolver=void 0,this._renderPromiseRejecter=void 0,this.domElement.style.minHeight=null},i.prototype._internalHandleThemeChangedEvent=function(e){this._internalThemeVariant=e.theme,this.onThemeChanged(this._internalThemeVariant),this.onThemeChanged!==i.prototype.onThemeChanged&&this.render()},i}(G);var J=v(272),X=v(37),Z=v(171);const $=function(){function e(){this._logSource=y._LogSource.create("PropertyPaneLoader")}return Object.defineProperty(e.prototype,"propertyPane",{get:function(){var t=this;if(this._propertyPaneController)return Promise.resolve(this._propertyPaneController);var n=new y._QosMonitor("PropertyPaneLoader.loadPropertyPaneModule");return X.SPComponentLoader.loadComponentById(e._propertyPaneModuleId).then(function(e){return t._propertyPaneController||(t._propertyPaneController=new e._ConfigurableOptionsController),Promise.resolve(t._propertyPaneController)}).catch(function(e){return y._TraceLogger.logErrorData({source:t._logSource,error:e}),n.writeUnexpectedFailure("UnhandledError",e),Promise.reject(e)})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this._propertyPaneController},enumerable:!1,configurable:!0}),e.serviceKey=n.ServiceKey.create("sp-webpart-base:PropertyPaneLoader",e),e._propertyPaneModuleId="f9e737b7-f0df-4597-ba8c-3060f82380db",e}();function ee(e,t){n.Validate.isNotNullOrUndefined(e,"method");try{e()}catch(e){t&&y._TraceLogger.logError(t,new Error("Error: "+e))}}const te=function(){function e(e){this._props=e}return e.prototype.render=function(){var e=document.createElement("div");e.className=Q,e.setAttribute("role","alert"),e.setAttribute("aria-live","assertive");var t=document.createElement("span");return t.className="b_a_7caff1a1",t.innerText=this._props.errorMessage,e.appendChild(t),e},e}(),ne=function(){function e(e){this._toggleExpandedDetails=this._toggleExpandedDetails.bind(this),this._errorMessage=new te(e).render(),this._errorMessage.style.display="none"}return e.prototype.render=function(){var e=document.createElement("div");e.className=Q;var t=document.createElement("div"),n=document.createElement("h2");n.className="e_a_7caff1a1",n.innerText=R.Um,t.appendChild(n),e.appendChild(n);var a=document.createElement("span");a.className="f_a_7caff1a1",a.innerText=R.Oi,e.appendChild(a);var i=document.createElement("div"),r=document.createElement("button");return r.className="c_a_7caff1a1",r.innerText=R.ge,r.onclick=this._toggleExpandedDetails,i.appendChild(r),e.appendChild(i),e.appendChild(this._errorMessage),e},e.prototype._toggleExpandedDetails=function(){"none"===this._errorMessage.style.display?this._errorMessage.style.display="":this._errorMessage.style.display="none"},e}();q.loadStyles('@keyframes l_b_7caff1a1{0%{transform:rotate(-45deg)}to{transform:rotate(315deg)}}.h_b_7caff1a1{padding:164px 0;position:relative;width:100%}.i_b_7caff1a1{height:20px;margin:auto;position:relative;width:20px}.j_b_7caff1a1,.k_b_7caff1a1{position:absolute}.j_b_7caff1a1{color:"[theme:themeLight, default: #c7e0f4]";z-index:0}.k_b_7caff1a1{animation:l_b_7caff1a1 1.5s infinite;animation-timing-function:easeInOutCirc;z-index:10}.k_b_7caff1a1,.m_b_7caff1a1{color:"[theme:themePrimary, default: #0078d4]"}.m_b_7caff1a1{margin-top:10px;text-align:center}.n_b_7caff1a1{border-width:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}',!0);const ae=function(){function e(){}return e.createSpinner=function(e){var t=document.createElement("div");t.className="h_b_7caff1a1";var n=document.createElement("div");n.className="i_b_7caff1a1",n.innerHTML="<svg class=".concat("k_b_7caff1a1",' xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 21">\n      <defs>\n        <style>\n          .slice {\n            fill: none;\n            stroke: currentColor;\n            stroke-miterlimit:10;\n            stroke-width:2px;\n          }\n        </style>\n      </defs>\n      <path class="slice" d="M17.5,6.5a10,10,0,0,1,10,10" transform="translate(-7 -6)"/>\n    </svg>\n    <svg class=').concat("j_b_7caff1a1",' xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 21">\n      <defs>\n        <style>\n          .ring {\n            fill: none;\n            stroke: currentColor;\n            stroke-miterlimit:10;\n            stroke-width:2px;\n          }\n        </style>\n      </defs>\n      <path class="ring" d="M10,0A10,10,0,1,1,0,10,10,10,0,0,1,10,0Z" transform="translate(0.5 0.5)"/>\n  </svg>'),t.appendChild(n);var a=document.createElement("div");a.className="m_b_7caff1a1",a.innerText=e,t.appendChild(a);var i=document.createElement("div");i.setAttribute("role","status"),i.setAttribute("aria-live","polite");var r=document.createElement("div");return r.className="n_b_7caff1a1",r.innerText=e,i.appendChild(r),t.appendChild(i),t},e}(),ie=function(){function e(){this._errorId="cswp-error",this._activeIndicatorCache=new Map}return e._getAdditionalTimeOut=function(e){var t=p._PerformanceLogger.readComponentBreakdown(e,"loadingDelayed"),n=p._PerformanceLogger.readComponentBreakdown(e,"inViewPortLoading");return t&&n?n-t:t?500:0},e.prototype.displayLoadingIndicator=function(e,t,n,a){this._logEngagement(e,"displayLoadingIndicator"),this._createLoadingIndicator(e,t,n,void 0,void 0,void 0,a)},e.prototype._displayLoadingIndicator=function(e,t,n,a,i,r,o){this._createLoadingIndicator(e,t,a,r,n,i,o)},e.prototype.clearLoadingIndicator=function(e){if(n.Validate.isNotNullOrUndefined(e,"domElement"),this._activeIndicatorCache.has(e)){var t=this._getCacheEntry(e);t.loadingTimer&&window.clearTimeout(t.loadingTimer),t.placeholder&&t.placeholder.parentElement&&t.placeholder.parentElement.removeChild(t.placeholder),this._activeIndicatorCache.delete(e)}},e.prototype.renderError=function(e,t,n){"function"==typeof n&&(n={clearDomElementCallback:n}),this._renderError(e,t,n)},e.prototype.clearError=function(e){if(n.Validate.isNotNullOrUndefined(e,"domElement"),this._activeIndicatorCache.has(e)){var t=this._activeIndicatorCache.get(e);if(t&&t.isErrorBeingRendered){t.isErrorBeingRendered=!1;var a=e.querySelector("div[data-sp-id='".concat(this._errorId,"']"));a&&(a.style.display="none",a.removeAttribute("data-automation-id"))}}},e.prototype._createLoadingIndicator=function(t,a,i,r,o,s,c){var d=this;n.Validate.isNotNullOrUndefined(t,"domElement"),(!r||r&&isNaN(r))&&(r=1500);var l=this._getCacheEntry(t);l.loadingTimer&&window.clearTimeout(l.loadingTimer),l.loadingTimer=window.setTimeout(function(){if(o&&s){var n=e._getAdditionalTimeOut(o);l.loadingTimer=window.setTimeout(function(){d._showLoadingIndicator(t,a,i,o,s,c)},n)}else d._showLoadingIndicator(t,a,i,o,s,c)},r)},e.prototype._renderError=function(e,t,a){var i=a||{},r=i.message,o=i.clearDomElementCallback;n.Validate.isNotNullOrUndefined(e,"domElement"),n.Validate.isNotNullOrUndefined(t,"error"),this._logEngagement(e,"renderError");var s,c="",d="\r\n",l=r?"\r\n\r\n"+r:"";if(t instanceof n.SPError)c=t.toStringForUI(),(0,m.vW)()||(c+=l);else{var u=t,f=u.stack,p=f?n.Text.format(R.KO,d,f):"";c=(0,m.vW)()?n.Text.format(R.Ec,d,"".concat(u.message||t),p,""):n.Text.format(R.Ec,d,"".concat(u.message||t),p,l)}this._getCacheEntry(e).isErrorBeingRendered=!0,s=new ne({errorMessage:c}).render();var _=e.querySelector("div[data-sp-id='".concat(this._errorId,"']"));_?_.style.display="block":((_=document.createElement("div")).setAttribute("data-sp-id",this._errorId),o&&o(e),this._clearChildren(e),e.appendChild(_),K.disableAutomaticPostbacks(e,n.Environment.type)),_.setAttribute("data-automation-id","webPartError"),_.innerHTML="",_.appendChild(s)},e.prototype._showLoadingIndicator=function(e,t,n,a,i,r){a&&i&&p._PerformanceLogger.markComponent(a,"displaySpinner"),this._renderLoadingIndicator(e,t,n,a,r)},e.prototype._renderLoadingIndicator=function(e,t,n,a,i){if(this._activeIndicatorCache.has(e)){var r=this._getCacheEntry(e);r.isErrorBeingRendered||(r.placeholder=this._createLoadingIndicatorElement(e,t,n,a,i))}},e.prototype._getCacheEntry=function(e){if(this._activeIndicatorCache.has(e))return this._activeIndicatorCache.get(e);var t={loadingTimer:void 0,placeholder:void 0,isErrorBeingRendered:!1};return this._activeIndicatorCache.set(e,t),t},e.prototype._createLoadingIndicatorElement=function(e,a,i,r,o){o&&o(e),this._clearChildren(e);var s=n.Text.format(R.Q,a),c=r?t._ShimmerFactory.createShimmer(e.clientWidth,i,r,s):this._createSpinnerElement(s,i);return c.style.display="block",e.appendChild(c)},e.prototype._createSpinnerElement=function(e,t){var n=ae.createSpinner(e);if(void 0!==t){var a=document.createElement("div");a.style.maxHeight="".concat(t,"px"),a.appendChild(n),n=a}return n},e.prototype._clearChildren=function(e){for(;e.hasChildNodes();)e.lastChild&&e.removeChild(e.lastChild)},e.prototype._logEngagement=function(e,t){var n=!1,a=e.getAttribute("data-sp-web-part-id")||"";a&&(n=!0),p._EngagementLogger.log({name:"ClientSideWebPartStatusRenderer.".concat(t),isIntentional:!0,extraData:{spWebPartId:a,isWebPartRoot:n}})},e}();var re,oe,se;!function(e){e[e.Standard=0]="Standard",e[e.FullSize=1]="FullSize",e[e.FullWidth=2]="FullWidth"}(re||(re={})),function(e){e[e.Unknown=0]="Unknown",e[e.WebPart=1]="WebPart",e[e.Application=2]="Application",e[e.Library=3]="Library",e[e.Extension=4]="Extension",e[e.ProviderHostedApp=5]="ProviderHostedApp",e[e.Assembly=6]="Assembly",e[e.AdaptiveCardExtension=7]="AdaptiveCardExtension"}(oe||(oe={})),function(e){e[e.TeamsTab=0]="TeamsTab",e[e.SharePointFullPage=1]="SharePointFullPage",e[e.SharePointWebPart=2]="SharePointWebPart",e[e.Dashboard=3]="Dashboard"}(se||(se={}));var ce=function(){function t(){}return Object.defineProperty(t,"isInTreatmentForWebPartFlickerPerfExp",{get:function(){return 0!==p._SPPerfExperiment.getVariantAndTrackExperiment(p._PerformanceExperiment.WEXWebPartFlickerPerfExp)},enumerable:!1,configurable:!0}),t.endAndStartNewMonitor=function(n,a,i){t._endMonitor(n,"InterruptedByNextChange");var r=new y._QosMonitor("WebPartExternalUpdatePerf_MutationObserver");r.extraData=(0,e.__assign)({isInTreatment:t.isInTreatmentForWebPartFlickerPerfExp},a);var o=function(){var e=Date.now();return window.setTimeout(function(){t._endMonitor(n,"DOMIdled",{endTime:e})},5e3)},s=i,c=o(),d=new MutationObserver(function(){clearTimeout(c),c=o()});d.observe(s,{attributes:!0,subtree:!0,childList:!0}),t._webPartMap.set(n,{timeoutId:c,observer:d,monitor:r})},t.endWithRenderCompleteTime=function(e,n){t._endMonitor(e,"RenderCompleteCalled",{renderCompleteTimeStamp:n})},t._endMonitor=function(n,a,i){var r=t._webPartMap.get(n);if(r){var o=r.timeoutId,s=r.observer,c=r.monitor;clearTimeout(o),s.disconnect(),c.writeSuccess((0,e.__assign)({endType:a},i)),t._webPartMap.delete(n)}},t._webPartMap=new Map,t}(),de="Property pane will open",le="Content panel toggled",ue="Property pane toggled";const fe=JSON.parse('{"I":"Card no longer available: {0}"}');var pe="3ed4834b-756c-4c82-add3-a3acae4bf6cd";function me(t,a){return{manifest:X._ManifestStore.instance.tryGetManifest(pe),webPartData:(0,e.__assign)((0,e.__assign)({},t),{id:pe,iconProperty:"Error",properties:{errorMessage:a||n.Text.format(fe.I,(null==t?void 0:t.title)||""),originalACEData:t}})}}var _e=/(\/_layouts\/15\/getpreview.ashx\/?(|(\?(.*?)))$)/i,he="e6b93447-8007-4f1e-934f-754a0031a769",be="d1d91016-032f-456d-98a4-721247c305e8",ge="fe2f2812-4df0-42c7-ae2e-2db57e092751";const ve=function(){function a(e){this._webParts=new Map,this._statusRenderer=new ie,this._iframedWebpartInstanceIds=new Set,this._propertyPaneConsumerQueue=new Map,this._displayMode=n.DisplayMode.Read,n.Validate.isNotNullOrUndefined(e,"host"),this._host=e,this._pageContext=e.serviceScope.consume(Z.PageContext.serviceKey),this._onContainerResize=this._onContainerResize.bind(this),this._onPropertyPaneNotifications=this._onPropertyPaneNotifications.bind(this),this.requestPropertyPaneAction=this.requestPropertyPaneAction.bind(this),this.isPropertyPaneRenderedByWebPart=this.isPropertyPaneRenderedByWebPart.bind(this),this.isPropertyPaneOpen=this.isPropertyPaneOpen.bind(this),0===a._webPartManagerList.length&&this._initialzeOnResizeEventHandler(),a._webPartManagerList.push(this)}return a.createWebPartTag=function(e,t){return"WebPart.".concat(e.alias,".").concat(e.isInternal?"internal":"external",".").concat(t)},a._instanceOfBase=function(e){if(e){if(e instanceof Y)return!0;var t=e.__type;return"BaseClientSideWebPart"===t||"BaseMRClientSideWebPart"===t}return!1},a._getWebPartTag=function(e){var t;if(a._instanceOfBase(e)?e.context||(t="WebpartTag requested for instance that is missing context"):t="WebpartTag requested for non-webpart",!t)return e.context.webPartTag;y._TraceLogger.logError(a._logSource,new Error(t))},a._isLoadingIsolatedWebPart=function(e,t){var i=e.manifest,r=e.pageLayoutType;if((0,j.Od)()&&i.isInternal&&"DomainIsolation"===i.isolationLevel){var s=t.match(a._1PIsolatedDomainRegex);if(s)i.isolatedDomain=new URL(t.replace(a._1PIsolatedDomainRegex,"".concat(s[0],"-app3bc2296eaa224ed29e1e946d05afa6a2"))).hostname;else if("Isolated"!==r)throw new Error("Cannot create isolated domain for: ".concat(t))}return n._SPFlight.isEnabled(1147)&&"Isolated"!==r&&(i.isolationLevel===o.DomIsolation||!!i.isolatedDomain)},a._getWebPartTitle=function(e,t){var n=t&&t.title;return n||(n=e.title&&e.title.default),n||e.preconfiguredEntries[0].title.default},a._loadDynamicComponentDependencies=function(e,t,a){for(var i=t.serverProcessedContent&&t.serverProcessedContent.componentDependencies||{},r=0,o=Object.keys(i);r<o.length;r++){var s=o[r],c=i[s];if(!n.Guid.isValid(c))throw new Error("Failed to load web part's (".concat(a,") dynamic dependency ").concat(s," with component id {").concat(c,"}"));e.push(X.SPComponentLoader.loadComponentById(c))}},Object.defineProperty(a,"isMaintenanceMode",{get:function(){return"true"===new n.UrlQueryParameterCollection(window.location.href).getValue("maintenanceMode")},enumerable:!1,configurable:!0}),a.prototype.loadWebPart=function(i){var r,o=this;try{var s=i,c="f3bc67ee-015d-4678-a95f-c7e90ea62c1e"===s.manifest.id,d=s.manifest.id===he,l="AdaptiveCardExtension"===s.manifest.componentType||(null===(r=s.manifest.experimentalData)||void 0===r?void 0:r.ACE)||c||d,u=a._isLoadingIsolatedWebPart(s,this._pageContext.site.absoluteUrl);if(u&&!l)return this._loadIsolatedWebPart(s);var f=Promise.resolve();return l&&s.manifest.isPendingTeamsAppSync&&(f=this._waitForTeamsAppSync(s)),f.then(function(){return o._doesUserHasPermissions(s.manifest).then(function(i){var r,f,p,_;if(!i){var h=n.Text.format(R.i9,(null===(r=s.webPartData)||void 0===r?void 0:r.title)||s.manifest.alias);if(s.displayMode===n.DisplayMode.Edit){if((0,m.t_)())throw new Error(h);var b=me(s.webPartData,h),g=b.manifest,v=b.webPartData;s.manifest=g,s.webPartData=v}else null===(p=(f=o._host).onAfterWebPartVisibilityChanged)||void 0===p||p.call(f,s.instanceId,!1)}l&&(!(0,m.$e)()&&(0,m.UK)()&&s.displayMode===n.DisplayMode.Edit||!c&&!u?s.manifest=X._ManifestStore.instance.tryGetManifest("f3bc67ee-015d-4678-a95f-c7e90ea62c1e"):(0,j.f4)()&&!d&&u&&(s.manifest=X._ManifestStore.instance.tryGetManifest(he)),s.webPartData&&(s.webPartData=(0,e.__assign)((0,e.__assign)({},s.webPartData),null===(_=s.webPartData.properties)||void 0===_?void 0:_.aceData)),s.displayMode===n.DisplayMode.Edit&&!(0,m.UK)()&&u&&s.manifest.id===he&&o._loadIsolatedWebPart(s,!0)),s.webPartTag=a.createWebPartTag(s.manifest,s.instanceId),s.domElement&&s.domElement.setAttribute&&s.domElement.setAttribute("data-sp-web-part-id",s.manifest.id);var S,D=new y._QosMonitor("WebPart.Load",!0);return new Promise(function(e){o._host.onBeforeWebPartLoad(s),e(o._loadComponentModules(s))}).then(function(e){return o._host.onAfterWebPartLoad(s),e}).catch(function(e){throw S={error:e,stage:"Load"}}).then(function(e){return o._host.onBeforeWebPartInitialize(s).then(function(){return o._initializeWebPart(e,s)})}).then(function(e){return o._validateIfWPIsNotDisposed(e),o._host.onAfterWebPartInitialize(s),e}).catch(function(e){if("isDisposed"in e)throw e.stage="Initialize",e;throw S||(S={error:e,stage:"Initialize"}),S}).then(function(e){return o._validateIfWPIsNotDisposed(e),o._host.onBeforeWebPartRender(s),q.flush(),e}).then(function(e){return o._validateIfWPIsNotDisposed(e),o._loadPropertyPaneModule(e)}).then(function(e){return o._validateIfWPIsNotDisposed(e),o._renderWebPart(e)}).then(function(e){var t=e.webPart,n=e.renderCompleteTime;return s.renderCompleteTime=n,!(0,m.UK)()&&u&&s.manifest.id===he&&o._iframedWebPartController&&o._iframedWebPartController.assignIsolatedACEWP(s.instanceId,t),o._host.onAfterWebPartRender(s),!(0,m.Lt)()&&n&&ce.endWithRenderCompleteTime(s.instanceId,n),K.removeFabricLinks(),o._loadLegacyFabricCssIfRequired(s)}).catch(function(e){if("isDisposed"in e)throw e.stage="Render",e;throw S||(S={error:e,stage:"Render"}),S}).then(function(){var e=t._WebPartLoadDataCollector.collect(s.manifest,s.webPartTag,o._pageContext);D.writeSuccess(e)}).catch(function(e){var a=t._WebPartLoadDataCollector.collect(s.manifest,s.webPartTag,o._pageContext);if((0,m.ZP)()||e.error instanceof Error||(a.errorData=e.error),!("isDisposed"in e)){D.writeUnexpectedFailure(e.stage,e.error,a);var i=e.error;switch(e.stage){case"Load":o._host.onAfterWebPartLoadFailed(s,i);break;case"Initialize":o._host.onAfterWebPartInitializeFailed(s,i);break;case"Render":o._host.onAfterWebPartRenderFailed(s,i)}var r=s.instanceId,c=o._webParts.get(r);c&&(c.dispose(),o._webParts.delete(r));var d="";if((null==c?void 0:c.modifiedByGraph)&&!(0,m.vW)()&&(0,j.qj)()){var l=new Date(1e3*(null==c?void 0:c.modifiedByGraph.lastModified));d=n.Text.format(R._U,null==c?void 0:c.modifiedByGraph.apiVersion,l.toLocaleDateString(),l.toLocaleTimeString())}throw o._statusRenderer.renderError(s.domElement,i,{message:d}),e.error}D.writeExpectedFailure(e.stage,e.error,a),o._statusRenderer.clearLoadingIndicator(s.domElement)})})})}catch(e){return Promise.reject(e)}},a.prototype.setPropertyPaneConsumer=function(e,t){n.Validate.isNonemptyString(e,"id"),n.Validate.isNotNullOrUndefined(t,"control"),this._webParts.set(e,t),this._registerWebPartAsPropertyPaneConsumer(e)},a.prototype.fetchWebPartManifests=function(){var e=this,t=!(0,j.rT)();if(t&&(this._toolboxACEManifestsPromise=this._fetchAdaptiveCardExtensionManifests()),this._toolboxManifestsPromise||this._pageContext.web&&this._pageContext.web.serverRelativeUrl&&n.Environment.type!==n.EnvironmentType.Local&&n.Environment.type!==n.EnvironmentType.Test||(this._toolboxManifestsPromise=Promise.resolve()),!this._toolboxManifestsPromise){var i,r,o,s=new y._QosMonitor("ClientSideWebPartManager.FetchWebParts");o=(0,j.rT)()?"_api/web/GetClientSideComponentsByComponentType(componentTypesString='".concat(oe.WebPart,",").concat(oe.AdaptiveCardExtension,"', includeManifestActivatedTime=true)"):"_api/web/GetClientSideComponentsByComponentType(componentTypesString='".concat(oe.WebPart,"',supportedHostTypeValue=").concat(se.SharePointWebPart,")");var c="".concat(n.UrlUtilities.removeEndSlash(this._pageContext.web.serverRelativeUrl),"/").concat(o);this._host.serviceScope.whenFinished(function(){var t=e._host.serviceScope.consume(J.SPHttpClient.serviceKey);e._toolboxManifestsPromise=e._fetchManifestsWithCache(t,c).then(function(e){if(i=e.correlationId?e.correlationId.toString():void 0,r="true"===e.headers.get("X-From-Service-Worker"),e.ok)return e.jsonCached||(e.jsonCached=Promise.resolve(e.json()));throw N.create(H.ManifestDownloadFailed)}).then(function(t){var a=t.value.map(function(e){var t=JSON.parse(e.Manifest);return e.ManifestActivatedTime&&(t.manifestActivatedTime=e.ManifestActivatedTime),t});e._disambiguateWebPartManifestLocales(a),(0,m.u7)()||e._isDebugSession||n._BrowserUtilities.isWorkbenchHosted()?X.SPComponentLoader.registerManifests(a):X.SPComponentLoader.refreshWebPartManifests(a),s.writeSuccess()}).catch(function(t){throw e._toolboxManifestsPromise=void 0,e._clearManifestCacheItem(c),y._TraceLogger.logErrorData({source:a._logSource,error:t,serviceScope:e._host.serviceScope}),s.writeUnexpectedFailure("Rejected",t,{correlationId:i,fromServiceWorker:r}),t})})}var d=this._fetchTeamsACEManifests();return t?Promise.all([this._toolboxACEManifestsPromise,this._toolboxManifestsPromise,d]).then(function(){}):(0,m.PF)()?this._toolboxManifestsPromise:Promise.all([this._toolboxManifestsPromise,d]).then(function(){})},a.prototype.getWebPartManifests=function(e){var t;void 0===e&&(e=!1);for(var n=[],a=0,i=X.SPComponentLoader._getManifestReferences();a<i.length;a++){var r=i[a],o=null===(t=r.experimentalData)||void 0===t?void 0:t.ACE;"WebPart"!==r.componentType||o?e&&("AdaptiveCardExtension"===r.componentType||o)&&n.push(r):n.push(r)}return n},a.prototype.getAdaptiveCardExtensionManifests=function(){var e,t,n=X.SPComponentLoader._getManifestReferences(),a=[];(0,j.Ro)()&&this._toolboxTeamsAppComponentsManifests&&a.push.apply(a,Array.from(this._toolboxTeamsAppComponentsManifests.values()));for(var i=0,r=n;i<r.length;i++){var o=r[i];"AdaptiveCardExtension"!==o.componentType&&!(null===(e=o.experimentalData)||void 0===e?void 0:e.ACE)||(null===(t=this._toolboxTeamsAppComponentsManifests)||void 0===t?void 0:t.has(o.id))||this._toolboxTeamsAppComponentsManifests&&o.connectedTeamsAppId||a.push(o)}return a},a.prototype.setDisplayMode=function(e,t){this._setDisplayMode(e,t).catch(function(e){return y._TraceLogger.logVerboseData({source:a._logSource,message:e.message})})},a.prototype._setDisplayMode=function(e,t){var a=this;this._displayMode=e,this._displayMode===n.DisplayMode.Read&&this._closeIsolatedPropertyPaneIfRequired();var i=this._loadPropertyPaneModuleOld();return this._executeForIdsOrAll(this._getArrayOrUndefined(t),function(t,n){if(n)n._internalSetDisplayMode(e);else if(a._iframedWebpartInstanceIds.has(t)){var i=new y._QosMonitor("ClientSideWebPartManager._setDisplayMode");a._iframedWebPartController?(i.writeSuccess(),a._iframedWebPartController.setDisplayMode(e,t)):i.writeUnexpectedFailure("iFrame controller used before deferral loading is complete")}}),this._startDirtyBitTimer(e),i},a.prototype.serialize=function(e){var t=this,a=new Map;return this._executeForIdsOrAll(this._getArrayOrUndefined(e),function(e,i){i?a.set(e,i._internalSerialize()):t._iframedWebpartInstanceIds.has(e)&&(n.Validate.isNotNullOrUndefined(t._iframedWebPartController,"IFramedWebPartController is undefined"),a.set(e,t._iframedWebPartController.serialize(e)))}),a},a.prototype.setWebPartData=function(e,t,a){void 0===a&&(a=!1),n.Validate.isNotNullOrUndefined(e,"web part manager context"),n.Validate.isNonemptyString(t,"web part instance id");var i=this._webParts.get(t),r=e.webPartData;if(n.Validate.isNotNullOrUndefined(r,"web part data"),i&&r){if(!(0,m.Lt)()){var o=new y._QosMonitor("WebPartExternalUpdatePerf_SetTimeout");requestAnimationFrame(function(){setTimeout(function(){o.writeSuccess({manifestId:e.manifest.id,shouldFallback:a,isInTreatment:ce.isInTreatmentForWebPartFlickerPerfExp})},0)}),ce.endAndStartNewMonitor(t,{manifestId:e.manifest.id,shouldFallback:!!e.manifest.useFallbackWhenPropertiesUpdatedExternally},e.domElement)}if(a)return this.disposeWebparts(t),this.loadWebPart(e);i._internalSetWebPartData(r),n._SPEventManager.instance.raiseEvent(this._getDataUpdatedEventName(r.instanceId),{})}return Promise.resolve()},a.prototype.dispose=function(){this.disposeWebparts();var e=a._webPartManagerList.indexOf(this);e>=0&&a._webPartManagerList.splice(e,1)},a.prototype.disposeWebparts=function(e){var t=this;this._executeForIdsOrAll(this._getArrayOrUndefined(e),function(e,i){i?(t._deleteWebPart(e),ee(function(){i._internalDispose()},a._logSource)):t._iframedWebpartInstanceIds.has(e)&&(n.Validate.isNotNullOrUndefined(t._iframedWebPartController,"IFramedWebPartController is undefined"),t._iframedWebPartController.deleteWebPart(e))})},a.prototype.tryGeneratePreviewImageUrl=function(e){var t,n=this,i=void 0,r=void 0,o=new y._QosMonitor("ClientSideWebPartManager.tryGeneratePreviewImageUrl");this._executeForIdsOrAll(e,function(e,s){if(s){if(!i){var c=s.previewImageUrl;if(c)if(r=s.context.manifest.alias,c.length<255){var d=(t=c).toUpperCase();(_e.test(d)||d.indexOf("/_API/")>=0)&&(i=t)}else{var l=s.previewImageUrl;y._TraceLogger.logVerboseData({source:a._logSource,eventName:"tryGeneratePreviewImageUrl",message:"".concat(r," attempted preview URL of ").concat(l&&l.length," chars.")})}}}else if(n._iframedWebpartInstanceIds.has(e))return void o.writeExpectedFailure("IframedPart")});var s=o&&r?{alias:r}:void 0;if(!i&&t&&(i=t,o.writeExpectedFailure("NonLayouts",void 0,s)),!i&&r)throw o.writeUnexpectedFailure("PathTooLong",void 0,s),new Error("tryGeneratePreviewImageUrl PathLengthError.");return o.hasEnded||o.writeSuccess(s),i},a.prototype.getWebpartTopActions=function(e){var t=this._webParts.get(e);return null==t?void 0:t.getTopActionsConfiguration()},a.prototype.requestPropertyPaneAction=function(e,t,n,i){var r,o=this;if(void 0===t&&(t="Default"),this._iframedWebpartInstanceIds.has(e))(null===(r=this._propertyPane)||void 0===r?void 0:r.isOpen((0,j.a1)()?e:void 0))&&this._propertyPane.requestAction(e,"Close",n),this._iframedWebPartController.requestPropertyPaneAction(t,e);else{var s=!1;this._host.requestPropertyPaneAction&&(s=this._host.requestPropertyPaneAction(e,t,n,i)),s||(this._iframedWebPartController&&this._iframedWebPartController.requestPropertyPaneAction("Close"),this._propertyPane?this._propertyPane.requestAction(e,t,n,(0,m.dm)()?void 0:i):"OpenDetails"===t&&this._loadPropertyPaneModuleOld(!0).then(function(){return o._propertyPane.requestAction(e,t,n,i)}).catch(function(e){return y._TraceLogger.logVerboseData({source:a._logSource,message:e.message})}))}},a.prototype.isPropertyPaneRenderedByWebPart=function(){return!!this._propertyPane&&this._propertyPane.isRenderedByConsumer()},a.prototype.isPropertyPaneOpen=function(e){return!!this._propertyPane&&this._propertyPane.isOpen(e)},a.prototype.isContentPanelOpen=function(){var e,t;return!!(null===(t=null===(e=this._propertyPane)||void 0===e?void 0:e.isContentPanelOpen)||void 0===t?void 0:t.call(e))},a.prototype.onWebPartDelete=function(e){this.disposeWebparts(e)},a.prototype.renderError=function(e,t){var n=this;ee(function(){n._statusRenderer.renderError(e,t),y._TraceLogger.logErrorData({source:a._logSource,error:t,serviceScope:n._host.serviceScope})},a._logSource)},a.prototype.notifyWebPartContainerResize=function(e){var t=this;this._executeForIdsOrAll(this._getArrayOrUndefined(e),function(e,a){a?a._internalOnAfterResize():t._iframedWebpartInstanceIds.has(e)&&(n.Validate.isNotNullOrUndefined(t._iframedWebPartController,"IFramedWebPartController is undefined"),t._iframedWebPartController.notifyContainerResize(e))})},a.prototype.notifyWebPartsSetDirtyBit=function(){(0,m.jM)()||this._notifyWebPartsSetDirtyBit()},a.prototype.clearManifestPromise=function(){this._toolboxManifestsPromise=void 0},a.prototype._getWebPartContext=function(e){var t=a.createWebPartTag(e.manifest,e.instanceId),i=this._host.getAdditionalContextProperties&&this._host.getAdditionalContextProperties()||{},o=i.microsoftTeams&&i.microsoftTeams.teamsJs,s=Promise.resolve({});s=this._host.getAdditionalContextPropertiesAsync&&this._host.getAdditionalContextPropertiesAsync()||Promise.resolve({});var c={sdks:i,microsoftTeams:o,parentServiceScope:e.serviceScope||this._host.serviceScope,manifest:this._getManifestInstance(e),instanceId:e.instanceId,webPartTag:t,domElement:e.domElement,statusRenderer:this._statusRenderer,isPropertyPaneRenderedByWebPart:this.isPropertyPaneRenderedByWebPart,isPropertyPaneOpen:this.isPropertyPaneOpen,isContentPanelOpen:this.isContentPanelOpen,formFactor:e.formFactor||re.Standard,host:this._host,requestPropertyPaneAction:this.requestPropertyPaneAction,loggingTag:t,_dataUpdatedEvent:new n.SPEvent(this._getDataUpdatedEventName(e.instanceId)),widthCacheKey:e.widthCacheKey,pageLayoutType:e.pageLayoutType,sdksAsync:s,getPositionOnPage:e.getPositionOnPage};return new r(c)},a.prototype._initializeWebPart=function(e,t){var n=e;n.default&&"function"!=typeof(n=n.default)&&n.default&&(n=n.default);var a=new n;a._internalInitialize(this._getWebPartContext(t),!!t.addedFromPersistedData,t.displayMode);var i=a.instanceId;if(this._webParts.set(i,a),this._registerWebPartAsPropertyPaneConsumer(i),this._startDirtyBitTimer(t.displayMode),(0,m.GV)()){var r=D.cloneDeep(t.webPartData);r&&a._internalDeserialize(r)}else t.webPartData&&a._internalDeserialize(t.webPartData);return a},a.prototype._fetchManifestsWithCache=function(t,i){return a._manifestRequestPromiseCache[i]||(a._manifestRequestPromiseCache[i]=t.post(i,J.SPHttpClient.configurations.v1,(0,e.__assign)({body:JSON.stringify({project:n.Session.clientSideApplicationId})},!(0,m.zx)()&&{headers:{"x-odsp-web-version":X._ManifestStore.instance.buildNumber}}))),a._manifestRequestPromiseCache[i]},a.prototype._fetchAdaptiveCardExtensionManifests=function(){var e=this;this._toolboxACEManifestsPromise||this._pageContext.web&&this._pageContext.web.serverRelativeUrl&&n.Environment.type!==n.EnvironmentType.Local&&n.Environment.type!==n.EnvironmentType.Test||(this._toolboxACEManifestsPromise=Promise.resolve());var t="_api/web/GetClientSideComponentsByComponentType(componentTypesString='".concat(oe.AdaptiveCardExtension,"',supportedHostTypeValue=").concat(se.Dashboard,", includeManifestActivatedTime=true)");if(!this._toolboxACEManifestsPromise){var i="".concat(n.UrlUtilities.removeEndSlash(this._pageContext.web.serverRelativeUrl),"/").concat(t);this._host.serviceScope.whenFinished(function(){var t=e._host.serviceScope.consume(J.SPHttpClient.serviceKey);e._toolboxACEManifestsPromise=e._fetchManifestsWithCache(t,i).then(function(e){if(e.ok)return e.jsonCached||(e.jsonCached=Promise.resolve(e.json()));throw N.create(H.ManifestDownloadFailed)}).then(function(t){var n=t.value.map(function(e){var t=JSON.parse(e.Manifest);return e.ManifestActivatedTime&&(t.manifestActivatedTime=e.ManifestActivatedTime),t});e._disambiguateWebPartManifestLocales(n),X.SPComponentLoader.registerManifests(n)}).catch(function(t){throw e._toolboxACEManifestsPromise=void 0,e._clearManifestCacheItem(i),y._TraceLogger.logErrorData({source:a._logSource,error:t,serviceScope:e._host.serviceScope}),t})})}return this._toolboxACEManifestsPromise},a.prototype._fetchTeamsACEManifests=function(){var e=this;return this._toolboxTeamsACEManifestsPromise||(0,j.Ro)()&&this._pageContext.web&&this._pageContext.web.serverRelativeUrl&&n.Environment.type!==n.EnvironmentType.Local&&n.Environment.type!==n.EnvironmentType.Test||(this._toolboxTeamsACEManifestsPromise=Promise.resolve(),this._toolboxTeamsAppComponentsManifests=void 0),this._toolboxTeamsACEManifestsPromise||(this._toolboxTeamsACEManifestsPromise=this._teamsAppsClient.then(function(e){return e?e.getTeamsAppComponentManifests():Promise.resolve([])}).then(function(t){e._toolboxTeamsAppComponentsManifests||(e._toolboxTeamsAppComponentsManifests=new Map),t.forEach(function(t){e._toolboxTeamsAppComponentsManifests.set(t.id,t)})}).catch(function(t){e._toolboxTeamsACEManifestsPromise=void 0,e._toolboxTeamsAppComponentsManifests=void 0,y._TraceLogger.logErrorData({source:a._logSource,error:t,serviceScope:e._host.serviceScope})})),this._toolboxACEManifestsPromise},a.prototype._clearManifestCacheItem=function(e){delete a._manifestRequestPromiseCache[e]},a.prototype._disambiguateWebPartManifestLocales=function(e){var t=this._pageContext.cultureInfo.currentUICultureName?this._pageContext.cultureInfo.currentUICultureName.toLowerCase():void 0;if(t){var n=function(e){var n=void 0;for(var a in e)if(a&&a.toLowerCase()===t&&e[a]){n=e[a];break}return{default:n||e.default}};e.forEach(function(e){"WebPart"===e.componentType&&e.preconfiguredEntries.forEach(function(e){e.title=n(e.title),e.description=n(e.description),e.group&&(e.group=n(e.group))})})}},a.prototype._loadIsolatedWebPart=function(e,n){var a=this;void 0===n&&(n=!1),this._iframedWebpartInstanceIds.add(e.instanceId);var i=(0,t._ensureIsolatedDomainUrl)(e.manifest.isolatedDomain,this._pageContext.web.absoluteUrl);return v.e(725).then(v.bind(v,295)).then(function(e){return e.default}).then(function(t){return a._iframedWebPartController||(a._iframedWebPartController=new t(a._host)),a._iframedWebPartController.loadWebPart(i,a._pageContext,e,n)})},a.prototype._waitForTeamsAppSync=function(e){var t=this,n=e.domElement,i=e.manifest,r=e.reservedHeight,o=e.webPartData,s=a._getWebPartTitle(i,o);return this._statusRenderer._displayLoadingIndicator(n,s,a.createWebPartTag(e.manifest,e.instanceId),r||180,i.isInternal),this._teamsAppsClient.then(function(e){if(!e)throw new Error("Invalid operation: TeamsAppsClient is undefined");return e.syncComponent(i)}).then(function(a){var i;t._statusRenderer.clearLoadingIndicator(n),null===(i=t._toolboxTeamsAppComponentsManifests)||void 0===i||i.set(a.id,a),X.SPComponentLoader.registerManifests([a]),D.assign(e.manifest,a),e.manifest.isPendingTeamsAppSync=!1}).catch(function(e){throw t._statusRenderer.clearLoadingIndicator(n),t._statusRenderer.renderError(n,e),e})},a.prototype._loadComponentModules=function(e){this._swapManifestForWebparts(e);var t=e.domElement,n=e.manifest,i=e.reservedHeight,r=e.webPartData,o=a._getWebPartTitle(n,r);this._statusRenderer._displayLoadingIndicator(t,o,e.webPartTag,i,n.isInternal);var s=[X.SPComponentLoader.loadComponent(n)];if(!s[0])throw N.create(H.ModuleUndefined,e.webPartTag);return r&&a._loadDynamicComponentDependencies(s,r,e.webPartTag),Promise.all(s).then(function(e){return e[0]})},a.prototype._executeForIdsOrAll=function(e,t){var n=this;e?e.forEach(function(e){var a=n._webParts.get(e);t(e,a)}):(this._webParts.forEach(function(e,n){a._instanceOfBase(e)&&t(n,e)}),this._iframedWebPartController&&this._iframedWebPartController.getAllInstanceIds().forEach(function(e){t(e)}))},a.prototype._startDirtyBitTimer=function(e){var t=this;e===n.DisplayMode.Read?this._dirtyBitTimer&&n.Environment.type!==n.EnvironmentType.ClassicSharePoint&&(window.clearInterval(this._dirtyBitTimer),this._dirtyBitTimer=void 0):this._dirtyBitTimer||(this._dirtyBitTimer=window.setInterval(function(){t._notifyWebPartsSetDirtyBit()},1e3))},a.prototype._notifyWebPartsSetDirtyBit=function(){var e=this;this._executeForIdsOrAll(void 0,function(t,n){n?n._internalSetDirtyBit():e._iframedWebpartInstanceIds.has(t)&&e._iframedWebPartController.startDirtyBitTimer(t)})},a.prototype._deleteWebPart=function(e){n.Validate.isNotNullOrUndefined(e,"id"),this._propertyPane&&this._propertyPane.onConsumerDelete(e);var t=this._webParts.get(e);t&&a._instanceOfBase(t)&&y._TraceLogger.logVerboseData({source:a._logSource,message:n.Text.format(R.qz,a._getWebPartTag(t)),serviceScope:this._host.serviceScope}),this._webParts.delete(e)},a.prototype._getManifestInstance=function(e){var t=e.manifest,n=D.cloneDeep(t);return delete n.preconfiguredEntries,n},a.prototype._getArrayOrUndefined=function(e){return e?[e]:void 0},a.prototype._initialzeOnResizeEventHandler=function(){window.addEventListener("resize",D.debounce(this._onContainerResize,1e3)),window.addEventListener("message",this._onPropertyPaneNotifications),window.addEventListener("resize",W.clear)},a.prototype._onContainerResize=function(){a._webPartManagerList.forEach(function(e){e._webParts.forEach(function(e){e._internalOnAfterResize()})})},a.prototype._onPropertyPaneNotifications=function(e){if(e&&e.origin===window.location.origin)switch(e.data){case"Content panel will open":case de:this._closeIsolatedPropertyPaneIfRequired();break;case le:case ue:W.clear(),this._onContainerResize()}},a.prototype._renderWebPart=function(e){return e._internalFirstTimeRender().then(function(t){return{webPart:e,renderCompleteTime:t}})},a.prototype._loadPropertyPaneModule=function(e){var t=this,i=Promise.resolve(e);if((e.displayMode===n.DisplayMode.Edit||n.Environment.type===n.EnvironmentType.ClassicSharePoint)&&!this._propertyPane){var r=new y._QosMonitor("ClientSideWebPartManager._loadPropertyPaneModule");i=this._host.serviceScope.consume($.serviceKey).propertyPane.then(function(n){return t._propertyPane=n,t._registerPendingPropertyPaneConsumers(),e}).catch(function(e){throw y._TraceLogger.logErrorData({source:a._logSource,error:e}),r.writeUnexpectedFailure("UnhandledError",e),e})}return i},a.prototype._getDataUpdatedEventName=function(e){return"WebPart_".concat(e,"_dataUpdated")},a.prototype._registerWebPartAsPropertyPaneConsumer=function(e){if(e)for(var t=void 0,n=0,i=a._webPartManagerList;n<i.length;n++)if(t=i[n]._webParts.get(e)){this._propertyPane?this._propertyPane.registerConsumer(e,t):this._propertyPaneConsumerQueue.set(e,t);break}},a.prototype._registerPendingPropertyPaneConsumers=function(){var e=this;this._propertyPaneConsumerQueue.forEach(function(t,n){e._propertyPane.registerConsumer(n,t)})},a.prototype._closeIsolatedPropertyPaneIfRequired=function(){a._webPartManagerList.forEach(function(e){e._iframedWebPartController&&e._iframedWebPartController.requestPropertyPaneAction("Close")})},a.prototype._loadLegacyFabricCssIfRequired=function(e){var n,i,r=this,o=e.manifest;return!t._LegacyThirdPartyFabricCoreLoader.needLegacyFabricCss(o)&&o.isInternal||null===(i=null===(n=e.domElement)||void 0===n?void 0:n.classList)||void 0===i||i.add("ms-SPLegacyFabricBlock"),t._LegacyThirdPartyFabricCoreLoader.forceLoad(o).then(function(){return Promise.resolve()}).catch(function(e){throw y._TraceLogger.logErrorData({source:a._logSource,error:e,serviceScope:r._host.serviceScope}),e})},Object.defineProperty(a.prototype,"_isDebugSession",{get:function(){return!!n._BrowserUtilities.safelyAccessSessionStorage("spfx-debug")},enumerable:!1,configurable:!0}),a.prototype._loadPropertyPaneModuleOld=function(e){var t=this;if(this._displayMode!==n.DisplayMode.Edit&&!e&&n.Environment.type!==n.EnvironmentType.ClassicSharePoint||this._propertyPane)return Promise.resolve(void 0);var i=new y._QosMonitor("ClientSideWebPartManager._loadPropertyPaneModule");return this._propertyPaneLoader=this._host.serviceScope.consume($.serviceKey),this._propertyPaneLoader.propertyPane.then(function(e){return t._propertyPane=e,t._registerPendingPropertyPaneConsumers(),e}).catch(function(e){throw y._TraceLogger.logErrorData({source:a._logSource,error:e}),i.writeUnexpectedFailure("UnhandledError",e),e})},a.prototype._validateIfWPIsNotDisposed=function(e){if(e.isDisposed||e._isDisposing)throw{error:new Error("The Web Part is disposed and cannot be rendered."),isDisposed:!0}},a.prototype._swapManifestForWebparts=function(e){var t;if((0,j.vq)()&&e.manifest.id===be&&!(null===(t=e.webPartData)||void 0===t?void 0:t.properties.isInlineImage)?(n=X._ManifestStore.instance.tryGetManifest(ge))&&(e.manifest=n):(0,j.vq)()||e.manifest.id!==ge||(n=X._ManifestStore.instance.tryGetManifest(be))&&(e.manifest=n),"f92bf067-bc19-489e-a556-7fe95f508720"===e.manifest.id){var n,a=(0,j.Xf)()?"da46359b-3267-4af8-9c8e-42c631ae31c0":(0,j.vz)()?"a572f711-58d9-473f-a827-ac3ffd529516":void 0;a&&(n=X._ManifestStore.instance.tryGetManifest(a))&&(e.manifest=n)}},a.prototype._doesUserHasPermissions=function(e){if("AdaptiveCardExtension"===e.componentType&&e.isPendingTeamsAppSync)return Promise.resolve(!0);var t=e;return"AdaptiveCardExtension"===e.componentType&&t.connectedTeamsAppId&&(0,j.Ro)()?this._teamsAppsClient.then(function(e){return!e||e.isComponentEnabled(t.connectedTeamsAppId)}).catch(function(){return!1}):Promise.resolve(!0)},Object.defineProperty(a.prototype,"_teamsAppsClient",{get:function(){return(0,j.Ro)()?(this._deferredTeamsAppsClient||(this._deferredTeamsAppsClient=this._host.serviceScope.consume(t._DeferredTeamsAppsClient.serviceKey).getClient()),this._deferredTeamsAppsClient):Promise.resolve(void 0)},enumerable:!1,configurable:!0}),a._webPartManagerList=[],a._1PIsolatedDomainRegex=new RegExp("https://[a-z0-9]*(?=.sharepoint.com)","ig"),a._logSource=y._LogSource.create("ClientSideWebPartManager"),a._manifestRequestPromiseCache={},a}(),ye=function(t){function a(e){var n=t.call(this,e)||this;return n._wpMaintenanceModeData=new Map,n}return(0,e.__extends)(a,t),a.prototype.loadWebPart=function(e){return this._loadWebPartInMaintenanceMode(e),this._wpMaintenanceModeData.set(e.instanceId,e.webPartData),Promise.resolve()},a.prototype.serialize=function(e){return this._wpMaintenanceModeData},a.prototype.dispose=function(e){e?this._wpMaintenanceModeData.delete(e):this._wpMaintenanceModeData=new Map},a.prototype._loadWebPartInMaintenanceMode=function(e){var t=this._getWebPartContext(e);t.serviceScope.finish(),X.SPComponentLoader.loadComponentById("88019639-8c06-4ba6-8545-03a1f38f8393").then(function(n){return n.MaintenanceModeRenderer.render(t,e.webPartData)}).then(function(){return K.disableAutomaticPostbacks(e.domElement,n.Environment.type)}).catch(function(e){return e})},a}(ve),Se=function(){function e(){}return e.create=function(e){return ve.isMaintenanceMode?new ye(e):new ve(e)},e}(),De=function(){function e(){}return Object.defineProperty(e,"_parsingDocument",{get:function(){return this._tempDoc||(this._tempDoc=document.implementation.createHTMLDocument("tempDocument")),this._tempDoc},enumerable:!1,configurable:!0}),e.isWebPartHtml=function(t){return n.Validate.isNonemptyString(t,"htmlString"),0===t.indexOf("<div")&&-1!==t.indexOf(e._webPartDataAttribute)},e.convertWebPartDataToHtml=function(t){n.Validate.isNotNullOrUndefined(t,"web part data");var a=D.cloneDeep(t);e._initializeIfNeeded();var i=e._wpComponentIdDiv.cloneNode();i.textContent=a.id;var r=e._wpHtmlPropsDiv.cloneNode();r.innerHTML=e.convertServerProcessedDataToHtml(a.serverProcessedContent),a.serverProcessedContent=void 0;var o=e._wpDiv.cloneNode();o.setAttribute(e._webPartDataAttribute,JSON.stringify(a)),o.appendChild(i),o.appendChild(r);var s=e._parsingDocument.createElement("div");return s.appendChild(o),s.innerHTML},e.convertHtmlToWebPartData=function(t,n){var a,i=e._parsingDocument.createElement("div");i.innerHTML=t.trim();var r=i.children[0];if(r&&r.hasAttribute(e._webPartAttribute)){var o=r.getAttribute(e._webPartDataAttribute);if(o&&(a=JSON.parse(o)),a){var s=r.querySelector("[".concat(e._htmlPropertiesAttribute,"]"));a.serverProcessedContent=e.convertServerProcessedHtmlToData(s.innerHTML,n)}}return a||void 0},e.convertServerProcessedDataToHtml=function(t){var n="";return t&&(t.htmlStrings&&(n+=e._convertServerProcessedDataToHtmlByType(t.htmlStrings,1)),t.searchablePlainTexts&&(n+=e._convertServerProcessedDataToHtmlByType(t.searchablePlainTexts,4)),t.links&&(n+=e._convertServerProcessedDataToHtmlByType(t.links,2)),t.imageSources&&(n+=e._convertServerProcessedDataToHtmlByType(t.imageSources,3))),n},e.convertServerProcessedHtmlToData=function(t,n){var a={htmlStrings:{},searchablePlainTexts:{},links:{},imageSources:{}};if(!t||""===t)return a;var i=e._parsingDocument.createElement("DIV");i.innerHTML=t;for(var r=i.children,o=0;o<r.length;o++){var s=r[o],c=s.getAttribute(e._propNameAttribute);if(c)switch(s.tagName){case"DIV":s.hasAttribute(e._searchablePlainTextAttribute)&&a.searchablePlainTexts?a.searchablePlainTexts[c]=s.textContent:a.htmlStrings&&(a.htmlStrings[c]=s.innerHTML);break;case"LINK":case"A":if(n)e._extractSPLink(s,n,a,c,!1);else{var d=s.getAttribute("href");d&&a.links&&(a.links[c]=d)}break;case"IMG":case"SPIMG":if(n)e._extractSPLink(s,n,a,c,!0);else{var l=s.getAttribute("src");a.imageSources&&l&&(a.imageSources[c]=l);var u=s.getAttribute("href");u&&a&&a.imageSources&&(void 0===a.imageSources[c]||null===a.imageSources[c])&&(a.imageSources[c]=u)}}}return a},e._convertServerProcessedDataToHtmlByType=function(t,n){for(var a="",i=0,r=Object.entries(t);i<r.length;i++){var o=r[i],s=o[0],c=o[1];a+=e._getHtmlString(s,n,c)}return a},e._getHtmlString=function(t,n,a){var i="";if(t&&"string"==typeof a&&a)switch(n){case 1:var r=this._parsingDocument.createElement("DIV");r.setAttribute(e._propNameAttribute,t);var o=e._normalizeHTML(a);r.innerHTML=o,i=r.outerHTML;break;case 4:var s=this._parsingDocument.createElement("DIV");s.setAttribute(e._propNameAttribute,t),s.setAttribute(e._searchablePlainTextAttribute,"true"),s.textContent=a,i=s.outerHTML;break;case 2:var c=this._parsingDocument.createElement("A");c.setAttribute(e._propNameAttribute,t),c.setAttribute("href",a),i=c.outerHTML;break;case 3:var d=this._parsingDocument.createElement("IMG");d.setAttribute(e._propNameAttribute,t),d.setAttribute("src",a),i=d.outerHTML}return i},e._normalizeHTML=function(t){if(!t||""===t)return t;var n=e._parsingDocument.createElement("DIV");n.innerHTML="<div class='child1'></div><div class='main'>".concat(t,"</div><div class='child3'></div>");var a=n.children;if(!a[0]||"child1"!==a[0].className||!a[1]||"main"!==a[1].className||!a[2]||"child3"!==a[2].className)return"";for(var i=a[1],r=i.querySelectorAll("script"),o=0;o<r.length;o++){var s=r[0];s&&s.parentElement&&s.parentElement.removeChild(s)}return i.innerHTML},e._initializeIfNeeded=function(){e._wpDiv||(e._wpDiv=e._parsingDocument.createElement("div"),e._wpDiv.setAttribute(e._webPartAttribute,""),e._wpDiv.setAttribute(e._webPartDataVersionAttribute,"1.0"),e._wpComponentIdDiv=e._parsingDocument.createElement("div"),e._wpComponentIdDiv.setAttribute(e._componentIdAttribute,""),e._wpHtmlPropsDiv=e._parsingDocument.createElement("div"),e._wpHtmlPropsDiv.setAttribute(e._htmlPropertiesAttribute,""))},e._extractSPLink=function(t,n,a,i,r){if(!(n.length<=0)){var o=t.getAttribute("data-sp-splink");if(o){var s=e._linkPlaceHolderRegex.exec(o);if(!s)throw N.create(H.InvalidSPLinkAttributeFormat,o);var c=parseInt(s[1],10);if(isNaN(c)||!n[c])throw N.create(H.InvalidSPLinkIndex,s[1]);r&&a.imageSources?a.imageSources[i]=n[c]:a.links&&(a.links[i]=n[c])}}},e._componentIdAttribute="data-sp-componentid",e._htmlPropertiesAttribute="data-sp-htmlproperties",e._propNameAttribute="data-sp-prop-name",e._searchablePlainTextAttribute="data-sp-searchableplaintext",e._webPartAttribute="data-sp-webpart",e._webPartDataAttribute="data-sp-webpartdata",e._webPartDataVersionAttribute="data-sp-webpartdataversion",e._linkPlaceHolderRegex=/^__SPLINK__(\d+)__$/,e}();var Ie=function(){function e(){var e=this;this.mediumCardMinWidth=164,this.cardSpacing=16,this.defaultCardWidthMap={Medium:this.mediumCardMinWidth,Large:2*this.mediumCardMinWidth+this.cardSpacing},this._mediumCardMaxWidth=204,this._mediumCardMinWidthSpacing=this.mediumCardMinWidth+this.cardSpacing,this.getCardWidthFromBreakpoint=function(t,n){var a,i=e.getCardWidthFromSize(e.mediumCardMinWidth,n);return t>=e._getCardBreakpoint(6)?e._getMaximizedCardWidth(Math.floor(t/6-e.cardSpacing),n):t>=e._getCardBreakpoint(5)?(a=Math.floor(t/5-e.cardSpacing),e._getMaximizedCardWidth(a,n)):t>=e._getCardBreakpoint(4)?(a=Math.floor(t/4-e.cardSpacing),e._getMaximizedCardWidth(a,n)):t>=e._getCardBreakpoint(3)?(a=Math.floor(t/3-e.cardSpacing),e._getMaximizedCardWidth(a,n)):t>=e._getCardBreakpoint(2)?(a=Math.floor(t/2-e.cardSpacing),e._getMaximizedCardWidth(a,n)):i},this.getCardWidthFromSize=function(t,n){return"Large"===n?2*t+e.cardSpacing:t},this.getDashboardCardWidthsFromContainer=function(t){if(t<((0,m.xJ)()?2*e.mediumCardMinWidth+e.cardSpacing:e._getCardBreakpoint(2))){var n=(0,m.SM)()?Math.floor(t/2-e.cardSpacing/2):Math.floor(t/2)-e.cardSpacing;return{Medium:n,Large:e.getCardWidthFromSize(n,"Large")}}var a=e.getCardWidthFromBreakpoint(t,"Medium");return{Medium:a,Large:e.getCardWidthFromSize(a,"Large")}},this._getCardBreakpoint=function(t){return e._mediumCardMinWidthSpacing*t}}return e.prototype._getMaximizedCardWidth=function(e,t){var n=Math.min(Math.max(e,this.mediumCardMinWidth),this._mediumCardMaxWidth);return this.getCardWidthFromSize(n,t)},e}(),xe=v(258);const Ce=function(){function e(e){this._validateProps(e),this._props=e,this._webPartManager=Se.create(this._props.host)}return Object.defineProperty(e.prototype,"webPartManager",{get:function(){return this._webPartManager},enumerable:!1,configurable:!0}),e.prototype.render=function(e){var t=this;return n.Validate.isNotNullOrUndefined(e,"domElement"),this._domElement=e,this._props.openPropertyPane?this._domElement.style.display="none":this._domElement.style.display="block",this._renderWebPart(this._domElement).then(function(){t._props.openPropertyPane?t._webPartManager.requestPropertyPaneAction(t._props.webPartInstanceId,"Open"):t._props.openDetailsPropertyPane?t._webPartManager.requestPropertyPaneAction(t._props.webPartInstanceId,"OpenDetails"):(t._props.requestDisplayModeStatus&&t._props.requestDisplayModeStatus(),t._props.requestTheme&&t._props.requestTheme(),t._props.sendDimensionsToParent&&(t._intervalTask=window.setInterval(t._sendDimensionsCallback.bind(t),200)))}).catch(function(e){console.log(e)})},e.prototype.dispose=function(){this._intervalTask&&clearTimeout(this._intervalTask),this._webPartManager.disposeWebparts(this._props.webPartInstanceId),this._webPartManager.dispose()},e.prototype.setWebPartData=function(e,t){var n=this._getWebPartManagerContext(this._domElement,e);this._webPartManager.setWebPartData(n,t).catch(function(e){return console.log(e)})},e.prototype.serialize=function(){var e=this._webPartManager.serialize(this._props.webPartInstanceId).get(this._props.webPartInstanceId);return n.Validate.isNotNullOrUndefined(e,"webPartData"),e},e.prototype.setDisplayMode=function(e){return this._webPartManager._setDisplayMode(e,this._props.webPartInstanceId)},e.prototype.requestPropertyPaneAction=function(e,t,a){a&&(n.Validate.isNotNullOrUndefined(this._domElement,"domElement"),this.setWebPartData(a,e)),this._webPartManager.requestPropertyPaneAction(e,t)},e.prototype._getHeight=function(){return n.Validate.isNotNullOrUndefined(this._domElement,"domElement"),this._domElement.children.item(0).offsetHeight},e.prototype._getWidth=function(){return n.Validate.isNotNullOrUndefined(this._domElement,"domElement"),this._domElement.children.item(0).offsetWidth},e.prototype._sendDimensionsCallback=function(){this._props.sendDimensionsToParent(this._getHeight())},e.prototype._renderWebPart=function(e){var t=this;return this._webPartManager.loadWebPart(this._getWebPartManagerContext(e,this._props.webPartData)).catch(function(n){t._webPartManager.renderError(e,n)})},e.prototype._getWebPartManagerContext=function(e,t){return{domElement:e,instanceId:this._props.webPartInstanceId,manifest:this._props.manifest,displayMode:this._props.displayMode||(this._props.openPropertyPane?n.DisplayMode.Edit:n.DisplayMode.Read),webPartData:t,addedFromPersistedData:this._isDataAddedFromPersistedData(),formFactor:this._props.formFactor,pageLayoutType:this._props.pageHostLayoutType}},e.prototype._isDataAddedFromPersistedData=function(){return!(!(0,m.cb)()&&void 0!==this._props.isDataAddedFromPersistedData)||this._props.isDataAddedFromPersistedData},e.prototype._validateProps=function(e){n.Validate.isNotNullOrUndefined(e,"props"),n.Validate.isNotNullOrUndefined(e.webPartData,"props.webPartData"),n.Validate.isNotNullOrUndefined(e.webPartInstanceId,"props.webPartInstanceId"),n.Validate.isNotNullOrUndefined(e.manifest,"props.manifest"),n.Validate.isNotNullOrUndefined(e.serviceScope,"props.applicationContext.serviceScope")},e}()})(),S})())})();