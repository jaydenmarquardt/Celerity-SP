(()=>{var e=document.currentScript;define("4df9bb86-ab0a-4aab-ab5f-48bf167048fb_1.19.0",["tslib","@microsoft/sp-extension-base","@microsoft/sp-component-base","@microsoft/sp-diagnostics","@microsoft/sp-core-library","@microsoft/sp-loader","@ms/sp-telemetry","@microsoft/sp-http-base","@microsoft/sp-http","@microsoft/sp-page-context","@microsoft/sp-lodash-subset","@ms/odsp-core-bundle"],(t,n,a,i,r,o,s,c,d,l,u,f)=>(()=>{"use strict";var p,m,_,h={866:e=>{e.exports=a},878:e=>{e.exports=r},377:e=>{e.exports=i},279:e=>{e.exports=n},272:e=>{e.exports=d},61:e=>{e.exports=c},37:e=>{e.exports=o},348:e=>{e.exports=u},171:e=>{e.exports=l},362:e=>{e.exports=f},186:e=>{e.exports=s},553:e=>{e.exports=t}},b={};function g(e){var t=b[e];if(void 0!==t)return t.exports;var n=b[e]={exports:{}};return h[e](n,n.exports,g),n.exports}g.m=h,g.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return g.d(t,{a:t}),t},g.d=(e,t)=>{for(var n in t)g.o(t,n)&&!g.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},g.f={},g.e=e=>Promise.all(Object.keys(g.f).reduce((t,n)=>(g.f[n](e,t),t),[])),g.u=e=>"chunk.sp-navigation-datastore_none_f89f458641697e7eb362.js",g.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),p={},m="4df9bb86-ab0a-4aab-ab5f-48bf167048fb_1.19.0:",g.l=(e,t,n,a)=>{if(p[e])p[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==m+n){i=c;break}}i||(r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,g.nc&&i.setAttribute("nonce",g.nc),i.setAttribute("data-webpack",m+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous")),p[e]=[t];var d=(t,n)=>{i.onerror=i.onload=null,clearTimeout(l);var a=p[e];if(delete p[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},l=setTimeout(d.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=d.bind(null,i.onerror),i.onload=d.bind(null,i.onload),r&&document.head.appendChild(i)}},g.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},_=e?e.src:"",g.p=_.slice(0,_.lastIndexOf("/")+1),(()=>{var e={521:0};g.f.j=(t,n)=>{var a=g.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=g.p+g.u(t),o=new Error;g.l(r,n=>{if(g.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)g.o(o,a)&&(g.m[a]=o[a]);s&&s(g)}for(t&&t(n);c<r.length;c++)i=r[c],g.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_4df9bb86-ab0a-4aab-ab5f-48bf167048fb_1.19.0"]=self["webpackJsonp_4df9bb86-ab0a-4aab-ab5f-48bf167048fb_1.19.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var v={};return(()=>{g.r(v),g.d(v,{ApplicationAccessor:()=>Z,ApplicationCustomizerContext:()=>$,BaseApplication:()=>X,BaseApplicationContext:()=>b,BaseApplicationCustomizer:()=>H,PlaceholderContent:()=>r,PlaceholderName:()=>s,PlaceholderProvider:()=>u,_ApplicationLoadType:()=>E,_ApplicationManager:()=>J,_DialogManagerConfiguration:()=>Y,_NavigationDataError:()=>M,_NavigationErrorCode:()=>L,_Navigator:()=>Q,_OnBeforeNavigationEventName:()=>A,_Placeholder:()=>c,_PlaceholderManager:()=>l,_PrefetchedDataEventArgs:()=>q,_SearchQueryManager:()=>j});var e=g(553),t=g(279),n=g(866),a=g(377),i=g(878);const r=function(){function e(e){this._disposeHandler=void 0,this._isDisposed=!1,this._placeholder=e.placeholder,this._disposeHandler=e.options?e.options.onDispose:void 0,this._domElement=e.domElement}return Object.defineProperty(e.prototype,"name",{get:function(){return this._placeholder.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"domElement",{get:function(){return this._domElement},enumerable:!1,configurable:!0}),e.prototype._setPlaceholder=function(e){this._placeholder=e},e.prototype._setOptions=function(e){this._disposeHandler=e&&e.onDispose},e.prototype.dispose=function(){if(!this._isDisposed){if(this._disposeHandler)try{this._disposeHandler(this)}catch(t){a._TraceLogger.logError(e._logSource,new Error("The onDispose API threw an exception for placeholder '".concat(this._placeholder.name,"'. Error information is '").concat(t.message,"'")))}this._placeholder.removePlaceholderContent(this),delete this._domElement,delete this._placeholder,delete this._disposeHandler}this._isDisposed=!0},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return document.body.contains(this._domElement)},enumerable:!1,configurable:!0}),e._logSource=a._LogSource.create("Placeholder"),e}();var o;!function(e){e[e.Top=1]="Top",e[e.Bottom=2]="Bottom"}(o||(o={}));const s=o,c=function(){function e(e,t){this._entries=[],i.Validate.isNotNullOrUndefined(e,"definition"),i.Validate.isNotNullOrUndefined(e.domElement,"definition.domElement"),i.Validate.isNotNullOrUndefined(t,"manager"),this._name=e.name,this._domElement=e.domElement,this._applicationDomElement=void 0}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),e.prototype.createPlaceholderContent=function(e,t){var n=document.createElement("div");n.classList.add("ms-SPLegacyFabricBlock");var a=this._addContentDiv(n,e),i=new r({placeholder:this,sequence:e,domElement:n,options:t});return this._entries.splice(a,0,{placeholderContent:i,sequence:e}),i},e.prototype.removePlaceholderContent=function(e){for(var t=0;t<this._entries.length;t++)this._entries[t].placeholderContent===e&&(this._domElement.removeChild(this._entries[t].placeholderContent.domElement),this._entries.splice(t,1),t--)},e.prototype.attachToApplication=function(e){this._applicationDomElement=e,this._applicationDomElement.appendChild(this._domElement)},e.prototype.detachFromApplication=function(){this._applicationDomElement&&(this._applicationDomElement.appendChild(this._domElement),this._applicationDomElement=void 0)},e.prototype._addContentDiv=function(e,t){var n;if(this.name===s.Bottom)for(n=this._entries.length;n>0&&t>this._entries[n-1].sequence;)n--;else for(n=0;n<this._entries.length&&t>=this._entries[n].sequence;)n++;if(n<this._entries.length){var a=this._entries[n].placeholderContent.domElement;this._domElement.insertBefore(e,a)}else this._domElement.appendChild(e);return n},e}();var d="placeholders.changedEvent";const l=function(){function e(e){this._isEnabled=!1,this._changedEvent=new i.SPEvent(d),this._placeholders=new Map,this._placeholders.set(s.Top,this._createPlaceholder(s.Top)),this._placeholders.set(s.Bottom,this._createPlaceholder(s.Bottom))}return Object.defineProperty(e.prototype,"changedEvent",{get:function(){return this._changedEvent},enumerable:!1,configurable:!0}),e.prototype.initializePlaceholders=function(e){var t=this;i.Validate.isNotNullOrUndefined(e,"definitions"),e.forEach(function(e){return t.addPlaceholder(e.name,e.domElement)})},e.prototype.addPlaceholder=function(e,t){i.Validate.isTrue(this.placeholders.has(e),"placeholder exists"),this._placeholders.get(e).attachToApplication(t),i._SPEventManager.instance.raiseStickyEvent(d,new i.SPEventArgs)},e.prototype.removePlaceholder=function(e){i.Validate.isTrue(this.placeholders.has(e),"placeholder exists"),this._placeholders.get(e).detachFromApplication(),i._SPEventManager.instance.raiseStickyEvent(d,new i.SPEventArgs)},e.prototype.registerPlaceholders=function(){for(var e="data-sp-placeholder",t=document.querySelectorAll("[".concat(e,"]")),n=[],a=0;a<t.length;a++){var i=t[a],r=i.getAttribute(e);if(i&&r){var o=s[r];if("number"!=typeof o)throw new Error("Invalid placeholder definition: "+r);n.push({name:o,domElement:i})}}this.initializePlaceholders(n)},Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!1,configurable:!0}),e.prototype._enable=function(){this._isEnabled=!0},Object.defineProperty(e.prototype,"placeholders",{get:function(){return this._placeholders},enumerable:!1,configurable:!0}),e.prototype._createPlaceholder=function(e){return new c({name:e,domElement:document.createElement("div")},this)},e.serviceKey=i.ServiceKey.create("sp-application-base:PlaceholderManager",e),e}(),u=function(){function e(e,t,n){this._placeholderContents=[],this._isDisposed=!1,this._sequence=t.sequence;var i=new a._QosMonitor("PlaceholderProvider"),r=t.preAllocatedApplicationCustomizerTopHeight,o=t.preAllocatedApplicationCustomizerBottomHeight;this._componentTag=n||"",this._placeholderManager=e.consume(l.serviceKey),r>0&&(this._preAllocatedTopPlaceholderContent=this._preAllocateContent(s.Top,r,i)),o>0&&(this._preAllocatedBottomPlaceholderContent=this._preAllocateContent(s.Bottom,o,i)),i.writeSuccess({name:name})}return e.prototype.dispose=function(){this._isDisposed||(this._placeholderContents.forEach(function(e){return e.dispose()}),delete this._placeholderContents,delete this._placeholderManager),this._isDisposed=!0},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e.prototype.tryCreateContent=function(t,n){a._TraceLogger.logVerbose(e._logSource,'Creating placeholder content in placeholder "'.concat(t,'"'));var i,r=new a._QosMonitor("Placeholder.tryCreateContent");return t===s.Top&&this._preAllocatedTopPlaceholderContent?(i=this._preAllocatedTopPlaceholderContent,this._preAllocatedTopPlaceholderContent=void 0):t===s.Bottom&&this._preAllocatedBottomPlaceholderContent&&(i=this._preAllocatedBottomPlaceholderContent,this._preAllocatedBottomPlaceholderContent=void 0),i?(i._setOptions(n),this._postContentCreation(i,r),i.domElement.innerHTML="",i):this._tryCreateContent(r,t,n)},e.prototype._preAllocateContent=function(e,t,a){if(0===this._placeholderManager.changedEvent._listenerCount()&&console.log("tryCreateContent was called, but PlaceholderProvider.changedEvent has no handlers. This is likely to cause an error in the future.  You should probably be calling tryCreateContent in the PlaceholderProvider.changedEvent callback."),this._placeholderManager.isEnabled&&this._placeholderManager.placeholders.has(e)){var i=this._placeholderManager.placeholders.get(e),r=i.createPlaceholderContent(this._sequence);if(i){try{r.domElement.style.height=t+"px";var o=n._ShimmerFactory.createShimmer(r.domElement.clientWidth,t,s+this._componentTag,"",0);r.domElement.appendChild(o),a.writeSuccess({name:name})}catch(c){a.writeUnexpectedFailure("CreateContentFailed",c,{name:name})}return r}c=new Error("Placeholder dictionary has only the key but not the value for the placeholder"),a.writeUnexpectedFailure("NoValueInPlaceholdersMap",c,{name:name})}else{var c=new Error("No placeholder found with the name '".concat(name,"'"));a.writeExpectedFailure("PlaceholderNotFound",c,{name:name})}},Object.defineProperty(e.prototype,"placeholderNames",{get:function(){if(!this._placeholderManager.isEnabled)return[];var e=[];return this._placeholderManager.placeholders.forEach(function(t,n){return e.push(n)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"changedEvent",{get:function(){return this._placeholderManager.changedEvent},enumerable:!1,configurable:!0}),e.prototype._tryCreateContent=function(e,t,n){var a,i=this._placeholderManager.placeholders.get(t);try{a=i.createPlaceholderContent(this._sequence,n)}catch(n){return void e.writeUnexpectedFailure("CreateContentFailed",n,{name:t})}return this._postContentCreation(a,e),a},e.prototype._postContentCreation=function(e,t){if(e)this._placeholderContents.push(e),t.writeSuccess({name:name});else{var n=new Error("Placeholder could not create new content");t.writeUnexpectedFailure("CreateContentUndefined",n,{name:name})}},e._logSource=a._LogSource.create("PlaceholderProvider"),e}();var f,p=g(37),m=g(186),_=g(362),h=(_.KillSwitch.isActivated("F9624ACA-9230-4329-9616-969638C4D4CB","05/08/2022","Include Personal Site Id in generated Server Url for Freemium lists"),"undefined"!=typeof window&&_.FeatureOverrides.isFeatureEnabled({ODB:1737}),3);!function(e){e[e.FooterEnabled=2]="FooterEnabled",e[e.MegaMenuEnabled=128]="MegaMenuEnabled",e[e.FooterEmphasis0=256]="FooterEmphasis0",e[e.FooterEmphasis1=512]="FooterEmphasis1",e[e.FooterLayout0=1024]="FooterLayout0",e[e.FooterLayout1=2048]="FooterLayout1",e[e.HideTitleInHeader=33554432]="HideTitleInHeader",e[e.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"}(f||(f={}));const b=function(t){function n(e){var n=t.call(this,e)||this;return n._disposed=!1,n._preloadedData=e.navigator.preloadedData,n._navigator=e.navigator,n._chrome=e.chrome,n._loadType=e.loadType,n._prefetchedDataEvent=new i.SPEvent(X._prefetchedDataEventName),n}return(0,e.__extends)(n,t),n.prototype.dispose=function(){this._disposed||(this._navigator&&(this._navigator=void 0),t.prototype.dispose.call(this),this._disposed=!0)},n.prototype.initializeSuiteNavManager=function(e){this._suiteNavManager=e},Object.defineProperty(n.prototype,"preloadedData",{get:function(){return this._preloadedData},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"navigator",{get:function(){return this._navigator},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"chrome",{get:function(){return this._chrome},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"loadType",{get:function(){return this._loadType},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"prefetchedDataEvent",{get:function(){return this._prefetchedDataEvent},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"suiteNavManager",{get:function(){return this._suiteNavManager},enumerable:!1,configurable:!0}),n.prototype._updateSecondFlushData=function(e){var t;this._preloadedData=e,null===(t=this._navigator)||void 0===t||t._setPreloadedData(e)},n}(n.BaseComponentContext);var y=g(61),S=function(){function e(){}return e.isDuplicateErrorMessageV2KillSwitchActivated=function(){return i._SPKillSwitch.isActivated(i.Guid.parse("efa9490b-c037-465e-ae95-6eccef6061e8"),"5/11/20","Prevent duplicate error messages from appearing")},e.isChangeWorkloadForTeamsWorkBenchKSActivated=function(){return i._SPKillSwitch.isActivated("66f65dfa-6988-413b-a46d-6872886d05fb")},e.isPageTypeForLayoutsKSActivated=function(){return i._SPKillSwitch.isActivated("8b8d7a10-d7ba-47f5-8ed5-1aa72caf73ac")},e.isDisableNavigationCacheKSActivated=function(){return i._SPKillSwitch.isActivated("1f9b5b68-e4fa-4ca9-94df-b97b1af022f4")},e.isAddEduClassToEngagementKSActivated=function(){return i._SPKillSwitch.isActivated("6529d10e-5177-40ef-9c95-4b3b947e8795")},e.isOverrideApplicationCustomizerDynamicDataSourceIdKSActivated=function(){return i._SPKillSwitch.isActivated("6529d10e-5177-40ef-9c95-4b3b947e8795")},e.isVivaHomeDisableExtensionsKSActivated=function(){return i._SPKillSwitch.isActivated("8bcd47e2-c168-47bb-bd9e-d4f3ce5b830a")},e.isVivaHomeDisableSearchQueryKSActivated=function(){return i._SPKillSwitch.isActivated("53c48b16-126f-4587-8de8-54f7059be35d")},e}();function D(){return i._SPKillSwitch.isActivated("3007279f-0df2-4ac9-a11e-e067d3be1058")}function I(){return i._SPKillSwitch.isActivated("3c191136-63f6-40dd-8e60-b170181959b9")}function x(){return i._SPKillSwitch.isActivated("2277e093-d6f0-46de-af44-7924b6ffc048")}function C(){return i._SPKillSwitch.isActivated("b84a43be-04cc-4186-92a7-95f18c625831")}const O=JSON.parse('{"nm":"[!!--##Àƥƥĺĩćàţĩōń ƒàĩĺēď ţō ĺōàď. Ĩď: \\u0022{0}\\u0022.\\nĒŕŕōŕ: {1}##--!!]","DV":"[!!--##Ēŕŕōŕ ĩńĩţĩàĺĩźĩńĝ àƥƥĺĩćàţĩōń. Ēŕŕōŕ: {0}##--!!]","Ot":"[!!--##Ćĺĩćķ ţō ƥŕōvĩďē àďďĩţĩōńàĺ ćŕēďēńţĩàĺś.##--!!]"}'),w=function(){function e(){this._didRenderError=!1}return e.prototype.setUpTokenAcquistionFailurePlaceholder=function(e,t){var n=this,a=y._AadTokenProviders.configurable,i=new u(t,{sequence:0,preAllocatedApplicationCustomizerBottomHeight:0,preAllocatedApplicationCustomizerTopHeight:0},"AAD Failure Placeholder"),r=t.consume(l.serviceKey);i.changedEvent.add(e,function(){n._aadPlaceHolderContent||(n._aadPlaceHolderContent=i.tryCreateContent(s.Top))}),a.tokenAcquisitionEvent.add(e,function(e){n._didRenderError||n._renderTokenAcquistionEvent(r.isEnabled,e)})},e.prototype._renderTokenAcquistionEvent=function(e,t){!S.isDuplicateErrorMessageV2KillSwitchActivated()&&this._didRenderError||(e&&this._aadPlaceHolderContent?this._renderTokenAcquistionPlaceholder(this._aadPlaceHolderContent,t):this._renderTokenAcquistionAlert(t)),this._didRenderError=!0},e.prototype._renderTokenAcquistionPlaceholder=function(e,t){e.domElement.setAttribute("style","text-align: center; padding: 10px; background-color:#fff4ce;");var n=document.createElement("span");if(n.innerText=t.message,e.domElement.appendChild(n),t.redirectUrl){var a=document.createElement("a");a.href=t.redirectUrl,a.innerText=O.Ot,e.domElement.appendChild(a)}},e.prototype._renderTokenAcquistionAlert=function(e){confirm(e.message)&&e.redirectUrl&&(window.location.href=e.redirectUrl)},e}();var E;!function(e){e[e.FullPageLoad=0]="FullPageLoad",e[e.InPlaceNavigation=1]="InPlaceNavigation"}(E||(E={}));const A=function(t){function n(e,n){var a=this;return i.Validate.isNonemptyString(e,"fromAppId"),i.Validate.isNonemptyString(n,"toAppId"),(a=t.call(this)||this).fromAppId=e,a.toAppId=n,a}return(0,e.__extends)(n,t),n}(i.SPEventArgs);var L,k=g(272);!function(e){e[e.fetchData=0]="fetchData",e[e.parseData=1]="parseData",e[e.asyncError=2]="asyncError",e[e.syncError=3]="syncError",e[e.buildIdMismatch=4]="buildIdMismatch",e[e.unknown=5]="unknown"}(L||(L={}));const M=function(t){function n(e,a,i,r,o){void 0===r&&(r=!1);var s=t.call(this,L[e],a,o)||this;return s.__proto__=n.prototype,s._errorId=e,s.innerError=i,s._isExpected=r,s}return(0,e.__extends)(n,t),n.createNavigationError=function(e,t){i.Validate.isNotNullOrUndefined(t,"innerError");var a=n._isExpectedError(e),r=n._errorTemplate(e);return new n(e,i.Text.format(r,t.message),t,a)},n.sessionEndedReason=function(e,t){void 0===t&&(t="XApp");var n="RouteNav.";return e===L[L.parseData]?n+="Known.".concat(t,".MalformedJSON"):e===L[L.fetchData]?n+="Known.".concat(t,".NetworkError"):e===L[L.asyncError]?n+="Known.".concat(t,".asyncError"):e===L[L.syncError]?n+="Known.".concat(t,".syncError"):e===L[L.buildIdMismatch]?n+="Known.".concat(t,".buildIdMismatch"):n+="Unknown.".concat(t,".NavigationDataError"),n},n._isExpectedError=function(e){var t=e===L.buildIdMismatch;return e===L.parseData||t},n._errorTemplate=function(e){return n._errorCodeToTemplateMap[e]||"Failed to navigate. Error: {0}"},Object.defineProperty(n.prototype,"id",{get:function(){return this._errorId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"category",{get:function(){return"NavigationDataError"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isExpected",{get:function(){return this._isExpected},enumerable:!1,configurable:!0}),n._errorCodeToTemplateMap=new Map([[L.fetchData,"Failed to retrieve navigation data. Error: {0}"],[L.parseData,"Failed to parse navigation data. Error: {0}"],[L.asyncError,"Async Error. Error: {0}"],[L.syncError,"Sync Error. Error: {0}"],[L.buildIdMismatch,"Build ID mismatch. Error: {0}"]]),n}(i.SPError),P=function(){function e(e,t){i.Validate.isNotNullOrUndefined(e,"serviceScope"),i.Validate.isNotNullOrUndefined(t,"validator"),this._spHttpClient=e.consume(k.SPHttpClient.serviceKey),this._dataValidator=t}return e._generatePreloadHeaders=function(e){var t=new Headers;return e&&e.isPrefetchRequest&&t.append("X-RequestPrefetchLink","1"),window.__spfxMark&&t.append("X-Service-Worker-In-Place-Nav","true"),t},e._generatePrefetchHeaders=function(e){var t=new Headers;return t.append("X-RequestPrefetchData","1"),e&&e.isPrefetchRequest&&t.append("X-RequestPrefetchLink","1"),t},Object.defineProperty(e.prototype,"buildId",{get:function(){return this._buildId},set:function(e){this._buildId=e},enumerable:!1,configurable:!0}),e.prototype.getData=function(t,n){var r=this;if(i.Validate.isNonemptyString(t,"url"),S.isDisableNavigationCacheKSActivated())return this._getStore().then(function(e){return e.getData(t,n)});var o,s=this._fetchData(t,e._generatePreloadHeaders(n)).then(function(e){return r._dataValidator(e),e});if(n&&n.enableDataPrefetch){var c=new a._QosMonitor("NavigationDataStore.fetchAppData");o=this._fetchData(t,e._generatePrefetchHeaders(n)).then(function(e){return c.writeSuccess(),e}).catch(function(e){throw c.writeUnexpectedFailure(e),e})}return Promise.resolve({preloadedData:s,prefetchedData:o})},e.prototype.invalidate=function(e){return S.isDisableNavigationCacheKSActivated()?this._getStore().then(function(t){t.remove(e)}):Promise.resolve()},e.prototype._getStore=function(){var e=this;return this._navigationStore?Promise.resolve(this._navigationStore):this._navigationStorePromise||(this._navigationStorePromise=g.e(463).then(g.bind(g,746)).then(function(t){return e._navigationStore=new t.default("sp-application-base:NavigationDataStore","sp-application-base:NavigationDataStore:buildId",e._buildId,function(t,n){return e._fetchData(t,n)},e._dataValidator),e._navigationStore}))},e.prototype._fetchData=function(e,t){var n=e.split("#")[0];return this._spHttpClient.get(n+(-1===n.indexOf("?")?"?":"&")+"as=json",k.SPHttpClient.configurations.v1,t?{headers:t}:void 0).then(function(e){if(e.ok)return e.json().catch(function(e){throw M.createNavigationError(L.parseData,e)});throw M.createNavigationError(L.fetchData,new Error(e.statusMessage))})},e}();var T=g(171),U=g(348);const F=function(){function e(e){i.Validate.isNotNullOrUndefined(e,"serviceScope"),this._serviceScope=e}return e.prototype.createApplicationCustomizerContext=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n=!0);var a=e.clientSideComponentId.toString(),r=0,o=0;e.hostProperties&&(r=parseInt(JSON.parse(e.hostProperties).preAllocatedApplicationCustomizerTopHeight,10)||0,o=parseInt(JSON.parse(e.hostProperties).preAllocatedApplicationCustomizerBottomHeight,10)||0);var s,c={sequence:void 0!==e.sequence?e.sequence:65535,preAllocatedApplicationCustomizerTopHeight:r,preAllocatedApplicationCustomizerBottomHeight:o};if(n){var d=p.SPComponentLoader.tryGetManifestById(a);if(!d)throw new Error('Custom action with component id "'.concat(a,"\" didn't have a manifest."));var l=i.Guid.newGuid().toString(),u="Extension.".concat(d.id,".").concat(l);s=new $({manifest:d,parentServiceScope:this._serviceScope,instanceId:l,loggingTag:u},c)}else s=new $(t,c);return s},e}(),H=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.prototype._initializeExtensionType=function(){t.prototype._initializeExtensionType.call(this);var e=new a._QosMonitor("BaseApplicationCustomizer.onPlaceholdersChanged.setUp");1===this.onPlaceholdersChanged.length?(this._placeholdersChangedCallback=this.onPlaceholdersChanged.bind(this,this.context.placeholderProvider),this.context.placeholderProvider.changedEvent.add(this,this._placeholdersChangedCallback),e.writeSuccess()):e.writeExpectedFailure("DifferentSignature")},Object.defineProperty(n.prototype,"_dynamicDataSourceId",{get:function(){return S.isOverrideApplicationCustomizerDynamicDataSourceIdKSActivated()?"".concat(this.manifest.componentType,".").concat(this.manifest.id,".").concat(this.instanceId):"".concat(this.manifest.componentType,".").concat(this.manifest.id)},enumerable:!1,configurable:!0}),n.prototype.dispose=function(){this._placeholdersChangedCallback&&this.context.placeholderProvider.changedEvent.remove(this,this._placeholdersChangedCallback),t.prototype.dispose.call(this)},n.prototype.onPlaceholdersChanged=function(e){},n}(t.BaseExtension),R=function(){function e(){}return e._tryCreateFromPreloadedCustomAction=function(t){var n=void 0,r=new a._QosMonitor("ClientSideCustomActions.CreateFromPreloadedCustomAction");try{n=new e;var o=t.clientSideComponentId;if(i.Validate.isNonemptyString(o,"customAction.clientSideComponentId"),i.Validate.isNonemptyString(t.location,"customAction.location"),i.Validate.isNotNullOrUndefined(i.Guid.tryParse(o),"customAction.clientSideComponentId as Guid"),!p.SPComponentLoader.tryGetManifestById(o)){var s=new Error('Custom action with component id "'.concat(o,"\" didn't have a manifest."));throw r.writeUnexpectedFailure("ManifestNotFound",s,{customAction:o}),s}n.title=t.title,n.location=t.location,n.clientSideComponentId=i.Guid.parse(o),n.clientSideComponentProperties=t.clientSideComponentProperties,n.registrationType=t.registrationType,n.registrationId=t.registrationId,n.sequence=t.sequence,n.hostProperties=t.hostProperties,n.requireSiteAdministrator=t.requireSiteAdministrator,n.id=i.Guid.tryParse(t.id);var c=t.rights;return c&&void 0!==c.High&&void 0!==c.Low?n.rights=new T.SPPermission(c):a._TraceLogger.logVerbose(e._logSource,"The rights object has invalid format. One of High or Low fields cannot be undefined. Object value is '".concat(JSON.stringify(c))),r.writeSuccess({customAction:n.tag}),n}catch(s){return a._TraceLogger.logError(e._logSource,new Error("Failed to create client-side custom action. Error: ".concat(s.message))),void r.writeUnexpectedFailure("UnhandledCreateError",s,{customAction:t.clientSideComponentId})}},e._tryCreateFromDebugData=function(t,n,r,o,s){try{i.Validate.isNotNullOrUndefined(n,"clientSideComponentId"),i.Validate.isNonemptyString(t,"location");var c=new e;return c.location=t,c.clientSideComponentId=n,c.clientSideComponentProperties=r,c.sequence=o,c.hostProperties=s,c}catch(t){return void a._TraceLogger.logError(e._logSource,new Error("Failed to create client-side custom action. Error: ".concat(t.message)))}},Object.defineProperty(e.prototype,"tag",{get:function(){return"".concat(this.location,".").concat(this.clientSideComponentId.toString())},enumerable:!1,configurable:!0}),e._logSource=a._LogSource.create("ClientSideCustomAction"),e}(),N=function(){function e(){}return e.APPLICATION_CUSTOMIZER="ClientSideExtension.ApplicationCustomizer",e.LISTVIEW_COMMANDSET_CONTEXTMENU="ClientSideExtension.ListViewCommandSet.ContextMenu",e.LISTVIEW_COMMANDSET_COMMANDBAR="ClientSideExtension.ListViewCommandSet.CommandBar",e.LISTVIEW_COMMANDSET_DEFAULT="ClientSideExtension.ListViewCommandSet",e.SEARCH_QUERY_MODIFIER="ClientSideExtension.SearchQueryModifier",e}(),B=function(){function e(e){var n=this;this._customActionFromPreloadedData=[],this._debugCustomActions=[],this._debugCustomizerLoaded=!1,i.Validate.isNotNullOrUndefined(e,"serviceScope"),this._serviceScope=e,this._extensionManager=new t._ExtensionManager(this._serviceScope,H),this._applicationCustomizerContextFactory=new F(this._serviceScope),e.whenFinished(function(){n._placeholderManager=e.consume(l.serviceKey),n._placeholderManager._enable()}),this._currentCustomActions=new Set}return e.prototype.loadExtensions=function(t){var n=this,i=new Set(t),r=this._currentCustomActions.size>0,o=this._hasDebugCustomActions(),s=i.size>0||o,c=!r&&!s||r&&s&&(0,U.isEqual)(this._currentCustomActions,i),d=!1;return r&&!c&&(a._TraceLogger.logVerbose(e._logSource,"Disposing existing extensions"),this.disposeExtensions(),d=!0),this._currentCustomActions=i,s&&!c||o&&d?(a._TraceLogger.logVerbose(e._logSource,"Loading new extensions"),this._loadExtensions(t).then(function(){return n._loadDebugCustomizerIfEnabled()})):this._loadDebugCustomizerIfEnabled()},e.prototype.disposeExtensions=function(){this._extensionManager.disposeExtensions(),this._debugCustomizerLoaded=!1,this._currentCustomActions.clear()},Object.defineProperty(e.prototype,"_customActions",{get:function(){return this._debugCustomActions.concat(this._customActionFromPreloadedData)},enumerable:!1,configurable:!0}),e.prototype._loadDebugCustomizerIfEnabled=function(){var t=this,n="d29758ba-0fc0-4eac-bcfd-7fe5a7d0bc32";if(i._SPFlight.isDebugFlightEnabled&&i._SPFlight.isEnabled(1178)&&!this._debugCustomizerLoaded&&(i._SPFlight.isEnabled(60787)||this._isDebugModeOn(void 0))){var r=R._tryCreateFromDebugData("ClientSideExtension.ApplicationCustomizer",i.Guid.parse(n),void 0,0);if(r)return this._debugCustomizerLoaded=!0,p._ManifestStore.instance.requestManifest(n).then(function(){t._createApplicationCustomizer(r)}).catch(function(t){a._TraceLogger.logError(e._logSource,t)})}return Promise.resolve()},e.prototype._loadExtensions=function(e){this._loadCustomActions(e);for(var t=[],n=0,a=this._customActions;n<a.length;n++){var i=a[n];i.location===N.APPLICATION_CUSTOMIZER&&t.push(this._createApplicationCustomizer(i))}return Promise.all(t).then(function(e){})},e.prototype._createApplicationCustomizer=function(t){var n=this,i=new a._QosMonitor("ApplicationCustomizer.Create");return this._extensionManager.createExtension(t.clientSideComponentId.toString(),t.clientSideComponentProperties,function(e){return n._applicationCustomizerContextFactory.createApplicationCustomizerContext(t,e,!1)}).then(function(e){return i.writeSuccess(n._createQosExtraData(t)),e}).catch(function(r){var o=new Error("Failed to create application customizer '".concat(t.tag,"'. Error information is '").concat(r.message,"'."));throw i.writeExpectedFailure("FailedCreateExtension",r,n._createQosExtraData(t)),a._TraceLogger.logError(e._logSource,o),o})},e.prototype._createQosExtraData=function(e){return{customAction:e.tag}},e.prototype._loadCustomActions=function(e){this._customActionFromPreloadedData=this._loadCustomActionsFromPreloadedData(e),this._debugCustomActions=this._loadCustomActionsFromQueryParameter()},e.prototype._loadCustomActionsFromPreloadedData=function(e){var t=[];if(e)for(var n=0,a=e;n<a.length;n++){var i=a[n];if(i.location===N.APPLICATION_CUSTOMIZER){var r=R._tryCreateFromPreloadedCustomAction(i);r&&t.push(r)}}return t},e.prototype._hasDebugCustomActions=function(){var e=new URL(window.location.href).searchParams;return!!e.get("customActions")||i._SPFlight.isDebugFlightEnabled&&i._SPFlight.isEnabled(1178)&&(i._SPFlight.isEnabled(60787)||this._isDebugModeOn(e))},e.prototype._isDebugModeOn=function(e){return e||(e=new URL(window.location.href).searchParams),i._BrowserUtilities.safelyAccessSessionStorage("spfx-debug")?!e.get("istabtest"):!!e.get("debug")},e.prototype._loadCustomActionsFromQueryParameter=function(){var e=new URL(window.location.href).searchParams.get("customActions"),t=[];if(e){var n=new a._QosMonitor("ApplicationCustomizerLoader.parseQueryParam");try{var r=decodeURIComponent(e),o=JSON.parse(r),s=[];if(o)for(var c=0,d=Object.keys(o);c<d.length;c++){var l=d[c],u=i.Guid.tryParse(l),f=o[l].location,m=o[l].properties,_=o[l].hostProperties,h=o[l].sequence;if(i.Validate.isNotNullOrUndefined(u,"clientSideComponentId"),i.Validate.isNotNullOrUndefined(f,"location"),p.SPComponentLoader.tryGetManifestById(u.toString())){if(u&&f){var b=R._tryCreateFromDebugData(f,u,m?JSON.stringify(m):"",h,_?JSON.stringify(_):"");b&&t.push(b)}}else s.push(u)}s.length>0?this._processMissingManifestsErrors(s,n):n.writeSuccess()}catch(t){this._processQueryParamParseErrors(t,e,n)}}return t},e.prototype._processMissingManifestsErrors=function(t,n){var i=new Error("Custom action component ids are specified by query parameters but matching manifests cannot be found. Ids: "+t.join(", "));a._TraceLogger.logError(e._logSource,i,"parseCustomActionsQueryParameter"),console.error(i.message),n.writeExpectedFailure("ManifestNotFound",i)},e.prototype._processQueryParamParseErrors=function(t,n,i){a._TraceLogger.logError(e._logSource,new Error('Failed to parse the "customActions" URL query parameter:'+t.message)),console.error('The "customActions" URL query parameter is improperly formatted: '+decodeURIComponent(n)),i.writeExpectedFailure("ParseFailure",t)},e._logSource=a._LogSource.create("ApplicationCustomizerLoader"),e}(),j=function(){function e(e){this._isInitialized=!1,this._areExtensionsLoaded=!1,this._serviceScope=e}return e.prototype.initialize=function(e,t){this._preloadedData=e,this._updateSearchBoxText=t;var n=new URL(window.location.href).searchParams;return this._isInitialized=!1,this._areExtensionsLoaded=!1,this._getUrlSearchQuery(n)&&this._hasExtensions(n)?this._initializeExtensions("initialize"):(this._isInitialized=!0,this._areExtensionsLoaded=!1,Promise.resolve())},e.prototype.updateFromQueryString=function(e){var t=new URLSearchParams(e.substring(1)),n=this._getUrlSearchQuery(t);return n&&this._updateSearchBoxText&&this._updateSearchBoxText(this._serviceScope,n),n&&this._hasExtensions(t)&&!this._areExtensionsLoaded?this._initializeExtensions("update"):Promise.resolve()},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.getSearchData=function(){if(!this._isInitialized)return Promise.reject(new Error("SearchQueryManager is not initialized"));var e,t=i._SPFlight.isEnabled(1534)||1===i._SPExperiment.getVariantAndLogExposure(90097),n=new URL(window.location.href).searchParams,r=this._getUrlSearchQuery(n);if(t&&(e=this._getUrlSearchScope(n)),r&&this._hasExtensions(n)){var o=new a._QosMonitor("SearchQueryManager.getSearchData");return this._getExtensionManager().then(function(e){return e.getSearchQuery(r)}).then(function(n){return o.writeSuccess(),t?{searchQuery:n,searchScope:e}:{searchQuery:n}}).catch(function(e){throw o.writeUnexpectedFailure(void 0,e),e})}return Promise.resolve(t?{searchQuery:r,searchScope:e}:{searchQuery:r})},e.prototype._getUrlSearchQuery=function(e){return e.get("q")||e.get("k")||void 0},e.prototype._getUrlSearchScope=function(e){return e.get("scope")||void 0},e.prototype._hasExtensions=function(e){return e.has("customActions")||!!this._preloadedData.customActions&&this._preloadedData.customActions.some(function(e){return e.location===N.SEARCH_QUERY_MODIFIER})},e.prototype._getExtensionManager=function(){var e=this;return this._extensionManagerPromise||(this._extensionManagerPromise=p.SPComponentLoader.loadComponentById("4958ea79-6ff3-4480-8291-0932dd010869").then(function(t){return new t._SearchQueryExtensionManager(e._serviceScope)})),this._extensionManagerPromise},e.prototype._initializeExtensions=function(e){var t=this,n=new a._QosMonitor("SearchQueryManager."+e);return this._getExtensionManager().then(function(e){return e.initializeExtensions(t._preloadedData.customActions).then(function(e){t._areExtensionsLoaded=!0,t._isInitialized=!0,n.writeSuccess({numberOfExtensions:e})})}).catch(function(e){throw n.writeUnexpectedFailure(void 0,e,{numberOfExtensions:0}),e})},e.serviceKey=i.ServiceKey.create("sp-application-base:SearchQueryManager",e),e}();var V="eb4b666b-5c29-4dad-9a99-23613f21a2b7",z="9f012051-e030-4487-9eb7-3365d03be182",G="eb765a5a-9fec-4d59-8cca-6c623b450f0a",K=a._LogSource.create("NavigationOrchestrator");const W=function(){function e(e,t,n){this._numAppsInitializedInSession=0,i.Validate.isNotNullOrUndefined(e,"serviceScope"),this._applicationManager=t||new J(e,n),this._pageContext=e.consume(T.PageContext.serviceKey),this._searchQueryManager=e.consume(j.serviceKey),this._applicationCustomizerLoader=new B(e)}return e.prototype.navigate=function(e){var t,n=this,a=this._applicationManager.currentApplicationId,r=!a.equals(i.Guid.empty),o=a.equals(i.Guid.tryParse(e.clientSideApplicationId)||i.Guid.empty);if(o&&r&&a.equals(i.Guid.tryParse(z)))throw new m._QosMonitor("ListHostBlankPage").writeSuccess(),new Error("SP-List-Host App: Navigation within the listhost app is not supported.");var s=o||!r,c=this._isNavigationSupportedWithReason(e,this._pageContext,s);if(void 0!==c)return Promise.resolve({preloadedData:e,application:void 0,operation:"Unsupported",unsupportedReason:c});Q.clearNavigatedEventQueue(),this._fixPreloadedDataItem(e);var d=this._isCrossSite(e,this._pageContext),l=T.SharePointPageContextDataProvider._createPageContextData(e.spPageContextInfo);return l.listItem&&(l.listItem.uniqueId=null===(t=e.item)||void 0===t?void 0:t.UniqueId),this._pageContext.initialize(l,e.spPageContextInfo),window.__spfxMark?p._ManifestStore.instance.registerManifests(e.manifests,!1):p._ManifestStore.instance.replaceManifests(e.manifests),d&&!J._isChromelessApplication(e.clientSideApplicationId)&&r&&o&&this._applicationManager.currentApplication._loadTheme(),this._updateTelemetry(e),e.spPageContextInfo=void 0,i.Session._changePage(),e.clientSideApplicationId&&i.Session._setClientSideApplicationId(e.clientSideApplicationId),z!==e.clientSideApplicationId&&Q.raiseNavigatedEvent(),o?(this._initializeSearchQueryAsync(e),this._loadApplicationCustomizersAsync(e),Promise.resolve({preloadedData:e,application:this._applicationManager.currentApplication,operation:"UpdateContext",isXSite:d})):(m._PerformanceLogger.markCrossAppNavigationStart(),this._applicationManager.startApplication(e).then(function(t){return n._numAppsInitializedInSession++,n._initializeSearchQueryAsync(e),n._loadApplicationCustomizersAsync(e),z===e.clientSideApplicationId&&(window.moduleLoaderPromise=Promise.resolve(t)),Promise.resolve({preloadedData:e,application:t,operation:"LoadApplication",isXSite:d})}))},e.prototype._loadApplicationCustomizersAsync=function(e){return this._appSupportsExtensions(e)?(a._TraceLogger.logVerbose(K,"Loading application customizers"),this._applicationCustomizerLoader.loadExtensions(e.customActions)):(a._TraceLogger.logVerbose(K,"Application Customizer is not supported for classic pages and workbench."),Promise.resolve())},e.prototype._disposeApplicationCustomizers=function(){this._applicationCustomizerLoader.disposeExtensions()},e.prototype._initializeSearchQueryAsync=function(e){var t=this;return e.clientSideApplicationId===V||"8be81a5c-af38-4bb2-af97-afa3b64dfbed"===e.clientSideApplicationId||"1f019ae1-2de1-4f44-b723-00a6ec1d7445"===e.clientSideApplicationId||!S.isVivaHomeDisableSearchQueryKSActivated()&&e.clientSideApplicationId===G?Promise.resolve():this._searchQueryManager.initialize(e,function(e,n){if(t._applicationManager.currentApplicationId!==i.Guid.empty){var a=t._applicationManager.currentApplication._getPageChromeProvider();null==a||a.updateSearchBoxText(e,n)}}).then(function(){return t._searchQueryManager.getSearchData()}).then(function(e){i._SPFlight.isEnabled(1534)||1===i._SPExperiment.getVariantAndLogExposure(90097)?t._pageContext._setSearchData(e):t._pageContext._setSearchQuery(e.searchQuery)})},e.prototype._appSupportsExtensions=function(e){return!(e.clientSideApplicationId===V||!S.isVivaHomeDisableExtensionsKSActivated()&&e.clientSideApplicationId===G)},e.prototype._updateTelemetry=function(e){var t,n,r,o=e&&e.manifests&&e.manifests.length>0?e.manifests[0].alias:"";if(!i._SPKillSwitch.isActivated("da8015f3-c5fe-45f3-9220-ca73eb5cf979")&&o&&e.manifests[0].experimentalData&&e.manifests[0].experimentalData[p._INCLUDE_APP_WORKLOAD])try{var s=new URL(window.location.href);s.searchParams.get(p._APP_WORKLOAD_QSP)&&(o+="-"+s.searchParams.get(p._APP_WORKLOAD_QSP))}catch(e){}var c,d,l,u=this._pageContext.legacyPageContext,f=u.isHubSite,_=u.webTemplate,h=u.hubSiteId,b=u.isEduClass;if(e&&e.item)c=e.item.PageLayoutType,d=e.item.PromotedState,l=e.item.UniqueId;else if(!S.isPageTypeForLayoutsKSActivated()){var g="/_layouts/15/",v=window.location.href,y=v.toLowerCase(),D=y.indexOf(g),I=void 0;if(D>-1){var x=y.indexOf(".aspx"),O=v.substring(D+g.length,x>-1?x:void 0);I="SystemLayouts_".concat(O)}else I="CrossApp";c=I}var w={pageId:l,isHubSite:f,webTemplate:_,pageType:c,promotedState:d,hubSiteId:f?h:void 0,isEduClass:S.isAddEduClassToEngagementKSActivated()?void 0:b},E=!S.isChangeWorkloadForTeamsWorkBenchKSActivated()&&window.location.href.indexOf("/_layouts/15/TeamsWorkBench.aspx")>-1?"TeamsWorkBench":o;m._Telemetry.updateSettings({siteId:this._pageContext.site.id.toString(),webId:this._pageContext.web.id.toString(),listId:(null===(t=this._pageContext.list)||void 0===t?void 0:t.id.toString())||"",correlationId:this._pageContext.site.correlationId.toString(),clientSideApplicationId:e.clientSideApplicationId,experimentData:C()?void 0:this._pageContext.legacyPageContext.experimentData,experimentDataLookup:C()?void 0:this._pageContext.legacyPageContext.experimentDataLookup},this._pageContext.legacyPageContext,E),a._Diagnostics.updateSettings({siteId:this._pageContext.site.id.toString(),webId:this._pageContext.web.id.toString(),listId:(null===(n=this._pageContext.list)||void 0===n?void 0:n.id.toString())||"",listItemUniqueId:(null===(r=this._pageContext.listItem)||void 0===r?void 0:r.id.toString())||"",correlationId:this._pageContext.site.correlationId.toString(),contextInfo:w})},e.prototype._isCrossSite=function(e,t){return!(!t.isInitialized||i.Guid.parse(e.spPageContextInfo.webId).equals(t.web.id)&&i.Guid.parse(e.spPageContextInfo.siteId).equals(t.site.id))},e.prototype._fixPreloadedDataItem=function(e){return-1===e.spPageContextInfo.pageItemId&&e.item&&-1!==e.item.ID&&(e.spPageContextInfo.pageItemId=e.item.ID),e},e.prototype._isNavigationSupportedWithReason=function(e,t,n){return t.isInitialized&&t.cultureInfo.currentUICultureName!==e.spPageContextInfo.currentUICultureName?"LocaleChange":!n&&this._numAppsInitializedInSession>15?"TransitionsExceeded":void 0},e}(),q=function(t){function n(e,n,a){var r=this;return i.Validate.isNonemptyString(e,"id"),i.Validate.isNonemptyString(n,"url"),(r=t.call(this)||this).applicationId=e,r.url=n,r.data=a,r}return(0,e.__extends)(n,t),n}(i.SPEventArgs),Q=function(){function t(e,t){var n=this;i.Validate.isNotNullOrUndefined(e,"serviceScope"),this._navigationDataProvider=new P(e,function(e){n._validatePreloadedData(e)}),this._navigationOrchestrator=new W(e,t,this),this._spHttpClient=e.consume(k.SPHttpClient.serviceKey)}return t.raiseNavigatedEvent=function(){requestAnimationFrame(function(){setTimeout(function(){i._SPEventManager.instance.raiseStickyEvent(X._navigatedEventName,{})},0)})},t.clearNavigatedEventQueue=function(){i._SPEventManager.instance._clearStickyEventQueue(X._navigatedEventName)},Object.defineProperty(t.prototype,"preloadedData",{get:function(){return i.Validate.isNotNullOrUndefined(this._preloadedData,"preloadedData"),this._preloadedData},enumerable:!1,configurable:!0}),t.prototype.navigate=function(e,t){var n=this;i.Validate.isNonemptyString(e,"url");var r=new a._QosMonitor("Navigator.navigate");return this._spHttpClient&&(this._spHttpClient.isNavigate=!0),this._navigationDataProvider.getData(e,t).then(function(t){if(!t.preloadedData)throw new Error("Preloaded Data is not available.");return t.preloadedData.then(function(a){return t.prefetchedData&&(!x()&&a.item?n._raiseClearDataEvent(a.item.UniqueId):n._raisePrefetchDataEvent(e,a,t.prefetchedData)),n.navigateToPreloadedData(a,e,t.prefetchedData)}).then(function(e){return e&&"Unsupported"===e.operation?r.writeExpectedFailure("Unsupported"):r.writeSuccess(),n._spHttpClient&&(n._spHttpClient.isNavigate=!1),e})}).catch(function(e){var t=!1;throw e instanceof M&&(t=e.isExpected),t?r.writeExpectedFailure(void 0,e):r.writeUnexpectedFailure(void 0,e),e})},t.prototype.prefetch=function(t,n){var i=(0,e.__assign)((0,e.__assign)({},n),{isPrefetchRequest:!0}),r=new a._QosMonitor("Navigator.prefetch");return this._navigationDataProvider.getData(t,i).then(function(e){return r.writeSuccess(),e}).catch(function(e){r.writeUnexpectedFailure(void 0,e)})},t.prototype.navigateToPreloadedData=function(e,t,n){var i=this,r=new a._QosMonitor("Navigator.navigateToPreloadedData");try{return this._validatePreloadedData(e),this._preloadedData=e,this._navigationOrchestrator.navigate(e).then(function(a){return i._preloadedData=a.preloadedData,!x()&&t&&n&&i._raisePrefetchDataEvent(t,e,n),r.writeSuccess(),a}).catch(function(e){throw r.writeUnexpectedFailure("AsyncError",e),M.createNavigationError(L.asyncError,e)})}catch(e){var o=void 0;return e&&e._errorId===L.buildIdMismatch?(o=e,r.writeExpectedFailure("ValidationError",e,{error:"BuildIdMismatch"})):(o=M.createNavigationError(L.syncError,e),r.writeUnexpectedFailure("SyncError",e)),Promise.reject(o)}},t.prototype.navigateToApplication=function(e){var t=this,n=new a._QosMonitor("Navigator.navigateToApplication");try{return this._navigationDataProvider.buildId=this._getBuildId(e),this._validatePreloadedData(e),this._preloadedData=e,this._navigationOrchestrator.navigate(e).then(function(e){return t._preloadedData=e.preloadedData,n.writeSuccess(),Promise.resolve(e.application)})}catch(e){throw n.writeUnexpectedFailure(e),e}},t.prototype._loadApplicationCustomizers=function(e){return this._navigationOrchestrator._loadApplicationCustomizersAsync(e)},t.prototype._disposeApplicationCustomizers=function(){this._navigationOrchestrator._disposeApplicationCustomizers()},t.prototype.invalidate=function(e){return this._navigationDataProvider.invalidate(e)},t.prototype._validatePreloadedData=function(e){i.Validate.isNotNullOrUndefined(e,"preloadedData"),i.Validate.isNotNullOrUndefined(e.spPageContextInfo,"preloadedData.spPageContextInfo"),i.Validate.isNonemptyString(e.clientSideApplicationId,"preloadedData.clientSideApplicationId");try{i.Validate.isTrue(this._navigationDataProvider.buildId===this._getBuildId(e),"NavigationDataProvider.buildId")}catch(e){throw M.createNavigationError(L.buildIdMismatch,e)}},t.prototype._raiseClearDataEvent=function(e){i._SPEventManager.instance.raiseStickyEvent("resetCacheManager",e),i._SPEventManager.instance.raiseStickyEvent("resetLegacyCacheManager",e)},t.prototype._raisePrefetchDataEvent=function(e,t,n){n.then(function(n){n&&i._SPEventManager.instance.raiseStickyEvent(X._prefetchedDataEventName,new q(t.clientSideApplicationId,e,n))})},t.prototype._getBuildId=function(e){try{if(e.buildNumber)return e.buildNumber;var t=e.manifests[0].loaderConfig.internalModuleBaseUrls[0];return t.slice(t.indexOf("sp-client-"),-1)}catch(e){return""}},t.prototype._setPreloadedData=function(e){this._preloadedData=e},t}(),Y=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"allowDialogs",{get:function(){return i.Validate.isNotNullOrUndefined(this._allowDialogs,"allowDialogs"),this._allowDialogs},set:function(e){i.Validate.isNotNullOrUndefined(e,"value"),this._allowDialogs=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"domElement",{get:function(){return i.Validate.isNotNullOrUndefined(this._domElement,"domElement"),this._domElement},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,t){void 0===t&&(t=!0),this._allowDialogs=t,this._domElement=e},e.prototype.dispose=function(){this._allowDialogs=void 0,this._domElement=void 0},e}(),J=function(){function e(e,t){i.Validate.isNotNullOrUndefined(e,"serviceScope"),this._serviceScope=e,this._navigator=t||new Q(this._serviceScope,this)}return e._isChromelessApplication=function(e){return i.Environment.type===i.EnvironmentType.ClassicSharePoint||"b1ab4aaa-f779-405c-8683-d3a750b5d18d"===e||"c22967c0-666a-4f03-a8c4-545efb9183e1"===e||"ad084475-d3a1-478e-859b-7d9a31e86828"===e||!I()&&"efd6c8a7-f166-458c-905f-720088538e16"===e},e._isThemelessApplication=function(e){return"c22967c0-666a-4f03-a8c4-545efb9183e1"===e||"ad084475-d3a1-478e-859b-7d9a31e86828"===e||!I()&&"efd6c8a7-f166-458c-905f-720088538e16"===e},Object.defineProperty(e.prototype,"currentApplicationId",{get:function(){var e=this._currentApplication&&this._currentApplication.componentId;return e?i.Guid.parse(e):i.Guid.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentApplication",{get:function(){return i.Validate.isNotNullOrUndefined(this._currentApplication,"currentApplication"),this._currentApplication},enumerable:!1,configurable:!0}),e.prototype.startApplication=function(t){var n=this;try{i.Validate.isNonemptyString(t.clientSideApplicationId,"preloadedData.clientSideApplicationId")}catch(e){return Promise.reject(e)}var r=new a._QosMonitor("ApplicationManager.start");function o(t,n){var i=new Error(t);throw a._TraceLogger.logError(e._logSource,i),r.writeUnexpectedFailure(n,i),i}var s=t.clientSideApplicationId,c=p.SPComponentLoader.tryGetManifestById(s),d=c?p.SPComponentLoader.tryGetLoadedComponent(c):void 0;return d?this._initializeApplicationWithTelemetry(d,s,r,o):this._loadApplicationComponent(s,o).then(function(e){return n._initializeApplicationWithTelemetry(e,s,r,o)})},e.prototype._raiseOnBeforeNavigationEventName=function(e,t){i._SPEventManager.instance.raiseEvent(X._onBeforeNavigationEventName,new A(e,t))},Object.defineProperty(e.prototype,"_applicationLoadType",{get:function(){return this._previousApplication?E.InPlaceNavigation:E.FullPageLoad},enumerable:!1,configurable:!0}),e.prototype._initializeApplicationWithTelemetry=function(e,t,n,a){return m._PerformanceLogger.markApplicationStart(),this._initializeApplication(new e.default,t).then(function(e){return n.writeSuccess(),e}).catch(function(e){return a(i.Text.format(O.DV,e),"SPShell.Start")})},e.prototype._loadApplicationComponent=function(e,t){return p.SPComponentLoader.loadComponentById(e).catch(function(n){return t(i.Text.format(O.nm,e,n.message),"ApplicationFailedToLoad")})},e.prototype._isChromelessApplication=function(t){return e._isChromelessApplication(t)},e.prototype._isThemelessApplication=function(t){return e._isThemelessApplication(t)},e.prototype._initializeApplication=function(e,t){var n=this;if("BaseApplication"!==e.__type)return Promise.reject(new Error("The application is not a subclass of BaseApplication"));var r=new a._QosMonitor("ApplicationManager.initialize"),o=p.SPComponentLoader.tryGetManifestById(t),s={alias:e.alias||o.alias,isInternal:o.isInternal,manifestId:o.id};this._currentApplication&&(this._previousApplication=this._currentApplication),this._currentApplication=e,this._previousApplication&&(this._raiseOnBeforeNavigationEventName(this._previousApplication.componentId,t),this._previousApplication._unload());var c=void 0;i._SPKillSwitch.isActivated("c99f5bdc-a1ed-4132-8569-966cd81dfcb2")||(c=this._navigator.preloadedData);var d=this._currentApplication._getPageChromeProvider(),l=this._isChromelessApplication(t);l||d&&(this._masterChrome||(this._masterChrome=d.initializeMasterChrome()),this._pageChrome||(this._pageChrome=d.initializePageChrome(this._serviceScope,this._masterChrome,t,c),Y.instance.initialize(this._pageChrome.dialogContainerDiv)));try{return this._currentApplication._load({manifest:o,parentServiceScope:this._serviceScope,navigator:this._navigator,instanceId:o.id,loggingTag:"Application.".concat(o.id),chrome:this._pageChrome,loadType:this._applicationLoadType}).then(function(){return n._previousApplication&&(n._previousApplication.dispose(),n._previousApplication=void 0),d?(n._isThemelessApplication(t)||n._currentApplication._loadTheme(),l||n._currentApplication._render()):!D()&&l&&n._currentApplication._render(),r.writeSuccess(s),e}).catch(function(e){return r.writeUnexpectedFailure("AsyncError",e,s),Promise.reject(e)})}catch(e){return r.writeUnexpectedFailure("GeneralError",e,s),Promise.reject(e)}},e._logSource=a._LogSource.create("ApplicationManager"),e}(),X=function(t){function n(){var e=t.call(this)||this;e._handleSecondFlush=function(t){e.context._updateSecondFlushData(t),e.onLoad().then(function(){e._onRender()}).catch(function(e){throw e})},e.__type="BaseApplication";var n=e._getPageChromeProvider();return n&&(e._themeManager=n.initializeThemeManager(function(){return e.context.serviceScope})),p._SPLoaderFlights._isMinimalStartFlightEnabled()&&(e._onSecondFlushEvent=new i.SPEvent("onSecondFlush"),e._onSecondFlushEvent.add(e,function(t){e._secondFlushEventRaised=!0,e._secondFlushPreloadedData=t})),e}return(0,e.__extends)(n,t),Object.defineProperty(n.prototype,"domElement",{get:function(){return i.Validate.isNotNullOrUndefined(this.context,"context"),i.Validate.isNotDisposed(this.context,"context"),i.Validate.isNotNullOrUndefined(this.context.chrome,"chrome"),i.Validate.isNotDisposed(this.context.chrome,"chrome"),this.context.chrome.appDiv},set:function(e){throw new Error("The property cannot be assigned because it is read-only")},enumerable:!1,configurable:!0}),n.prototype._load=function(e){var t=this,n=new a._QosMonitor("BaseApplication.load");try{var i=this._getApplicationContext(e);return this._initializeContext(i),(new w).setUpTokenAcquistionFailurePlaceholder(this,this.context.serviceScope),(p._SPLoaderFlights._isMinimalStartFlightEnabled()?this.onBeforeLoad().then(function(){if(t._secondFlushEventRaised)return t.context.preloadedData.isFirstFlush&&(a._EngagementLogger.logEvent("_load.SecondFlushBeforeFirstFlushFinished"),t.context._updateSecondFlushData(t._secondFlushPreloadedData)),t._loadedDuringFirstFlush=!0,t.onLoad()}):this.onLoad()).then(function(){return n.writeSuccess()}).catch(function(e){throw n.writeExpectedFailure("onLoadFailure",e),e})}catch(e){return n.writeUnexpectedFailure("SyncError",e),Promise.reject(e)}},n.prototype._render=function(){var e,t=new a._QosMonitor("BaseApplication.render");try{var n=this._getPageChromeProvider();if(void 0===n)return void(!D()&&J._isChromelessApplication(this.componentId)&&this._onRender());null===(e=this._themeManager)||void 0===e||e.flushStyles(),this.context.chrome.show();var r=this.context.loadType===E.FullPageLoad,o=null==n?void 0:n.initializeSuiteNavManager(this.context.serviceScope);if(o){var s=this.suiteNavConfiguration();o.initialize(this.context.chrome.suiteNavDiv,r),this.context.initializeSuiteNavManager(o),s&&!s.isSuiteNavDisabled()&&(i._SPFlight.isEnabled(1309)&&s.isSuiteNavLoadingDeferred()?("1f019ae1-2de1-4f44-b723-00a6ec1d7445"===this.componentId?m._PerformanceLogger.trackFlight(m._PerformanceFlight.CSISPHomeLazyLoadSearchPackage):m._PerformanceLogger.trackFlight(m._PerformanceFlight.CSISPPagesLazyLoadSearchPackage),o.loadSuiteNavNewFlow(s)):o.loadSuiteNav(s))}p._SPLoaderFlights._isMinimalStartFlightEnabled()&&!this._loadedDuringFirstFlush?this._onSecondFlushEvent.add(this,this._handleSecondFlush):this._onRender(),t.writeSuccess()}catch(e){throw t.writeUnexpectedFailure("onRenderError",e),e}},n.prototype._unload=function(){var e=new a._QosMonitor("BaseApplication.unload");try{this.onUnload(),e.writeSuccess()}catch(t){e.writeExpectedFailure("onUnloadError",t)}},n.prototype._loadTheme=function(){var e;if(!J._isThemelessApplication(this.componentId)){null===(e=this._themeManager)||void 0===e||e.registerOnThemeChangeCallback();var t=this._getThemeProvider();return t?t.loadThemedStyles():Promise.resolve()}return Promise.resolve()},n.prototype.dispose=function(){var e;null===(e=this._themeManager)||void 0===e||e.dispose(),this.onDispose(),t.prototype.dispose.call(this)},n.prototype.suiteNavConfiguration=function(){var e=this._getPageChromeProvider();if(e)return e.initializeSuiteNavManagerConfiguration(this._getSuiteNavManagerConfigurationData())},n.prototype._getApplicationContext=function(e){return new b(e)},n.prototype._getThemeProvider=function(){var e=this._getPageChromeProvider();if(e)return e.initializeThemeProvider(this.context.serviceScope)},n.prototype.onBeforeLoad=function(){return Promise.resolve()},n.prototype.onLoad=function(){return Promise.resolve()},n.prototype.onUnload=function(){},n.prototype.onRender=function(){},n.prototype.onDispose=function(){},n.prototype._getSuiteNavManagerConfigurationData=function(){var e=this.context.pageContext,t=e.legacyPageContext.webTemplateId,n=e.legacyPageContext.searchBoxInNavBar===h;return{currentUICultureName:e.cultureInfo.currentUICultureName,disableSuiteNav:this._shouldDisableSuiteNav(),preloadedData:this.context.preloadedData,settingsData:e.legacyPageContext.MenuData?e.legacyPageContext.MenuData.SettingsData:void 0,signoutUrl:e.legacyPageContext.MenuData?e.legacyPageContext.MenuData.SignOutUrl:void 0,siteClientTag:e.legacyPageContext.siteClientTag,systemUserKey:e.legacyPageContext.systemUserKey,userDisplayName:e.user.displayName,webServerRelativeUrl:e.web.serverRelativeUrl,webTemplateId:t,disableSuiteNavSearchBox:n}},n.prototype._navigate=function(e,t){return i.Validate.isNonemptyString(e,"url"),this.context.navigator.navigate(e,t)},n.prototype._navigateToPreloadedData=function(e){i.Validate.isNotNullOrUndefined(e,"preloadedData"),this.context.navigator.navigateToPreloadedData(e)},n.prototype._invalidate=function(e){return i.Validate.isNotNullOrUndefined(e,"url"),this.context.navigator.invalidate(e)},n.prototype.raiseLayoutChangedEvent=function(){i._SPEventManager.instance.raiseEvent(n._layoutChangedEventName,{})},n.prototype._onRender=function(){this.onRender(),i._SPEventManager.instance.removeEvent("onSecondFlush")},n.prototype._shouldDisableSuiteNav=function(){var e=new i.UrlQueryParameterCollection(window.location.href);return"localhost"===window.location.hostname||"true"===e.getValue("disableSuiteNav")||i._BrowserUtilities.isEmbedded()||!this.manifest.hasSuiteNav},n._navigatedEventName="application.navigatedEvent",n._layoutChangedEventName="application.layoutChangedEvent",n._prefetchedDataEventName="application.prefetchedDataEvent",n._onBeforeNavigationEventName="application.onBeforeNavigationEventName",n}(n.BaseComponent),Z=function(){function e(e){this._navigatedEvent=new i.SPEvent(X._navigatedEventName),this._privateLayoutChangedEvent=new i.SPEvent(X._layoutChangedEventName)}return Object.defineProperty(e.prototype,"navigatedEvent",{get:function(){return this._navigatedEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_layoutChangedEvent",{get:function(){return this._privateLayoutChangedEvent},enumerable:!1,configurable:!0}),e}(),$=function(t){function n(e,n){var a=t.call(this,e)||this;return a.serviceScope.finish(),a._componentTag="Extension."+"".concat(e.manifest.alias,".")+"".concat(e.manifest.id,".")+"".concat(e.manifest.isInternal?"internal":"external",".")+"".concat(e.instanceId),a._placeholderProvider=new u(a.serviceScope,n,a._componentTag),a._applicationAccessor=new Z(a.serviceScope),a}return(0,e.__extends)(n,t),Object.defineProperty(n.prototype,"placeholderProvider",{get:function(){return this._placeholderProvider},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"application",{get:function(){return this._applicationAccessor},enumerable:!1,configurable:!0}),n.prototype.dispose=function(){this.isDisposed||(this._placeholderProvider.dispose(),delete this._placeholderProvider,delete this._applicationAccessor),t.prototype.dispose.call(this)},n}(t.ExtensionContext)})(),v})())})();